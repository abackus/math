\documentclass[12pt]{article}
\usepackage[pdftex,pagebackref,letterpaper=true,colorlinks=true,pdfpagemode=none,urlcolor=blue,linkcolor=blue,citecolor=blue,pdfstartview=FitH]{hyperref}

\usepackage{amsmath,amsfonts}
\usepackage{graphicx}
\usepackage{color}

% Number systems
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\PP}{\mathbb P}
\newcommand{\FF}{\mathbb F}
\newcommand{\DD}{\mathbb D}
\newcommand{\EE}{\mathbb E}
\renewcommand{\epsilon}{\varepsilon}

\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\cl}{\operatorname{cl}}
\newcommand{\ch}{\operatorname{ch}}
\newcommand{\Con}{\operatorname{Con}}
\newcommand{\coker}{\operatorname{coker}}
\newcommand{\CVect}{\CC\operatorname{-Vect}}
\newcommand{\Cantor}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\card}{\operatorname{card}}
\newcommand{\dbar}{\overline \partial}
\newcommand{\diam}{\operatorname{diam}}
\newcommand{\dom}{\operatorname{dom}}
\newcommand{\End}{\operatorname{End}}
\DeclareMathOperator*{\esssup}{ess\,sup}
\newcommand{\Hess}{\operatorname{Hess}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\id}{\operatorname{id}}
\newcommand{\Ind}{\operatorname{Ind}}
\newcommand{\Inn}{\operatorname{Inn}}
\newcommand{\interior}{\operatorname{int}}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\mesh}{\operatorname{mesh}}
\newcommand{\LL}{\mathcal L_0}
\newcommand{\Leb}{\mathcal{L}_{\text{loc}}^2}
\newcommand{\Lip}{\operatorname{Lip}}
\newcommand{\ppic}{\vspace{35mm}}
\newcommand{\ppset}{\mathcal{P}}
\DeclareMathOperator{\proj}{proj}
\DeclareMathOperator*{\Res}{Res}
\newcommand{\Riem}{\mathcal{R}}
\newcommand{\RVect}{\RR\operatorname{-Vect}}
\newcommand{\Sch}{\mathcal{S}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\spn}{\operatorname{span}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\TT}{\mathcal T}
\DeclareMathOperator{\tr}{tr}

% Calculus of variations
\DeclareMathOperator{\pp}{\mathbf p}
\DeclareMathOperator{\zz}{\mathbf z}
\DeclareMathOperator{\uu}{\mathbf u}
\DeclareMathOperator{\vv}{\mathbf v}
\DeclareMathOperator{\ww}{\mathbf w}

% Categories
\newcommand{\Ab}{\mathbf{Ab}}
\newcommand{\Cat}{\mathbf{Cat}}
\newcommand{\Group}{\mathbf{Group}}
\newcommand{\Module}{\mathbf{Module}}
\newcommand{\Set}{\mathbf{Set}}
\DeclareMathOperator{\Fun}{Fun}
\DeclareMathOperator{\Iso}{Iso}

% Complex analysis
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

% Logic
\renewcommand{\iff}{\leftrightarrow}
\newcommand{\Henkin}{\operatorname{Henk}}
\newcommand{\PA}{\mathbf{PA}}
\DeclareMathOperator{\proves}{\vdash}

% Group
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Fix}{Fix}
\DeclareMathOperator{\Lie}{Lie}
\DeclareMathOperator{\Out}{Out}

\DeclareMathOperator{\Diffeo}{Diffeo}

\newcommand{\GL}{\operatorname{GL}}
\newcommand{\ppGL}{\operatorname{PGL}}
\newcommand{\SL}{\operatorname{SL}}
\newcommand{\SO}{\operatorname{SO}}

% Other symbols
\newcommand{\heart}{\ensuremath\heartsuit}
\newcommand{\club}{\ensuremath\clubsuit}

\DeclareMathOperator{\atanh}{atanh}

\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\textwidth}{6.0in}
\setlength{\topmargin}{0in}
\setlength{\textheight}{8.5in}

\setlength{\parindent}{0in}
\setlength{\parskip}{5px}

\input{macrosblog}

\begin{document}

% --------------------------------------------------------------
%                         Start here
% --------------------------------------------------------------\

In this proof we (finally!) finish the proof of case one.

As usual, we throughout fix a nonstandard natural $n$ and a complex polynomial of degree $n$ whose zeroes are all in $\overline{D(0, 1)}$.
We assume that $a$ is a zero of $f$ whose standard part is $1$, and assume that $f$ has no critical points in $\overline{D(a, 1)}$.
Let $\lambda$ be a random zero of $f$ and $\zeta$ a random critical point.
Under these circumstances, $\lambda^{(\infty)}$ is uniformly distributed on $\partial D(0, 1)$ and $\zeta^{(\infty)}$ is almost surely zero. In particular,
$$\mathbf E \log\frac{1}{|\lambda|}, \mathbf E \log |\zeta - a| = O(n^{-1})$$
and $\zeta$ is infinitesimal in probability, hence infinitesimal in distribution.
Let $\mu$ be the expected value of $\zeta$ (thus also of $\lambda$) and $\sigma^2$ its variance.
I think we won't need the nonstandard-exponential bound $\varepsilon_0^n$ this time, as its purpose was fulfilled last time.

Last time we reduced the proof of case one to a sequence of lemmata. We now prove them.

\section{Preliminary bounds}
\begin{lemma}
Let $K \subseteq \mathbf C$ be a compact set. Then
$$f(z) - f(0), ~f'(z) = O((|z| + o(1))^n)$$
uniformly for $z \in K$.
\end{lemma}
\begin{proof}
It suffices to prove this for a compact exhaustion, and thus it suffices to assume
$$K = \overline{D(0, R)}.$$
By underspill, it suffices to show that for every standard $\varepsilon > 0$ we have
$$|f(z) - f(0)|, ~|f'(z)| \leq C(|z| + \varepsilon)^n.$$
We first give the proof for $f'$.

First suppose that $\varepsilon < |z| \leq R$.
Since $\zeta$ is infinitesimal in distribution,
$$\mathbf E \log |z - \zeta| \leq \mathbf E \log \max(|z - \zeta|, \varepsilon/2) \leq \log \max(|z|, \varepsilon/2) + o(1);$$
here we need the $\varepsilon/2$ and the $R$ since $\log |z - \zeta|$ is not a bounded continuous function of $\zeta$.
Since $\varepsilon < |z|$ we have
$$\mathbf E \log |z - \zeta| \leq \log |z| + o(1)$$
but we know that
$$-\frac{\log n}{n - 1} - \frac{1}{n - 1} \log |f'(z)| = U_\zeta(z) = -\mathbf E \log |z - \zeta|$$
so, solving for $\log |f'(z)|$, we get
$$\log |f'(z)| \leq (n - 1) \log |z| + o(n);$$
we absorbed a $\log n$ into the $o(n)$. That gives
$$|f'(z)| \leq e^{o(n)} |z|^{n-1}.$$
Since $f'$ is a polynomial of degee $n - 1$ and $f$ is monic (so the top coefficient of $f'$ is $n$) this gives a bound
$$|f'(z)| \leq e^{o(n)} (|z| + \varepsilon)^{n - 1}$$
even for $|z| \leq \varepsilon$.

Now for $f$, we use the bound
$$|f(z) - f(0)| \leq \max_{|w| < |z|} |f'(w)|$$
to transfer the above argument.
\end{proof}

\section{Uniform convergence of $\zeta$}
\begin{lemma}
There is a standard compact set $S \subseteq \overline{D(0, 1)}$ and a standard countable set $T \subseteq \overline{D(0, 1)} \setminus \overline{D(1, 1)}$ such that
$$S = (\overline{D(0, 1)} \cap \partial D(1, 1)) \cup T,$$
all elements of $T$ are isolated in $S$, and $||\zeta - S||_{L^\infty}$ is infinitesimal.
\end{lemma}
Tao claims
$$\mathbf P(|\zeta - a| \geq \frac{1}{2m}) = O(n^{-1})$$
where $m$ is a large standard natural, which makes no sense since the left-hand side should be large (and in particular, have positive standard part).
I think this is just a typo though.

\begin{proof}
Since $\zeta$ was assumed far from $a = 1 - o(1)$ we have
$$\zeta \in \overline{D(0, 1)} \setminus D(1, 1 - o(1)).$$
We also have
$$\mathbf E \log |\zeta - a| = O(n^{-1})$$
so for every standard natural $m$ there is a standard natural $k_m$ such that
$$\mathbf P(\log |\zeta - a| \geq \frac{1}{2m}) \leq \frac{k_m}{n}.$$
Multiplying both sides by $n$ we see that
$$\text{card } Z \cap K_m = \text{card } Z \cap \{\zeta_0 \in \overline{D(0, 1)}: \log |\zeta_0 - a| \geq \frac{1}{2m}\} \leq k_m$$
where $Z$ is the variety of critical points $f' = 0$.
Let $T_m$ be the set of standard parts of zeroes in $K_m$; then $T_m$ has cardinality $\leq k_m$ and so is finite.
For every zero $\zeta_0 \in Z$, either
\begin{enumerate}
\item For every $m$,
$$|\zeta_0 - a| < \exp\left(\frac{1}{2m}\right)$$
so the standard part of $|\zeta_0 - a|$ is $1$, or
\item There is an $m$ such that $d(\zeta_0, T_m)$ is infinitesimal.
\end{enumerate}
So we may set $T = \bigcup_m T_m$; then $T$ is standard and countable, and does not converge to a point in $\partial D(1, 1)$, so $S$ is standard and $||\zeta - S||_{L^\infty}$ is infinitesimal.

I was a little stumped on why $S$ is compact; Tao doesn't prove this.
It turns out it's obvious, I was just too clueless to see it.
The construction of $T$ forces that for any $\varepsilon > 0$, there are only finitely many $z \in T$ with $|z - \partial D(1, 1)| \geq \varepsilon$, so if $T$ clusters anywhere, then it can only cluster on $\partial D(1, 1)$.
This gives the desired compactness.
\end{proof}

 The above proof is basically just the proof of Ascoli's compactness theorem adopted to this setting and rephrased to replace the diagonal argument (or ðŸ‘ KEEP ðŸ‘ PASSING ðŸ‘ TO ðŸ‘ SUBSEQUENCES ðŸ‘) with the choice of a nonstandard natural.
I think the point is that, once we have chosen a nontrivial ultrafilter on $\mathbf N$, a nonstandard function is the same thing as sequence of functions, and the ultrafilter tells us which subsequences of reals to pass to.

\section{Approximating $f,f'$ outside of $S$}
We break up the approximation lemma into multiple parts.
Let $K$ be a standard compact set which does not meet $S$.
Given a curve $\gamma$ we denote its arc length by $|\gamma|$; we always assume that an arc length does exist.

A point which stumped me for a humiliatingly long time is the following:
\begin{lemma}
Let $z, w \in K$. Then there is a curve $\gamma$ from $z$ to $w$ which misses $S$ and satisfies the uniform estimate
$$|z - w| \sim |\gamma|.$$
\end{lemma}
\begin{proof}
We use the decomposition of $S$ into the arc
$$S_0 = \partial D(1, 1) \cap \overline{D(0, 1)}$$
and the discrete set $T$. We try to set $\gamma$ to be the line segment $[z, w]$ but there are two things that could go wrong.
If $[z, w]$ hits a point of $T$ we can just perturb it slightly by an error which is negligible compared to $[z, w]$.
Otherwise we might hit a point of $S_0$ in which case we need to go the long way around.
However, $S_0$ and $K$ are compact, so we have a uniform bound
$$\max(\frac{1}{|z - S_0|}, \frac{1}{|w - S_0|}) = O(1).$$
Therefore we can instead consider a curve $\gamma$ which goes all the way around $S_0$, leaving $D(0, 1)$.
This curve has length $O(1)$ for $z, w$ close to $S_0$ (and if $z, w$ are far from $S_0$ we can just perturb a line segment without generating too much error).
Using our uniform max bound above we see that this choice of $\gamma$ is valid.
\end{proof}

Recall that the moments $\mu,\sigma$ of $\zeta$ are infinitesimal.

Since $||\zeta - S||_{L^\infty}$ is infinitesimal, and $K$ is a positive distance from any infinitesimals (since it is standard compact), we have
$$|z - \zeta|, |z - \mu| \sim 1$$
uniformly in $z$.
Therefore $f$ has no critical points near $K$ and so $f''/f'$ is holomorphic on $K$.

We first need a version of the fundamental theorem.

\begin{lemma}
Let $\gamma$ be a contour in $K$ of length $|\gamma|$. Then
$$f'(\gamma(1)) = f'(\gamma(0)) \left(\frac{\gamma(1) - \mu}{\gamma(0) - \mu}\right)^{n - 1} e^{O(n) |\gamma| \sigma^2}.$$
\end{lemma}
\begin{proof}
Our bounds on $|z - \zeta|$ imply that we can take the Taylor expansion
$$\frac{1}{z - \zeta} = \frac{1}{z - \mu} + \frac{\zeta - \mu}{(z - \mu)^2} + O(|\zeta - \mu|^2)$$
of $\zeta$ in terms of $\mu$, which is uniform in $\zeta$.
Taking expectations preserves the constant term (since it doesn't depend on $\zeta$), kills the linear term, and replaces the quadratic term with a $\sigma^2$, thus
$$s_\zeta(z) = \frac{1}{z - \mu} + O(\sigma^2).$$
At the start of this series we showed
$$f'(\gamma(1)) = f'(\gamma(0)) \exp\left((n-1)\int_\gamma s_\zeta(z) ~dz\right).$$
Plugging in the Taylor expansion of $s_\zeta$ we get
$$f'(\gamma(1)) = f'(\gamma(0)) \exp\left((n-1)\int_\gamma \frac{dz}{z - \zeta}\right) e^{O(n) |\gamma| \sigma^2}.$$
Simplifying the integral we get
$$\exp\left((n-1)\int_\gamma \frac{dz}{z - \zeta}\right) = \left(\frac{\gamma(1) - \mu}{\gamma(0) - \mu}\right)^{n - 1}$$
whence the claim.
\end{proof}

\begin{lemma}
Uniformly for $z,w \in K$ one has
$$f'(w) = (1 + O(n|z - w|\sigma^2 e^{o(n|z - w|)})) \frac{(w - \mu)^{n-1}}{(z - \mu)^{n - 1}}f'(z).$$
\end{lemma}
\begin{proof}
Applying the previous two lemmata we get
$$f'(w) = e^{O(n|z - w|\sigma^2)} \frac{(w - \mu)^{n-1}}{(z - \mu)^{n - 1}}f'(z).$$
It remains to simplify
$$e^{O(n|z - w|\sigma^2)} = 1 + O(n|z - w|\sigma^2 e^{o(n|z - w|)}).$$
Taylor expanding $\exp$ and using the self-similarity of the Taylor expansion we get
$$e^z = 1 + O(|z| e^{|z|})$$
which gives that bound.
\end{proof}

\begin{lemma}
Let $\varepsilon > 0$. Then
$$f(z) = f(0) + \frac{1 + O(\sigma^2)}{n} f'(z) (z - \mu) + O((\varepsilon + o(1))^n).$$
uniformly in $z \in K$.
\end{lemma}
\begin{proof}
We may assume that $\varepsilon$ is small enough depending on $K$, since the constant in the big-$O$ notation can depend on $K$ as well, and $\varepsilon$ only appears next to implied constants.
Now given $z$ we can find $\gamma$ from $z$ to $\partial B(0, \varepsilon)$ which is always moving at a speed which is uniformly bounded from below and always moving in a direction towards the origin.
Indeed, we can take $\gamma$ to be a line segment which has been perturbed to miss the discrete set $T$, and possibly arced to miss $S_0$ (say if $z$ is far from $D(0, 1)$).
By compactness of $K$ we can choose the bounds on $\gamma$ to be not just uniform in time but also in space (i.e. in $K$), and besides that $\gamma$ is a curve through a compact set $K'$ which misses $S$.
Indeed, one can take $K'$ to be a closed ball containing $K$, and then cut out small holes in $K'$ around $T$ and $S_0$, whose radii are bounded below since $K$ is compact.
Since the moments of $\zeta$ are infinitesimal one has
$$\int_\gamma (w - \mu)^{n-1} ~dw = \frac{(z - \mu)^n}{n} - \frac{\varepsilon^n e^{in\theta}}{n} = \frac{(z - \mu)^n}{n} - O((\varepsilon + o(1))^n).$$
Here we used $\varepsilon < 1$ to enforce
$$\varepsilon^n/n = O(\varepsilon^n).$$

By the previous lemma,
$$f'(w) = (1 + O(n|z - w|\sigma^2 e^{o(n|z - w|)})) \frac{(w - \mu)^{n-1}}{(z - \mu)^{n - 1}}f'(z).$$
Integrating this result along $\gamma$ we get
$$f(\gamma(0)) = f(\gamma(1)) - \frac{f'(\gamma(0))}{(\gamma(0) - \mu)^{n-1}} \left(\int_\gamma (w - \mu)^{n-1} ~dw + O\left(n\sigma^2 \int_\gamma|\gamma(0) - w| e^{o(n|\gamma(0) - w|)}|w - \mu|^{n-1}~dw \right) \right).$$
Applying our preliminary bound, the previous paragraph, and the fact that $|\gamma(1)| = \varepsilon$, thus
$$f(\gamma(1)) = f(0) + O((\varepsilon + o(1))^n),$$
we get
$$f(z) = f(0) + O((\varepsilon + o(1))^n) - \frac{f'(z)}{(z - \mu)^{n-1}} \left(\frac{(z - \mu)^n}{n} - O((\varepsilon + o(1))^n) + O\left(n\sigma^2 \int_\gamma|z - w| e^{o(n|z - w|)}|w - \mu|^{n-1}~dw \right)\right).$$
We treat the first term first:
$$\frac{f'(z)}{(z - \mu)^{n-1}} \frac{(z - \mu)^n}{n} = \frac{1}{n} f'(z) (z - \mu).$$
For the second term, $z \in K$ while $\mu^{(\infty)} \in K$, so $|z - \mu|$ is bounded from below, whence
$$\frac{f'(z)}{(z - \mu)^{n-1}} O((\varepsilon + o(1))^n) = O((\varepsilon + o(1))^n).$$
Thus we simplify
$$f(z) = f(0) + O((\varepsilon + o(1))^n) + \frac{1}{n} f'(z) (z - \mu) + \frac{f'(z)}{(z - \mu)^{n-1}} O\left(n\sigma^2 \int_\gamma|z - w| e^{o(n|z - w|)}|w - \mu|^{n-1}~dw \right).$$
It will be convenient to instead write this as
$$f(z) = f(0) + O((\varepsilon + o(1))^n) + \frac{1}{n} f'(z) (z - \mu) + O\left(n|f'(z)|\sigma^2 \int_\gamma|z - w| e^{o(n|z - w|)} \left|\frac{w - \mu}{z - \mu}\right|^{n-1}~dw \right).$$

Now we deal with the pesky integral.
Since $\gamma$ is moving towards $\partial B(0, \varepsilon)$ at a speed which is bounded from below uniformly in ``spacetime" (that is, $K \times [0, 1]$), there is a standard $c > 0$ such that if $w = \gamma(t)$ then
$$|w - \mu| \leq |z - \mu| - ct$$
since $\gamma$ is going towards $\mu$.
(Tao's argument puzzles me a bit here because he claims that the real inner product $\langle z - w, z\rangle$ is uniformly bounded from below in spacetime, which seems impossible if $w = z$. I agree with its conclusion though.)
Exponentiating both sides we get
$$\left|\frac{w - \mu}{z - \mu}\right|^{n-1} = O(e^{-nct})$$
which bounds
$$f(z) = f(0) + O((\varepsilon + o(1))^n) + \frac{1}{n} f'(z) (z - \mu) + O\left(n|f'(z)|\sigma^2 \int_0^1 te^{-(c-o(1))nt} ~dt\right).$$
Since $c$ is standard, it dominates the infinitesimal $o(1)$, so after shrinking $c$ a little we get a new bound
$$f(z) = f(0) + O((\varepsilon + o(1))^n) + \frac{1}{n} f'(z) (z - \mu) + O\left(n|f'(z)|\sigma^2 \int_0^1 te^{-cnt} ~dt\right).$$
Since $n\int_0^1 te^{-cnt} ~dt$ is exponentially small in $n$, in particular it is smaller than $O(n^{-1})$.
Plugging in everything we get the claim.
\end{proof}

\section{Control on zeroes away from $S$}
After the gargantuan previous section, we can now show the ``approximate level set" property that we discussed last time.

\begin{lemma}
Let $K$ be a standard compact set which misses $S$ and $\varepsilon > 0$ standard. Then for every zero $\lambda_0 \in K$ of $f$,
$$U_\zeta(\lambda) = \frac{1}{n} \log \frac{1}{|f(0)|} + O(n^{-1}\sigma^2 + (\varepsilon + o(1))^n).$$
\end{lemma}
Last time we showed that this implies
$$U_\zeta(\lambda_0) = U_\zeta(a) + O(n^{-1}\sigma^2 + (\varepsilon + o(1))^n).$$
Thus all the zeroes of $f$ either live in $S$ or a neighborhood of a level set of $U_\zeta$.
\begin{proof}
Plugging in $z = \lambda_0$ in the approximation
$$f(z) = f(0) + \frac{1 + O(\sigma^2)}{n} f'(z) (z - \mu) + O((\varepsilon + o(1))^n)$$
we get
$$f(0) + \frac{1 + O(\sigma^2)}{n} f'(\lambda_0) (\lambda_0 - \mu) = O((\varepsilon + o(1))^n).$$
Several posts ago, we proved $|f(0)| \sim 1$ as a consequence of Grace's theorem, so $f(0)O((\varepsilon + o(1))^n) = O((\varepsilon + o(1))^n)$.
In particular, if we solve for $f'(\lambda_0)$ we get
$$\frac{|f'(\lambda_0)}{n} |\lambda_0 - \mu| = |f(0)| (1 + O(\sigma^2 + (\varepsilon + o(1))^n).$$
Using
$$U_\zeta(z) = -\frac{\log n}{n - 1} - \frac{1}{n - 1} \log |f'(z)|,$$
plugging in $z = \lambda_0$, and taking logarithms, we get
$$-\frac{n - 1}{n} U_\zeta(\lambda_0) + \frac{1}{n} \log | \lambda_0 - \mu| = \frac{1}{n} \log |f(0)| + O(n^{-1}\sigma^2 + (\varepsilon + o(1))^n).$$
Now $\lambda_0 \in K$ and $K$ misses the standard compact set $S$, so since $0 \in S$ we have
$$|\lambda - \zeta|, |\lambda - \mu| \sim 1$$
(since $\zeta^{(\infty)} \in S$ and $\mu$ is infinitesimal).
So we can Taylor expand in $\zeta$ about $\mu$:
$$\log |\lambda_0 - \zeta| = \log |\lambda_0 - \mu| - \text{Re }\frac{\zeta - \mu}{\lambda_0 - \mu} + O(\sigma^2).$$
Taking expectations and using $\mathbf E \zeta - \mu$,
$$-U_\zeta(\lambda_0) = \log |\lambda_0 - \mu| + O(\sigma^2).$$
Plugging in $\log |\lambda_0 - \mu|$ we see the claim.
\end{proof}

I'm not sure who originally came up with the idea to reason like this; I think Tao credits M. J. Miller.
Whoever it was had an interesting idea, I think: $f = 0$ is a level set of $f$, but one that a priori doesn't tell us much about $f'$.
We have just replaced it with a level set of $U_\zeta$, a function that is explicitly closely related to $f'$, but at the price of an error term.

\section{Fine control}
We finish this series.
If you want, you can let $\varepsilon > 0$ be a standard real.
I think, however, that it will be easier to think of $\varepsilon$ as ``infinitesimal, but not as infinitesimal as the term of the form o(1)".
In other words, $1/n$ is smaller than any positive element of the ordered field $\mathbf R(\varepsilon)$; briefly, $1/n$ is infinitesimal with respect to $\mathbf R(\varepsilon)$.
We still reserve $o(1)$ to mean an infinitesimal with respect to $\mathbf R(\varepsilon)$.
Now $\varepsilon^n = o(1)$ by underspill, since this is already true if $\varepsilon$ is standard and $0 < \varepsilon < 1$.
Underspill can also be used to transfer facts at scale $\varepsilon$ to scale $1/n$.
I think you can formalize this notion of ``iterated infinitesimals" by taking an \emph{iterated} ultrapower of $\mathbf R$ in the theory of ordered rings.

Let us first bound $\log |a|$. Recall that $|a| \leq 1$ so $\log |a| \leq 0$ but in fact we can get a sharper bound.
Since $T$ is discrete we can get $e^{-i\theta}$ arbitrarily close to whatever we want, say $-1$ or $i$.
This will give us bounds on $1 - a$ when we take the Taylor expansion
$$\log|a| = -(1 - a)(1 + o(1)).$$
\begin{lemma}
Let $e^{i\theta} \in \partial D(0, 1) \setminus S$ be standard. Then
$$\log |a| \leq \text{Re } ((1 - e^{-i\theta} + o(1))\mu) - O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
\end{lemma}
\begin{proof}
Let $K$ be a standard compact set which misses $S$ and $\lambda_0 \in K$ a zero of $f$.
Since $\zeta \notin K$ (since $S$ is close to $\zeta$) and $|a-\zeta|$ has positive standard part (since $d(a, S) = 1$) we can take Taylor expansions
$$-\log |\lambda_0 - \zeta| = -\log |\lambda_0| + \text{Re } \frac{\zeta}{\lambda_0} + O(|\zeta|^2)$$
and
$$-\log |a - \zeta| = -\log|a| + \text{Re } \frac{\zeta}{a} + O(|\zeta|^2)$$
in $\zeta$ about $0$. Taking expectations we have
$$U_\zeta(\lambda_0) = -\log |\lambda_0| + \text{Re } \frac{\mu}{\lambda_0} + O(\mathbf E |\zeta|^2)$$
and similarly for $a$. Thus
$$-\log |a| + \text{Re } \frac{\mu}{a} = -\log |\lambda_0| + \text{Re } \frac{\mu}{\lambda_0} + O(\mathbf E |\zeta|^2 + n^{-1}\sigma^2 + (\varepsilon + o(1))^n)$$
since
$$U_\zeta(\lambda_0) - U_\zeta(a) = O(n^{-1}\sigma^2 + (\varepsilon + o(1))^n).$$
Since
$$\mathbf E|\zeta|^2 = |\mu|^2 + \sigma^2$$
we have
$$-\log|\lambda_0| + \text{Re } \left(\frac{1}{\lambda_0} - \frac{1}{a}\right)\mu = -\log|a| + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Now $|\lambda_0| \leq 1$ so $-\log |\lambda_0| \geq 0$, whence
$$\text{Re } \left(\frac{1}{\lambda_0} - \frac{1}{a}\right)\mu \geq -\log|a| + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Now recall that $\lambda^{(\infty)}$ is uniformly distributed on $\partial D(0, 1)$, so we can choose $\lambda_0$ so that
$$|\lambda_0 - e^{i\theta}| = o(1).$$
Thus
$$\frac{1}{\lambda_0} - \frac{1}{a} = 1 - e^{-i\theta} + o(1)$$
which we can plug in to get the claim.
\end{proof}

Now we prove the first part of the fine control lemma.
\begin{lemma}
One has
$$\mu, 1 - a = O(\sigma^2 + (\varepsilon + o(1))^n).$$
\end{lemma}
\begin{proof}
Let $\theta_+ \in [0.98\pi, 0.99\pi],\theta_- \in [1.01\pi, 1.02\pi]$ be standard reals such that $e^{i\theta_\pm} \notin S$.
I don't think the constants here actually matter; we just need $0 < 0.01 < 0.02 < \pi/8$ or something.
Anyways, summing up two copies of the inequality from the previous lemma with $\theta = \theta_\pm$ we have
$$1.9 \text{Re } \mu \geq \text{Re } ((1 + e^{-i\theta_+} + 1 + e^{-i\theta_-} + o(1))\mu) \geq \log |a| + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n)$$
since
$$2 + e^{-i\theta_+} + e^{-i\theta_-} + o(1) \leq 1.9.$$
That is,
$$\text{Re } \mu \geq \frac{\log|a|}{1.9} + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Indeed,
$$-\log |a| = (1 - a)(1 + o(1)),$$
so
$$\text{Re }\mu \geq -\frac{1 - a}{1.9 + o(1)} + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$

If we square the tautology $|\zeta - a| \geq 1$ then we get
$$|\zeta|^2 - 2a \text{Re }\zeta + a^2 \geq 1.$$
Taking expected values we get
$$|\mu|^2 + \sigma^2 - 2a \text{Re }\mu + a^2 \geq 1$$
or in other words
$$\text{Re }\mu \leq -\frac{1 - a^2}{2a} + O(|\mu|^2 + \sigma^2) = -(1 - a)(1 + o(1)) + O(|\mu|^2 + \sigma^2)$$
where we used the Taylor expansion
$$\frac{1 - a^2}{2a} = (1 - a)(1 + o(1))$$
obtained by Taylor expanding $1/a$ about $1$ and applying $1 - a = o(1)$.
Using
$$\text{Re }\mu \geq -\frac{1 - a}{1.9 + o(1)} + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n)$$
we get
$$-\frac{1 - a}{1.9 + o(1)} + O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n) \leq \text{Re }\mu \leq -(1 - a)(1 + o(1)) + O(|\mu|^2 + \sigma^2)$$
Thus
$$(1 - a)\left(1 + \frac{1}{1.9 + o(1)} + o(1)\right) = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Dividing both sides by $1 + \frac{1}{1.9 + o(1)} + o(1) \in [1, 2]$ we have
$$1 - a = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
In particular
$$\text{Re }\mu = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n)(1 + o(1)) + O(|\mu|^2 + \sigma^2) = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$

Now we treat the imaginary part of $\text{Im } \mu$.
The previous lemma gave
$$\text{Re } ((1 - e^{-i\theta} + o(1))\mu) - \log |a| = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Writing everything in terms of real and imaginary parts we can expand out
$$\text{Re } ((1 - e^{-i\theta} + o(1))\mu) = (\sin \theta + o(1))\text{Re } \mu + (1 - \cos \theta + o(1))\text{Re }\mu.$$
Using the bounds
$$(1 - \cos \theta + o(1))\text{Re }\mu, ~\log |a| = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n)$$
(Which follow from the previous paragraph and the bound $\log |a| = O(1 - a)$), we have
$$(\sin \theta + o(1))\text{Im } \mu = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Since $T$ is discrete we can find $\theta$ arbitrarily close to $\pm \pi/2$ which meets the hypotheses of the above equation.
Therefore
$$\text{Im } \mu = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Pkugging everything in, we get
$$1 - a \sim \mu = O(|\mu|^2 + \sigma^2 + (\varepsilon + o(1))^n).$$
Now $|\mu|^2 = o(|\mu|)$ since $\mu$ is infinitesimal; therefore we can discard that term.
\end{proof}

Now we are ready to prove the second part.
The point is that we are ready to dispose of the semi-infinitesimal $\varepsilon$.
Doing so puts a lower bound on $U_\zeta(a)$.
\begin{lemma}
Let $I \subseteq \partial D(0, 1) \setminus S$ be a standard compact set. Then for every $e^{i\theta} \in I$,
$$U_\zeta(a) - U_\zeta(e^{i\theta}) \geq -o(\sigma^2) - o(1)^n.$$
\end{lemma}
\begin{proof}
Since $\lambda^{(\infty)}$ is uniformly distributed on $\partial D(0, 1)$, there is a zero $\lambda_0$ of $f$ with $|\lambda_0 - e^{i\theta}| = o(1)$.
Since $|\lambda_0| \leq 1$, we can find an infinitesimal $\eta$ such that
$$\lambda_0 = e^{i\theta}(1 - \eta)$$
and $|1 - \eta| \leq 1$.
In the previous section we proved
$$U_\zeta(a) - U_\zeta(\lambda_0) = O(n^{-1}\sigma^2) + (\varepsilon + o(1))^n).$$
Using $n^{-1} = o(1)$ and plugging in $\lambda_0$ we have
$$U_\zeta(a) - U_\zeta(e^{i\theta}(1 - \eta)) = o(\sigma^2) + O((\varepsilon + o(1))^n).$$
Now
$$\text{Re } \eta \int_0^1 \frac{dt}{1 - t\eta + e^{-i\theta}\zeta} = \log |1 - e^{-i\theta}\zeta| - \log|1 - \eta - e^{-i\theta}\zeta| = \log|e^{i\theta} - \zeta| - \log|e^{i\theta} - e^{i\theta}\eta - \zeta|.$$
Taking expectations,
$$\text{Re }\eta \mathbf E\int_0^1 \frac{dt}{1 - t\eta + e^{-i\theta}\zeta} = U_\zeta(e^{i\theta}(1 - \eta)) - U_\zeta(e^{i\theta}).$$
Taking a Taylor expansion,
$$\frac{1}{1 - t\eta - e^{-i\theta}\zeta} = \frac{1}{1 - t\eta} + \frac{e^{-i\theta}\zeta}{(1 - t\eta)^2} + O(|\zeta|^2)$$
so by Fubini's theorem
$$\mathbf E\int_0^1 \frac{dt}{1 - t\eta + e^{-i\theta}\zeta} = \int_0^1 \left(\frac{1}{1 - t\eta} + \frac{e^{-i\theta}}{(1 - t\eta)^2}\mu + O(|\mu|^2 + \sigma^2)\right)~dt;$$
using the previous lemma and $\eta = o(1)$ we get
$$ U_\zeta(e^{i\theta}(1 - \eta)) - U_\zeta(e^{i\theta}) = \text{Re }\eta \int_0^1 \frac{dt}{1 - t\eta} + o(\sigma^2) + O((\varepsilon + o(1))^n).$$
We also have
$$\text{Re } \eta \int_0^1 \frac{dt}{1 - t\eta} = -\log \frac{1}{e^{i\theta} - e^{i\theta}\eta} = U_0(1 - \eta)$$
since $0$ is deterministic (and $U_0(e^{i\theta} z) = U_0(z)$, and $U_0(1) = 0$; very easy to check!)
I think Tao makes a typo here, referring to $U_i(e^{i\theta}(1 - \eta))$, which seems irrelevant. We do have
$$U_0(1 - \eta) = -\log|1 - \eta| \geq 0$$
since $|1 - \eta| \leq 0$. Plugging in
$$\text{Re } \eta \int_0^1 \frac{dt}{1 - t\eta} \geq 0$$
we get
$$U_\zeta(e^{i\theta} - e^{i\theta}\eta) - U_\zeta(e^{i\theta}) \geq -o(\sigma^2) - O((\varepsilon + o(1))^n).$$
I think Tao makes another typo, dropping the Big O, but anyways,
$$U_\zeta(a) - U_\zeta(e^{i\theta} - e^{i\theta}\eta) = o(\sigma^2) - O((\varepsilon + o(1))^n)$$
so by the triangle inequality
$$U_\zeta(a) - U_\zeta(e^{i\theta}) \geq -o(\sigma^2) - O((\varepsilon + o(1))^n).$$
By underspill, then, we can take $\varepsilon \to 0$.
\end{proof}

We need a result from complex analysis called Jensen's formula which I hadn't heard of before.
\begin{theorem}[Jensen's formula]
Let $g: D(0, 1) \to \mathbf C$ be a holomorphic function with zeroes $a_1, \dots, a_n \in D(0, 1)$ and $g(0) \neq 0$. Then
$$\log |g(0)| = \sum_{j=1}^n \log |a_j| + \frac{1}{2\pi} \int_0^{2\pi} \log |g(e^{i\theta})| ~d\theta.$$
\end{theorem}
In hindsight this is kinda trivial but I never realized it. In fact $\log |g|$ is subharmonic and in fact its Laplacian is exactly a linear combination of delta functions at each of the zeroes of $g$. If you subtract those away then this is just the mean-value property
$$\log |g(0)| = \frac{1}{2\pi} \int_0^{2\pi} \log |g(e^{i\theta})| ~d\theta.$$

Let us finally prove the final part.
In what follows, implied constants are allowed to depend on $\varphi$ but not on $\delta$.

\begin{lemma}
For any standard $\varphi \in C^\infty(\partial D(0, 1))$,
$$\int_0^{2\pi} \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) ~d\theta = o(\sigma^2) + o(1)^n.$$
Besides,
$$U_\zeta(a) = o(\sigma^2) + o(1)^n.$$
\end{lemma}
\begin{proof}
Let $m$ be the Haar measure on $\partial D(0, 1)$.
We first prove this when $\varphi \geq 0$.
Since $T$ is discrete and $\partial D(0, 1)$ is compact, for any standard (or semi-infinitesimal) $\delta > 0$, there is a standard compact set
$$I \subseteq \partial D(0, 1) \setminus S$$
such that
$$m(\partial D(0, 1) \setminus I) < \delta.$$
By the previous lemma, if $e^{i\theta} \in I$ then
$$\varphi(e^{i\theta}) U_\zeta(a) - \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) \geq -o(\sigma^2) - o(1)^n$$
and the same holds when we average in Haar measure:
$$ U_\zeta(a)\int_I \varphi~dm - \int_I \varphi(e^{i\theta}) U_\zeta(e^{i\theta})~dm(e^{i\theta}) \geq -o(\sigma^2) - o(1)^n.$$

We have
$$|\log |e^{i\theta} - \zeta| + \text{Re } e^{-i\theta}\zeta| \leq |\log|3 - \zeta| + 3\text{Re } \zeta| \in L^2(dm(e^{i\theta}))$$
so, using the Cauchy-Schwarz inequality, one has
$$\int_{\partial D(0, 1) \setminus I} \varphi(e^{i\theta}) (\log |e^{i\theta} - \zeta| + \text{Re } e^{-i\theta}\zeta) ~dm(e^{i\theta}) = \sqrt{\int_I |\log |e^{i\theta} - \zeta| + \text{Re } e^{-i\theta}\zeta|} = O(\delta^{1/2}).$$
Meanwhile, if $|\zeta| \leq 1/2$ then the fact that
$$\log |e^{i\theta} - \zeta| = \text{Re }-\frac{\zeta}{e^{i\theta}} + O(|\zeta|^2)$$
implies
$$\log |e^{i\theta} - \zeta| + \text{Re } \frac{\zeta}{e^{i\theta}} = O(|\zeta|^2)$$
and hence
$$\int_{\partial D(0, 1) \setminus I} \varphi(e^{i\theta}) (\log |e^{i\theta} - \zeta| + \text{Re } e^{-i\theta}\zeta) ~dm(e^{i\theta}) = O(\delta|\zeta|^2).$$
We combine these into the unified estimate
$$\int_{\partial D(0, 1) \setminus I} \varphi(e^{i\theta}) (\log |e^{i\theta} - \zeta| + \text{Re } e^{-i\theta}\zeta) ~dm(e^{i\theta}) = O(\delta^{1/2}|\zeta|^2)$$
valid for all $|\zeta| \leq 1$, hence almost surely.
Taking expected values we get
$$\int_{\partial D(0, 1) \setminus I} \varphi(e^{i\theta})U_\zeta(e^{i\theta}) + \varphi(e^{i\theta}) \text{Re }e^{-i\theta}\mu ~dm(e^{i\theta}) = O(\delta^{1/2}(|\mu|^2 + \sigma^2)) + o(\sigma^2) + o(1)^n.$$
In the last lemma we bounded $|\mu|$ so we can absorb all the terms with $\mu$ in them to get
$$\int_{\partial D(0, 1) \setminus I} \varphi(e^{i\theta})U_\zeta(e^{i\theta}) ~dm(e^{i\theta}) = O(\delta^{1/2}\sigma^2) + o(\sigma^2) + o(1)^n.$$
We also have
$$\int_{\partial D(0, 1) \setminus I} \varphi ~dm = O(\delta)$$
(here Tao refers to a mysterious undefined measure $\sigma$ but I'm pretty sure he means $m$).
Putting these integrals together with the integrals over $I$,
$$\ U_\zeta(a)int_{\partial D(0, 1)} \varphi ~dm - \int_{\partial D(0, 1)} \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) ~dm(e^{i\theta}) \geq -O(\delta^{1/2}\sigma^2) - o(\sigma^2) - o(1)^n.$$
By underspill we can delete $\delta$, thus
$$ U_\zeta(a)\int_{\partial D(0, 1)} \varphi ~dm - \int_{\partial D(0, 1)} \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) ~dm(e^{i\theta}) \geq - o(\sigma^2) - o(1)^n.$$

We now consider the specific case $\varphi = 1$. Then
$$U_\zeta(a) - \int_{\partial D(0, 1)} U_\zeta ~dm \geq -o(\sigma^2) - o(1)^n.$$
Now Tao claims and doesn't prove
$$\int_{\partial D(0, 1)} U_\zeta ~dm = 0.$$
To see this, we expand as
$$\int_{\partial D(0, 1)} U_\zeta ~dm = -\mathbf E \frac{1}{2\pi} \int_0^{2\pi} \log|\zeta - e^{i\theta}| ~d\theta$$
using Fubini's theorem. Now we use Jensen's formula with $g(z) = \zeta - z$, which has a zero exactly at $\zeta$.
This seems problematic if $\zeta = 0$, but we can condition on $|\zeta| > 0$. Indeed, if $\zeta = 0$ then we have
$$ \int_0^{2\pi} \log|\zeta - e^{i\theta}| ~d\theta = \int_0^{2\pi} \log 1 ~d\theta = 0$$
which already gives us what we want. Anyways, if $|\zeta| > 0$, then by Jensen's formula,
$$\frac{1}{2\pi} \int_0^{2\pi} \log|\zeta - e^{i\theta}| ~d\theta = \log |\zeta| - \log |\zeta| = 0.$$
So that's how it is.
Thus we have
$$-U_\zeta(a) \leq o(\sigma^2) + o(1)^n.$$
Since $|a - \zeta| \geq 1$, $\log |a - \zeta| \geq 0$, so the same is true of its expected value $-U_\zeta(a)$.
This gives the desired bound
$$U_\zeta(a) = o(\sigma^2) + o(1)^n.$$

We can use that bound to discard $U_\zeta(a)$ from the average
$$ U_\zeta(a)\int_{\partial D(0, 1)} \varphi ~dm - \int_{\partial D(0, 1)} \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) ~dm(e^{i\theta}) \geq - o(\sigma^2) - o(1)^n,$$
thus
$$\int_{\partial D(0, 1)} \varphi(e^{i\theta}) U_\zeta(e^{i\theta}) ~dm(e^{i\theta})= o(\sigma^2) + o(1)^n.$$
Repeating the Jensen's formula argument from above we see that we can replace $\varphi$ with $\varphi - k$ for any $k \geq 0$.
So this holds even if $\varphi$ is not necessarily nonnegative.
\end{proof}



\end{document}
