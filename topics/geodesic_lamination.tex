\documentclass[reqno,12pt,letterpaper]{amsart}
\RequirePackage{amsmath,amssymb,amsthm,graphicx,mathrsfs,url}
\RequirePackage[usenames,dvipsnames]{color}
\RequirePackage[colorlinks=true,linkcolor=Red,citecolor=Green]{hyperref}
\RequirePackage{amsxtra}
\usepackage{cancel}
\usepackage{tikz-cd}

\setlength{\textheight}{8.50in} \setlength{\oddsidemargin}{0.00in}
\setlength{\evensidemargin}{0.00in} \setlength{\textwidth}{6.08in}
\setlength{\topmargin}{0.00in} \setlength{\headheight}{0.18in}
\setlength{\marginparwidth}{1.0in}
\setlength{\abovedisplayskip}{0.2in}
\setlength{\belowdisplayskip}{0.2in}
\setlength{\parskip}{0.05in}
\renewcommand{\baselinestretch}{1.10}

\title[Geodesic laminations by minimal currents]{Geodesic laminations by minimal currents}
\author{Aidan Backus}
\date{July 2021}

\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\PP}{\mathbf P}
\newcommand{\MM}{\mathbf M}
\newcommand{\II}{\mathbf I}
\newcommand{\Hyp}{\mathbf H}

\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\cent}{center}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\Lip}{Lip}
\DeclareMathOperator{\Met}{Met}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\rad}{rad}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Radon}{Radon}
\DeclareMathOperator*{\Res}{Res}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\singsupp}{sing~supp}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Tan}{Tan}
\newcommand{\tr}{\operatorname{tr}}

\newcommand{\Ric}{\mathrm{Ric}}
\newcommand{\Riem}{\mathrm{Riem}}

\newcommand{\dbar}{\overline \partial}

\DeclareMathOperator{\atanh}{atanh}
\DeclareMathOperator{\csch}{csch}
\DeclareMathOperator{\sech}{sech}

\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\Ell}{Ell}
\DeclareMathOperator{\WF}{WF}

\newcommand{\Hilb}{\mathcal H}
\newcommand{\normal}{\mathbf n}
\newcommand{\vol}{\mathrm{vol}}

\newcommand{\pic}{\vspace{30mm}}
\newcommand{\dfn}[1]{\emph{#1}\index{#1}}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}


\newtheorem{theorem}{Theorem}[section]
\newtheorem{badtheorem}[theorem]{``Theorem"}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{assumption}[theorem]{Assumption}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{notation}[theorem]{Notation}

\newtheorem{exercise}[theorem]{Discussion topic}
\newtheorem{homework}[theorem]{Homework}
\newtheorem{problem}[theorem]{Problem}

\newtheorem{ack}{Acknowledgements}

\numberwithin{equation}{section}


% Mean
\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

%\usepackage{color}
%\hypersetup{%
%    colorlinks=true, % make the links colored%
%    linkcolor=blue, % color TOC links in blue
%    urlcolor=red, % color URLs in red
%    linktoc=all % 'all' will create links for everything in the TOC
%Ning added hyperlinks to the table of contents 6/17/19
%}

% style=alphabetic
\usepackage[backend=bibtex,maxcitenames=50,maxnames=50]{biblatex}
\addbibresource{topics.bib}
\renewbibmacro{in:}{}
\DeclareFieldFormat{pages}{#1}

\begin{document}
\begin{abstract}
Topics exam, Fall 2021.
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \tableofcontents

\section{Introduction}
Let $M$ be an oriented Riemannian manifold of metric $g$ and dimension $d \geq 2$.

\begin{definition}\label{main definitions}
A function $u \in BV_l(M)$ has \dfn{least gradient} if for every $v \in BV_c(M)$ and $\supp v \subseteq U \Subset M$,
$$\int_U |du| ~\vol \leq \int_U |du + dv| ~\vol.$$
A Caccioppoli set $U$ has \dfn{least perimeter} if $1_U$ has least gradient.
\end{definition}

See the appendix for the relevant measure-theoretic definitions.
Functions of least gradient can be viewed as the correct notion of weak solution to the Dirichlet problem for the Euler-Lagrange equation
\begin{equation}\label{EulerLagrange}
\Div \frac{\grad u}{|\grad u|} = 0.
\end{equation}
% In particular, if $U$ has least perimeter, $u = 1_U$, and $U$ has enough regularity one can view $\grad u/|\grad u|$ as the unit normal field to $U$, so one may view the Euler-Lagrange equation as meaning that $\partial U$ has no mean curvature.
% However, by Theorem \ref{minimal cones in R8}, it is impossible to define the mean curvature of $\partial U$ in general.
In particular, if $U$ has least perimeter and can be expressed as the graph of a $C^1$ function $f$, then $f$ solves the minimal surface equation (MSE), which is by definition the Euler-Lagrange equation with Lagrangian density
\begin{equation}\label{Lagrangian density}
\mathscr L = \sqrt{1 + |df|^2} ~\vol.
\end{equation}

\begin{theorem}\label{main thm}
Let $u: M \to \RR$ be a function of least gradient, $d \leq 7$, and $A_y = \partial \{u > y\}$.
Then $(A_y)_{y \in \RR}$ is a lamination of $u$ by smooth minimal hypersurfaces, which are analytic if $g$ is.
\end{theorem}

If $M = \RR^d$, then Theorem \ref{main thm} is essentially a standard result; see \cite[Proposition 3.4]{górny2017planar} for an exposition in that case.
A proof of an analogous result for currents is given by \cite[\S5.3]{federer2014geometric}; our proof uses a similar strategy but is rather ``hands-on" in that it avoids the use of homological integration theory.

In the case of a surface, Theorem \ref{main thm} can be stated in a somewhat stronger form, just as in \cite[Corollary 3.5]{górny2017planar}.

\begin{theorem}\label{main crly}
Let $\overline \Sigma$ be a convex surface with boundary and suppose that $u: \Sigma \to \RR$ is a function of least gradient defined on the interior $\Sigma$ of $\overline \Sigma$.
Then, if $A_y = \partial \{u > y\}$, $(A_y)_{y \in \RR}$ extends to a geodesic lamination of $\overline \Sigma$.
\end{theorem}
%
% As a by-product of Theorem \ref{main thm}, we recover the Riemannian case of \cite[Theorem 5.3.20]{federer2014geometric}:
%
% \begin{corollary}\label{main crly 2}
% Every minimal $1$-current on a Riemannian surface can be written as the finite sum of disjoint geodesics.
% \end{corollary}
%
% The statement of Theorem \ref{main thm} implies a great deal of rigidity for functions of least gradient.
% Let us just consider some of the consequences for the $2$-dimensional model geometries, where geodesic laminations are particularly well understood.
%
% \begin{example}[spherical geometry]
% Let $M = S^2$. Then, up to a rotation, the only functions of least gradient are of the form $u = y_N 1_N + y_S 1_S$ where $N,S$ are the northern and southern hemispheres of $M$ respectively.
% To see this we first argue that $u$ is two-valued; if not, so there are $y_1 < y_2 < y_3$ for which $\{u > y_i\}$ are all sets of positive measure, we can find great circles $C_1,\gamma_2$ so that $C_1$ bounds $\{u > y_3\}$ and $C_2$ bounds $\{u > y_2\}$.
% So $C_1,C_2$ are distinct and therefore intersect, a contradiction.
% So for any $u$ we can find $y_N, y_S$ such that the essential image of $u$ is $\{y_N, y_S\}$ and a great circle bounds $\{u = y_S\}$.
% Thus we may assume that $\{u = y_S\} = S$.
% \end{example}
%
% \begin{example}[euclidean geometry]
% Let $M = \RR^2$. Then, up to a rigid motion, the only functions of least gradient are of the form $u(x) = f(x_1)$ where $f' \geq 0$.
% Indeed, if $\{u > y\}$ is neither null nor conull then $\partial \{u > y\}$ is a line $\ell$, and we may assume that $\ell$ is $\{x_2 = 0\}$.
% If $\{u > z\}$ is also neither null nor conull but $\partial \{u > z\}$ is not parallel to $\{x_2 = 0\}$ then $\partial \{u > z\}$ intersects $\{x_2 = 0\}$ which is a contradiction.
% Thus $\partial_2 u = 0$, and the Euler-Lagrange equation (\ref{EulerLagrange}) simplifies to $f'' = 0$, so $f$ is monotone.
% Thus we may assume that $f$ is increasing.
% \end{example}
%
% \begin{example}[hyperbolic geometry]
% Let $M = \Hyp^2/\Gamma$ be a closed (orientable) hyperbolic surface.
% Then for every function $u$ of least gradient the image of $u$ is countable, say $\{y_j: j \in \NN\}$, and closed geodesics $\gamma_j$ such that $\gamma_j,\gamma_{j+1}$ bound $\{u = y_j\}$.
% To see this we recall that the closed geodesics on $M$ are in bijection with conjugacy classes of $\Gamma$, which is a discrete subgroup of $\mathrm{PSL}(\RR^2)$ and therefore is countable.
% Moreover the superlevel sets $\{u > y\}$ must be bounded by closed geodesics, for if not, they are bounded by geodesics that cluster on themselves, which is absurd.
% \end{example}

The hypothesis $d \leq 7$ in Theorem \ref{main thm} is sharp, owing to the following celebrated theorem \cite[Theorem 6.2.2]{Simons68} \cite[Theorem A]{BOMBIERI1969}.
Recall that a \dfn{minimal cone} $C$ is a cone of least perimeter with vertex at the origin.

\begin{theorem}\label{minimal cones in R8}
The following are equivalent:
\begin{enumerate}
\item $d \leq 7$.
\item The boundary of every minimal cone in $\RR^d$ is $C^1$.
\item The boundary of every minimal cone in $\RR^d$ is a hyperplane.
\end{enumerate}
\end{theorem}

In fact, the minimal cone
\begin{equation}\label{bad minimal cone}
\{(x, y) \in \RR^{4 + 4}: |x| < |y|\}
\end{equation}
is singular at $0$ \cite[Theorem A]{BOMBIERI1969}.
So if $M = \RR^d$ and $d \geq 8$, we can take $u$ to be the indicator function of a singular minimal cone in $\RR^d$.
It would be interesting to modify (\ref{bad minimal cone}) to more general Riemannian manifolds of dimension $8$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \subsection{Strategy of the proof}
%
% Let us recall the strategy of the proof of Theorem \ref{main thm} in case $M = \RR^d$\footnote{For a much more detailed exposition, see \cite{Giusti77}.}.
% One first reduces to the case that $u$ is the indicator function of a set whose boundary $N$ has least perimeter.
% Blowing up $N$ near a point creates a sequence $(N_j)$ of minimal hypersurfaces converging to the boundary of a minimal cone $C$, which necessarily must be a hyperplane by Theorem \ref{minimal cones in R8}.
% In particular, $C$ has a normal vector.
% One then uses the de Giorgi lemma \cite{deGiorgi61} to show that if $j$ is large enough then $N_j$ also has a normal vector, but $N_j$ was just a rescaling of $N$, so $N$ has a normal vector and $C$ is the tangent space to $N$.
% This implies that $N$ is $C^1$, and one may now use standard elliptic regularity theory to conclude the claim.
%
% This strategy must be modified somewhat in the presence of curvature.
% The bulk of the work is proving a suitable de Giorgi lemma.
% , and in fact we show:
%
% \begin{proposition}[Proposition \ref{induction 2}, imprecise]\label{imprecise induction 2}
% Let $U \subseteq \RR^d$ be a set of least perimeter with respect to a metric $g$ on $\RR^d$ such that lines through the origin are geodesics, and let
% $$\Lambda(U, \rho) = \int_{B(p, \rho)} |d1_U| ~\vol - \left|\int_{B(p, \rho)} d1_U ~\vol\right|.$$
% Then if $\Lambda(U, \rho)\rho^{1 - d}$ and $\alpha$ are small enough,
% $$\Lambda(U, \alpha \rho) < \alpha^d \Lambda(U, \rho).$$
% \end{proposition}
%
% There are two obstructions to a proof of Proposition \ref{imprecise induction 2} which were not present in the euclidean case:
% \begin{enumerate}
% \item The lack of a sufficiently strong monotonicity formula.
% \item The lack of scale-invariance of the volume form (and hence the notion of least perimeter).
% \end{enumerate}
% Both of these essentially amount to a lack of scale-invariance.
% To deal with the first two issues we identify a scale-invariant quantity $\Gamma$; roughly $1/\Gamma$ measures ``how difficult it is to approximate a minimal hypersurface by a $C^1$ hypersurface".


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Outline of the paper}
We begin with the preliminaries in Section \ref{RiemMeasureThy}, which records basic results on functions of approximately least gradient, including a generalization of Miranda's theorem \cite[Teorema 3]{Miranda67} on the stability of functions of least gradient.
We also show that the reduced boundary of a Caccioppoli set is metric-independent.

We are then ready to prove Theorems \ref{main thm} and \ref{main crly}.
In Section \ref{inequalities} we prove a monotonicity formula and an isoperimetric inequality, which show that the blowup of a set of least perimeter is as smooth as possible, and in Section \ref{DGL section}, we prove a de Giorgi-type lemma.
Then in Section \ref{proof of main thm} we combine the results of the previous two sections to prove Theorems \ref{main thm} and \ref{main crly}.

In Appendix \ref{coarea section} we deduce a coarea formula that is used throughout the paper.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Acknowledgements}
I would like to thank Georgios Daskalopoulos for suggesting this project and for many helpful discussions.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Riemannian measure theory}\label{RiemMeasureThy}
Let us now review several standard results in geometric measure theory, generalized to the case of Riemannian manifolds.

\subsection{Trace theorem}
We begin with a trace theorem and its consequences.

\begin{proposition}[trace theorem]\label{traces}
Let $U$ be an open set such that $N = \partial U$ is a Lipschitz hypersurface.
For every $u \in BV_l(M)$ there exists a trace $v \in L^1_l(N)$ such that for every $X \in C_c(M, TM)$,
\begin{equation}\label{Miranda IBP}
\int_U (du, X) ~\vol + \int_U u ~\mathcal L_XdV = \int_N vg(X, \nu) ~dA.
\end{equation}
Moreover, $v$ is determined by the germ of $u$ at $\partial U$.
If $u$ is an indicator function then so is $v$.
\end{proposition}
\begin{proof}
By applying a partition of unity, we may work in coordinates $(x_1, x')$ such that $N$ is a graph in the sense that for every $c \in \RR$, $N \cap \{x_1 = c\}$ is a single point.
One can then imitate the proof of \cite[Teorema 1]{Miranda67}, replacing any integrations by parts with its analogue
\begin{equation}
\label{Riemannian IBP}
\int_U (du, X) ~\vol + \int_U u ~\mathcal L_X\vol = \int_{\partial U} ug(X, \nu) ~\vol_{\partial U}
\end{equation}
The construction in \cite[Teorema 1]{Miranda67} shows that only the values of $u$ near $N$ affect $v$.
%
%
%Let $\varphi$ be a smooth flow on $M$ such that for every $x \in N$ and $t \in [0, 1]$, $\varphi_t(x) \in U$.
%Let $N_t$ be the set obtained by flowing $N$ along $\varphi$ for time $t$.
%Then, as long as $\varphi$ is chosen to flow slowly enough (so as to avoid self-intersections), $N_t$ is a Lipschitz hypersurface for every $t \in [0, 1]$.
%Moreover, $N_t$ partitions $U$ into a closed outer region $\{\varphi_s(x): x \in \partial U, s \in [0, t]\}$ and an open inner region $U_t$.
%
%There exist smooth functions $u_n$ on $U$ such that $u_n \to u$ locally uniformly.
%Applying (\ref{Riemannian IBP}) to $u_n$ on $U_t$ and using the locally uniform convergence, we have
%\begin{equation}
%\label{interior Miranda IBP}
%\langle 1_{U_t}du, X\rangle + \int_{U_t} u ~\mathcal L_XdV = \int_{N_t} g(uX, \nu) ~dA.
%\end{equation}
%By continuity from below, the left-hand side of (\ref{interior Miranda IBP}) converges to the left-hand side of (\ref{Miranda IBP}) as $t \to 0$.
%
%If we set $v_t(x) = u(\varphi_t(x))$, then $v_t(x)$ is defined for $x \in \partial U$ and $t \in [0, 1]$.
%Moreover, for every $0 < t_1 < t_2$,
%\begin{equation}
%\label{mean-value inequality}
%\int_N |v_{t_1} - v_{t_2}| ~dA \leq |du|_{TV}(U_{t_2} \setminus \overline{U_{t_1}}).
%\end{equation}
%Indeed, (\ref{mean-value inequality}) holds if $u$ is smooth by the mean-value theorem, and for the general case we can find $u_n$ smooth such that $u_n \to u$ in $L^2_l$.
%Expanding out both sides of (\ref{mean-value inequality}),
%\begin{equation}
%\label{approx mean-value inequality}
%\int_N |(\varphi_{t_1})^* u_n - (\varphi_{t_2})^* u_n| ~dA \leq -\inf_{X \prec U_{t_2} \setminus \overline{U_{t_1}}} \int_M u_n\mathcal L_XdV.
%\end{equation}
%Both sides of (\ref{approx mean-value inequality}) are preserved as $n \to \infty$, due to the convergence in $L^2_l$.
%Therefore (\ref{mean-value inequality}) holds.
%
%Since $|du|_{TV}(U) < \infty$, measure continuity and (\ref{mean-value inequality}) implies that
%$$\lim_{t_1, t_2 \to 0} \int_N |v_{t_1} - v_{t_2}| ~dA = 0.$$
%Thus $(v_t)$ is Cauchy in $L^1(N)$ as $t \to 0$, say $v_t \to v$.
%As $g(X, \nu) \in L^\infty$ and $(L^1)^* = L^\infty$, $g(v_tX, \nu) \to g(vX, \nu)$ in $L^1(N)$.
%Therefore the right-hand side of (\ref{interior Miranda IBP}) satisfies
%$$\lim_{t \to 0} \int_{N_t} g(uX, \nu) ~dA = \lim_{t \to 0} \int_{\partial U} g(v_tX, \nu) ~dA \int_U g(vX, \nu) ~dA$$
%which completes the proof.
\end{proof}

In the sequel we will usually just write $u$ for the trace of $u$, or $u'$ if distinguishing the two functions is crucial.

\begin{proposition}[gluing $BV$ functions along a hypersurface]\label{gluing}
Let $N$ be a Lipschitz hypersurface which separates $M$ into $U_1,U_2$.
If $u_j \in BV(U_j)$ and $u \in L^1_l(M)$ is the function such that $u|U_j = u_j$, then $u \in BV(M)$.
Moreover,
\begin{equation}
\label{glued BV norm}
\int_N |du| ~\vol = \int_N |u_1 - u_2| ~\vol_N.
\end{equation}
\end{proposition}
\begin{proof}
In the proof of \cite[Teorema 2]{Miranda67}, replace \cite[Teorema 1]{Miranda67} with Proposition \ref{traces}.
\end{proof}

\begin{notation}
If $u \in BV(M)$ and $U \Subset M$, we write
$$\eta(u, U) = \inf_{v \prec U} \int_U |d(u+v)| ~\vol$$
so that $u$ has least gradient iff $\eta(u, U) = \int_U |du| ~\vol$ for every $U$.
\end{notation}

\begin{lemma}[a priori estimates]\label{estimates on good set}
Let $u, v \in BV(M)$, let $U \Subset M$ have a Lipschitz boundary $N$. Then
\begin{equation}\label{a priori estimate 1}
|\eta(u, U) - \eta(v, U)| \leq \int_N |u - v| ~\vol_N.
\end{equation}
In particular
\begin{equation}\label{a priori estimate 2}
\eta(u, U) \leq \int_N |u| ~\vol_N.
\end{equation}
\end{lemma}
\begin{proof}
In the proof of \cite[Lemma 5.6]{Giusti77}, replace \cite[Proposition 2.8]{Giusti77} with Proposition \ref{gluing} to prove (\ref{a priori estimate 1}).
Then (\ref{a priori estimate 2}) follows by taking $v = 0$.
\end{proof}

\subsection{The Miranda stability theorem}\label{MirandaStability}
The exponential pullback $\exp_p^* u$ of a function $u$ of least gradient defined near $p \in M$ need not have least gradient.
However, in a small ball $B$ around $p$, we will be able to show that $\eta(u, B) \approx |du|_{TV}(B)$ in a sense to be made precise later.
This observation motivates the following definition.

\begin{definition}
A sequence $(u_n)$ of functions in $BV(M)$ has \dfn{approximately least gradient} if
$$\limsup_{n \to \infty} \int_U |du_n| ~\vol \leq \liminf_{n \to \infty} \eta(u_n, U)$$
uniformly as $U$ ranges over open sets $\Subset M$.
\end{definition}

To study sequences of approximately least gradient, we need a semicontinuity theorem for the Lagrangian (\ref{Lagrangian density}), which in the euclidean case was shown by Miranda \cite[Teorema 3]{Miranda67}.

\begin{definition}
Let $(u_n)$ be a sequence in $BV_l(M)$ which converges in $L^1_l$ to $u$.
We say that a Lipschitz hypersurface $N$ \dfn{has no singularities} of $(u_n)$ if:
\begin{enumerate}
\item \label{cond1Mir} $\sup_n \int_N |du_n| ~\vol = 0$.
\item \label{cond2Mir} $(u_n)$ is bounded in $L^1(N, \vol_N)$.
\item \label{cond3Mir} $\int_N |du| ~\vol = 0$.
\item \label{cond4Mir} $u_n \to u$ in $L^1(N, \vol_N)$.
\end{enumerate}
We say that $N$ \dfn{has no singularities} of $u \in BV_l(M)$ if $N$ has no singularities of the sequence $u_n = u$.
By Condition $k$ we mean the $k$th bullet in the above list.
\end{definition}

\begin{lemma}\label{probabilistic method}
Let $(u_n)$ be a sequence in $BV_l(M)$ which converges in $L^1_l(U)$. Then:
\begin{enumerate}
\item \label{probabilistic balls} For every $x \in M$ and $R > 0$ such that $B(x, R) \Subset M$ and almost every $r \in (0, R]$, $\partial B(x, r)$ has no singularities of $(u_n)$.
\item \label{probabilistic hypersurfaces} For every $U \Subset M$ there exists $U \subseteq V \Subset M$ such that $\partial V$ has no singularities of $(u_n)$.
\end{enumerate}
\end{lemma}
\begin{proof}
We first prove (\ref{probabilistic balls}).
Let $r$ be drawn from $[R/2, R]$ uniformly at random; we claim that almost surely, $\partial B(x, r)$ has no singularities of $(u_n)$.
Let
$$A = \{s > 0: \int_{\partial B(x, s)} |du| ~\vol > 0\}.$$
Then
$$\sum_{s \in A} \int_{\partial B(x, s)} |du| ~\vol \leq \int_{\partial B(x, R)} |du| ~\vol < \infty$$
since $|du|$ is a Radon measure and $B(x, R) \Subset M$.
Therefore $A$ is countable,
%Let $A_n = \{|du_n|_{TV}(N) > 0\}$ and let $A_\infty = \{|du|_{TV}(N) > 0\}$.
%Then for every $n \in \NN \cup \{\infty\}$, writing $u_\infty = u$,
%$$\sum_{s \in A_n} |du_n|_{TV}(\partial B(x, s)) \leq |du_n|_{TV}(B(x, R)) < \infty$$
%since $|du_n|_{TV}$ is a Radon measure and $B(x, R) \Subset M$.
%Since each of the summands is nonzero by definition of $A_n$, it follows that $A_n$ is countable, and in particular null.
%Therefore Conditions \ref{cond1Mir} and \ref{cond3Mir} hold almost surely.
so Condition \ref{cond3Mir} holds almost surely.
We omit the proof that the other conditions hold almost surely as it is similar.

To prove (\ref{probabilistic hypersurfaces}), let $U \Subset W \Subset M$, and for every $x \in \partial U$, let $R_x \in (0, d(x, \partial W))$.
Then, by (\ref{probabilistic balls}), for every $x \in \partial U$, there exists $r_x \in (0, R_x)$ such that $\partial B(x, r_x)$ has no singularities of $(u_n)$.
Let $\mathcal U$ be the open cover of $\overline U$ given by the balls $B(x, r_x)$, as well as $U$ itself.
Since $\overline U$ is compact, there exists a finite subcover $\mathcal U_0$ of $\mathcal U$.
Let $V$ be the union of the sets in $\mathcal U_0$.
Then $\partial V$ is the boundary of a union of finitely many balls $B(x, r_x)$ whose boundaries have have no singularities, and therefore has no singularities.
\end{proof}

We recall that $BV_l(M)$ is not separable, so it will be useful to have a somewhat weaker topology on $BV_l(M)$, as follows:

\begin{definition}
A sequence of functions $(u_n)$ in $BV_l(M)$ converges \dfn{in total variation on sets with no singularities} to $u \in BV_l(M)$ if $u_n \to u$ in $L^1_l(M)$ and for every set $A \Subset M$ such that $\partial A$ has no singularities,
\begin{equation}\label{convergence in TV}
\lim_{n \to \infty} \int_A |du_n| ~\vol = \int_A |du| ~\vol.
\end{equation}
\end{definition}

\begin{proposition}[Miranda stability theorem]\label{Miranda convergence}
If a sequence of functions $(u_n)$ has approximately least gradient and converges in $L^1_l$, then its limit $u$ has least gradient, and $u_n \to u$ in total variation on sets with no singularities.
\end{proposition}
\begin{proof}
By Lemma \ref{probabilistic method} for every $U$ open $\Subset M$ we can find $U \subseteq V \Subset M$ such that $V$ is open and $\partial V$ has no singularities.

We first prove that $u \in BV_l(M)$.
Let $v_n = (1 - 1_U)u_n$, so $v_n \in BV_l(M)$ by Proposition \ref{gluing}.
Since $(u_n)$ has approximately least gradient, if $n$ is large enough then
$$\int_{\overline V} |du_n| ~\vol \leq \eta(u_n, \overline V) + 1 \leq \int_{\overline V} |du_n| ~\vol + 1.$$
So by Proposition \ref{gluing} and Condition \ref{cond1Mir},
$$\int_U |du_n| ~\vol \leq \int_{\overline V} |du_n| ~\vol + 1 = \int_{\partial V} |u_n| ~\vol_{\partial V} + 1.$$
Thus, by (\ref{RieszMarkovDistr}) and Condition \ref{cond2Mir},
$$\int_U |du| ~\vol \leq \limsup_{n \to \infty} \int_U |du_n| ~\vol \leq \limsup_{n \to \infty} \int_{\partial V} |u_n| ~\vol_{\partial V} + 1 < \infty.$$
Therefore $u \in BV_l(M)$.

Let $v$ be a perturbation of $u$, thus $v \in BV_l(M)$ and $u = v$ on $M \setminus U$.
Such a perturbation exists, since $u \in BV_l(M)$.
Let
$$v_n(x) = \begin{cases}
v(x), &x \in V\\
u_n(x), &x \notin V
\end{cases}.$$
By Proposition \ref{gluing} and Condition \ref{cond3Mir}, $v_n \in BV_l$ and
\begin{equation}\label{gluing vn}
\int_{\overline V} |dv_n| ~\vol = \int_V |dv| ~\vol + \int_{\partial V} |u - u_n| ~\vol_{\partial V}.
\end{equation}
Let $\varepsilon > 0$. Then for $n$ large enough, since $(u_n)$ has approximately least gradient and $u_n - v_n$ is trace-free,
$$\int_V |du_n| ~\vol \leq \int_{\overline V} |du_n| ~\vol \leq \eta(u_n, \overline V) + \varepsilon \leq \int_{\overline V} |dv_n| ~\vol + \varepsilon.$$
By (\ref{gluing vn}), it follows that
$$\int_V |du_n| ~\vol \leq \int_V |dv| ~\vol + \int_{\partial V} |u - u_n| ~\vol_{\partial V} + \varepsilon.$$
By Condition \ref{cond4Mir} and (\ref{RieszMarkovDistr}),
$$\int_V |du| ~\vol \leq \int_V |dv| ~\vol + \varepsilon.$$
Since $\varepsilon > 0$ and $u = v$ on $M \setminus U$, it follows that $\int_U |du| ~\vol \leq \int_U |dv| ~\vol + \varepsilon$.
Taking $\varepsilon \to 0$, it follows that $u$ has least gradient.

Finally we prove (\ref{convergence in TV}).
Let $(u_{n_\ell})_\ell$ be a subsequence of $(u_n)$ such that $\int_A |du_{n_\ell}| ~\vol$ is Cauchy in $\ell$.
By Lemma \ref{estimates on good set} and Condition \ref{cond4Mir},
$$\lim_{n \to \infty} |\eta(u, A) - \eta(u_n, A)| \leq \lim_{n \to \infty} \int_{\partial A} |u - u_n| ~\vol_{\partial A} = 0.$$
Since $(u_n)$ has approximately least gradient, for every $\varepsilon > 0$ and $n$ large enough, $\int_A |du_n| ~\vol \leq \eta(u_n, A) + \varepsilon$.
Thus by (\ref{RieszMarkovDistr}) and the fact that $(\int_A |du_{n_\ell}| ~\vol)_\ell$ is Cauchy,
\begin{align*}
\int_A |du| ~\vol &\leq \lim_{\ell \to \infty} \int_A |du_{n_\ell}| ~\vol \leq \lim_{\ell \to \infty} \eta(u_{n_\ell}, A) + \varepsilon\\
&= \eta(u, A) + \varepsilon = \int_A |du| ~\vol + \varepsilon
\end{align*}
where the last equality follows because $u$ has least gradient.
Since $\varepsilon$ and the subsequence $(u_{n_\ell})$ were arbitrary, the inequalities collapse to give (\ref{convergence in TV}).
\end{proof}

\begin{corollary}\label{level sets are minimal}
For every $u$ of least gradient, the superlevel sets $\{u > t\}$ have least perimeter.
\end{corollary}
\begin{proof}
In the proof of \cite[Theorem 1]{BOMBIERI1969}, replace \cite[Theorem 1.6]{Miranda66} with Proposition \ref{Coarea2} and replace \cite[Theorem 3]{Miranda67} with Proposition \ref{Miranda convergence}.
\end{proof}

\begin{corollary}\label{compactness}
Let $(u_n)$ be a sequence of indicator functions of approximately least gradient.
Then there is a subsequence of $(u_n)$ which converges almost everywhere and in total variation on sets with no singularities to the indicator function of a set of least perimeter.
\end{corollary}
\begin{proof}
If $n$ is large enough, then by Proposition \ref{traces}, for every $U \Subset M$,
$$\int_U |du_n| ~\vol \leq \eta(u_n, U) + 1 \leq |\partial U| + 1$$
which gives a uniform bound in $BV_l$.
Since the forgetful map (\ref{Forget}) is compact, a subsequence of $(u_n)$ converges to a function $u$ in $L^1_l$.
By Proposition \ref{Miranda convergence}, $u$ has least gradient and (\ref{convergence in TV}) holds.
By taking a further subsequence we can guarantee the convergence pointwise almost everywhere.
The convergence almost everywhere implies that there is a Caccioppoli set $U$ such that $u = 1_U$, which necessarily has least perimeter.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Change of metric}\label{change of metric}
Let us investigate how the volume form depends on the choice of metric.
If $\vol$ is the volume form of $g$, $\vol'$ the flat volume form induced by exponential normal coordinates $x$ centered at $p$, we have
the Taylor expansion \cite[p59]{chow2006hamilton}
\begin{equation}\label{Taylor expansion of determinant}
\frac{\vol}{\vol'} = 1 - \frac{1}{3} \Ric_p(x, x) - \frac{1}{6} \nabla \Ric_p(x, x, x) + a_4x^4 + \cdots
\end{equation}
where $a_j$, $j \geq 4$, are functions of the Riemann tensor and its covariant derivatives.

Let $g_1,g_2$ be metrics defined near a point $p$ and let $\beta = (e_1, \dots, e_d)$ be an orthonormal basis for $T_pM$ with respect to $(g_1)_p$ and $(g_2)_p$.
If $\vol_i$, resp. $\Ric^{(i)}$, is the volume form, resp. Ricci tensor, associated to $g_i$, in the geodesic normal coordinate $x$ associated to $\beta$ in a small ball $B(p, \rho)$, then by (\ref{Taylor expansion of determinant}),
\begin{equation}\label{change of volume form}
\frac{\vol_2}{\vol_1} = \frac{1 - \Ric_p^{(2)}(x, x)/6 + O(x^3)}{1 - \Ric_p^{(1)}(x, x)/6 + O(x^3)} = 1 + O(\rho^2).
\end{equation}

% \begin{proof}
% Recall that if $\omega = de_1 \wedge \cdots \wedge de_d$ then by (\ref{Taylor expansion of determinant}),
% $$\frac{\vol_1}{\omega} = 1 - \frac{1}{6}\Ric_p^{(1)}(x, x) + O(x^3)$$
% while if $y = Ax$ is the geodesic normal coordinate associated to $A_* \beta$ and $\Omega = d(Ae_1) \wedge \cdots \wedge d(Ae_d)$,
% \begin{align*}\frac{\vol_2}{\omega} &= \frac{\vol_2}{\Omega} \frac{\Omega}{\omega} = \left(1 - \frac{1}{6}\Ric_p^{2}(y, y) + O(y^3)\right)\det A \qedhere.\end{align*}
% \end{proof}
% In particular, if $\omega$ is a generalized $1$-form or generalized density on $B(p, \rho)$, writing
% $$\omega_j = (\omega, \grad^{(2)} y_j) = g_2(\omega_j, dy_j)$$
% we have from (\ref{change of volume form})
% \begin{align*}
% \int_{B(p, \rho)} \omega ~dV_2 &= \sum_j \left(\int_{B(p, \rho)} \omega_j ~dV_2\right) ~dy_j\\
% &= \sum_j \left(\int_{B(p, \rho)} \omega_j \frac{dV_2}{dV_1} ~dV_1\right) ~dy_j\\
% &= (1 + O(\rho^2)) \det A \sum_j \left(\int_{B(p, \rho)} \omega_j ~dV_1\right) ~dy_j\\
% &= (1 + O(\rho^2)) \det A \int_{B(p, \rho)} \omega ~dV_1.
% \end{align*}

Let $\zeta_0$ be the injectivity radius of
$$\exp_p: T_pM \to M.$$
Let $a_j$ be the Taylor coefficients in (\ref{Taylor expansion of determinant}) and let $k \geq 2$ be the least index $j \geq 1$ such that $a_j \neq 0$.
Then let $c = 2|a_k|$.
Since on $B(p, 1)$, $c|x|^k \leq c|x|^2$ and so
$$1 - \frac{c}{2}|x|^2 - O(x^{k+1}) \leq \frac{\vol}{\vol'} \leq 1 + \frac{c}{2}|x|^2 + O(x^{k+1}).$$
We select $\zeta < \zeta_0$ so small that on $B(p, \zeta) \cap B(p, 1)$, the term $O(x^{k+1})$ is at most $c/2$, so that
\begin{equation}\label{definition of c-zeta}
0.5 < 1 - c|x|^2 \leq \frac{\vol}{\vol'} \leq 1 + c|x|^2 < 2.
\end{equation}

By (\ref{Taylor expansion of determinant}), in the generic case $k = 2$, $c = |\Ric_p|/3$, which motivates the following definition:

\begin{definition}
Let $\zeta,c$ be as in (\ref{definition of c-zeta}).
We call $\zeta$ the \dfn{strong injectivity radius} of $p$ and $c$ the \dfn{Ricci-Taylor error}.
\end{definition}

% TODO: Do I need this scaling stuff?
%
% Let us see how (\ref{definition of c-zeta}) behaves under a rescaling.
% We rescale $g$ as $\widetilde g = \lambda g$, $\lambda > 0$, which defines a volume form $\widetilde \vol$.
% We also rescale the flat metric suitably to get a volume form $\widetilde \vol'$.
% Writing $F = \vol/\vol'$ and writing $F \approx 1 \pm c|x|^2$ on $B(p, \zeta)$ to indicate the relation (\ref{definition of c-zeta}), $\widetilde F = \widetilde \vol/\widetilde \vol'$, we deduce
% $$\widetilde F = F \approx 1 \pm c|x|^2$$
% on $B(p, \zeta) = \widetilde B(p, \widetilde \zeta)$ where $\widetilde \zeta = \lambda^{0.5} \zeta$ is given by the rescaling of the Riemannian distance function.
% Therefore
% \begin{equation}\label{scale invariance}
% \text{upon applying the scaling above, }\widetilde \zeta = \lambda^{0.5} \zeta, ~\tilde c = c.
% \end{equation}
%
% Now we use (\ref{definition of c-zeta}) to control $\eta(\cdot, U)$ if $U$ is a small open set.
Write
$$\eta'(u, U) = \inf_{v \in BV_c(U)} \int_U |d(u + v)| ~\vol'$$
for the analogue of $\eta$ with respect to the flat metric induced by normal coordinates.

\begin{lemma}\label{flattening of eta}
If $U \subseteq B(p, \zeta) \cap B(p, r)$ with $r < 1$, $U \Subset M$, then for every $u \in BV_l(M)$,
\begin{equation}\label{flattening of eta equation}
(1 - cr^2) \eta'(u, U) \leq \eta(u, U) \leq (1 + cr^2) \eta'(u, U).
\end{equation}
\end{lemma}
\begin{proof}
Let $x$ be a normal coordinate centered on $p$.
Choose $(u_n)$ in $BV_l(M)$ which is a minimizing sequence for $\int_U |du_n| ~\vol'$ subject to the trace condition $u_n|\partial U = u|\partial U$.
Thus $\int_U |du_n| ~\vol' \to \eta'(u, U)$ and by (\ref{definition of c-zeta}),
$$(1 - cr^2) \int_U |du_n| ~\vol' \leq \int_U |du_n| (1 - c|x|^2) ~\vol' \leq \int_U |du_n| ~\vol = \eta(u, U).$$
Taking $n \to \infty$ we get $(1 - cr^2) \eta'(u, U) \leq \eta(u, U)$.
The other estimate in (\ref{flattening of eta equation}) is similar.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Monotonicity and density formulae}\label{inequalities}
The monotonicity formula
\begin{equation}\label{classic monotonicity formula}
\partial_r e^{Ar^2}r^{1 - d} |\partial^* U \cap B(p, r)| \geq 0
\end{equation}
for smooth minimal hypersurfaces on Riemannian manifolds incurs a loss of factor $e^{Ar^2}$ \cite[\S7]{MarquesXX}.
This loss is too severe for our purposes when $r$ is small and so must be replaced.
To this end, we now prove a monotonicity for approximately minimal hypersurfaces on euclidean space; in doing so we will incur a logarithmic loss that we will later show is harmless.
In the sequel we write $\lesssim_d$ to emphasize that the implied constant only depends on the dimension.\footnote{Presumably, one could compute the implied constants as explicit functions of the sharp Sobolev constants on $\RR^d$, but we do not need this.}

\begin{lemma}\label{approximate monotonicity}
Let $E$ be a Caccioppoli set in $\RR^d$ equipped with its euclidean metric such that for some $h \geq 0$ and $R > 0$ and every $0 < r < R$,
$$|\partial^* E \cap B_r| \leq (1 + h)\eta(f, r).$$
Then for every $0 < \rho < r < R$, with $\alpha = \log(r/\rho)$,
\begin{align*}
&\left|r^{1 - d} |\partial^* E \cap B_r| - \rho^{1 - d} |\partial^* E \cap B_\rho|\right|^2 \\
&\qquad \lesssim_d (1 + h)(1 + \alpha + h\alpha^2) \left(r^{1 - d} |\partial^* E \cap B_r| - \rho^{1 - d} |\partial^* E \cap B_\rho| + d\omega_d h \alpha\right).
\end{align*}
\end{lemma}
\begin{proof}
Let $f = 1_E$.
We recall from Proposition \ref{estimates on good set} that $\eta(f, s) \leq |\partial B_s|$, so that we can define
\begin{align*}
\psi(s) &= \int_{B_s} |df|~\vol - \eta(f, s)\\
&\leq h\eta(f, s) \leq h|\partial B_s| \leq d\omega_d hs^{d - 1}.
\end{align*}
From \cite[Proposition 5.12]{Giusti77},
$$\left|r^{1 - d} \int_{B_r} df ~\vol - \rho^{1 - d} \int_{B_\rho} df ~\vol\right|^2 \leq PQ,$$
where
\begin{align*}
P &= 2r^{1 - d}(1 + (d - 1)\alpha) \int_{B_r} |df| + 2(d - 1)^2 \int_\rho^r \log \frac{s}{\rho} \psi(s) \frac{ds}{s^d},\\
Q &= r^{1 - d} \int_{B_r} |df| - \rho^{1 - d} \int_{B_\rho} |df| + (d - 1)\int_\rho^r \psi(s) \frac{ds}{s^d}.
\end{align*}
Evidently $\log(s/\rho) \leq \alpha$ so we estimate
$$\frac{1}{\alpha} \int_\rho^r \log \frac{s}{\rho} \psi(s) \frac{ds}{s^d} \leq \int_\rho^r \psi(s) \frac{ds}{s^d} \leq d\omega_d h \int_\rho^r \frac{ds}{s} = d\omega_d h\alpha.$$
Thus
$$\int_{B_r} |df|~\vol \leq (1 + h)\eta(f, r) \leq (1 + h)|\partial B_r| \leq d\omega_d(1 + h) r^{d - 1}.$$
These estimates immediately give
\begin{align*}
P &\lesssim_d (1 + h)(1 + \alpha + h\alpha^2),\\
Q &\leq r^{1 - d} \int_{B_r} |df|~\vol - \rho^{1 - d} \int_{B_\rho} |df|~\vol + d\omega_d h\alpha. \qedhere
\end{align*}
\end{proof}

\begin{lemma}\label{approximate monotonicity 2}
Let $E$ be a Caccioppoli set in $\RR^d$ such that for some $0 \leq h < 1$ and $R > 0$ and every $0 < r < R$,
$$|\partial^* E \cap B_r| \leq (1 + h)\eta(f, r).$$
Then for every $0 < r < R$,
$$\partial_r \left(r^{1 - d} |\partial^* E \cap B_r| + d\omega_d h \log r\right) \geq 0.$$
\end{lemma}
\begin{proof}
Dividing by both sides of Lemma \ref{approximate monotonicity} by $(1 + h)(1 + \alpha + h\alpha^2) \geq 0$,
$$r^{1 - d} |\partial^* E \cap B_r| - \rho^{1 - d} |\partial^* E \cap B_\rho| + d\omega_d h \alpha \geq 0.$$
Writing out $\alpha = \log r - \log \rho$ we now see the claim.
\end{proof}

For the proofs of the next few inequalities we follow \cite{Mooney11}, but modify the arguments to account for the presence of curvature.

\begin{lemma}[isoperimetric inequality]\label{isoperimetric inequality}
Suppose that $E$ is a Caccioppoli set in $M$ and $p \in \partial^* E$.
Then for every $r > 0$ smaller than the strong injectivity radius of $p$,
$$|E \cap B(p, r)|^{d - 1} \lesssim_d |\partial^*(E \cap B(p, r))|^d.$$
\end{lemma}
\begin{proof}
Let $f = 1_{E \cap B(p, r)}$, $q = d/(d-1)$.
We apply (\ref{definition of c-zeta}) and the $BV$ Sobolev inequality \cite[\S5.6.1]{evans1991measure}:
\begin{align*}
|E \cap B(p, r)|^{1/q} &= ||f||_{L^q(\vol)} \leq 2||f||_{L^q(\vol')} \\
&\lesssim_d \int_M |df| ~\vol' \leq \int_M |df| ~\vol\\
&= |\partial^*(E \cap B(p, r))|. \qedhere
\end{align*}
\end{proof}

\begin{lemma}[density estimate]\label{uniform density estimate}
Suppose that $E$ is a Caccioppoli set in $M$, $p \in \partial^* E$, and $r_0 > 0$ is smaller than the strong injectivity radius of $p$.
If for every $r \in (0, r_0)$,
\begin{equation}\label{density estimate hypothesis}
|\partial^* E \cap B(p, r)| \leq 2\eta(1_E, B(p, r)),
\end{equation}
then for every such $r$,
\begin{align*}|E \cap B(p, r)|, ~|(M \setminus E) \cap B(p, r)|, ~|\partial^* E \cap B(p, r)| &\gtrsim_d r^{d - 1}.\end{align*}
\end{lemma}
\begin{proof}
Let $q = d/(d-1)$. By Lemmata \ref{isoperimetric inequality} and \ref{estimates on good set} and (\ref{density estimate hypothesis}),
\begin{align*}
|E \cap B(p, r)|^{1/q} &\lesssim_d |\partial^*(E \cap B(p, r))| \\
&\leq |\partial^* E \cap B(p, r)| + |E \cap \partial B(p, r)|\\
&\leq 2\eta(1_E, B(p, r)) +  |E \cap \partial B(p, r)|\\
&\leq 3 |E \cap \partial B(p, r)|.
\end{align*}
Let $F(r) = |E \cap B(p, r)|$, $G = F^{1/d}$.
Since $|E \cap \partial B(p, r)| = \partial_r F(r)$,
$$F(r)^{1/q} \lesssim_d F'(r) \leq F'(r).$$
This gives the estimate on $|E \cap B(p, r)|$.
Since $M \setminus E$ shares its perimeter with $E$, the same argument with $M \setminus E$ replacing $E$ gives the analogous bound on $|(M \setminus E) \cap B(p, r)|$.

Let $f = 1_{E \cap B(p, r)}$ and let
$$[f] = \frac{1}{|B(p, r)|} \int_{B(p, r)} f ~\vol'.$$
By (\ref{definition of c-zeta}),
$$|\partial^* (E \cap B(p, r))| \geq 0.5 |\partial^* (E \cap B(p, r))|' = 0.5 \int_{B(p, r)} |df| ~\vol'.$$
By the $BV$ Poincar\'e inequality \cite[\S5.6.1]{evans1991measure}, it follows that
\begin{align*}
|\partial^* (E \cap B(p, r))| &\gtrsim_d ||f - [f]||_{L^1(B(p, r), \vol')} \\
&= ||1 - [f]||_{L^1(B(p, r) \cap E, \vol')} + ||[f]||_{L^1(B(p, r) \setminus E, \vol')}.
\end{align*}
From (\ref{definition of c-zeta}),
$$|E \cap B(p, r)| \leq 2\omega_{d - 1} r^{d - 1} [f] \leq 4|E \cap B(p, r)|,$$
so
\begin{align*}
|\partial^* (E \cap B(p, r))| &\gtrsim_d ||1 - [f]||_{L^1(B(p, r) \cap E, \vol')} + ||[f]||_{L^1(B(p, r) \setminus E, \vol')}\\
&\geq 0.5 (1 - [f]) |B(p, r) \cap E| + 0.5 [f] |B(p, r) \setminus E|\\
&\geq 0.5 r^{1-d}|E \cap B(p, r)||E \setminus B(p, r)| \gtrsim_d r^{1 - d}. \qedhere
\end{align*}
\end{proof}

Now let us study the blowup of $M$ at a point $p$ on the reduced boundary of a set $U$ of least perimeter.
Our main result is that the tangent cone to $U$ at $p$ is analytic if $d \leq 7$.

We will be interested in objects that depend on a small parameter $t > 0$, but may depend on a choice of subsequence of $t_n \to 0$.
Thus we will suppress all subindices and implicitly pass to subsequences whenever referring to a limit $t \to 0$.\footnote{This can be made rigorous as follows. Fix a nonprincipal ultrafilter $\mathbf p$ on $2^{\aleph_0}$, and \emph{define} any limit as $t \to 0$ to be a $\mathbf p$-limit. See \cite{Tao07} for details.}

\begin{proposition}\label{blowup theorem}
Fix $p \in M$ with $\zeta \in (0, 1)$ chosen to be at most the strong injectivity radius of $p$.
Suppose that $U$ is an open set with least perimeter in $B(p, \zeta)$ and $p \in \partial^* U$.
Let $A = {\exp_p}^* U$, $A_t = \{v \in T_pM: tv \in A\}$, and $u_t = 1_{A_t}$.
Then:
\begin{enumerate}
\item The net $(u_t)$ has approximately least gradient with respect to the flat metric on $T_pM$ and in fact satisfies the estimate
\begin{equation}\label{approximately least gradient target}|
\partial^* A_t \cap V|' \leq (1 + ct^2)\eta'(A_t, V) \leq \eta'(U_t, V) + ct^2|\partial^* V|'
\end{equation}
for every Caccioppoli set $V \Subset T_pM$.
\item There exists an indicator function $u_0 \in BV_l(B'(r_0))$ of least gradient such that $u_t \to u_0$ in $L^1_l$, almost everywhere, and in total variation on sets with no singularities.
\item Let $C = \{u_0 = 1\}$. Then $0 \in \partial C$ and, if $d \leq 7$, then $\partial C$ is analytic\footnote{If
we had a suitably strong monotonicity formula, it would follow from the proof of \cite[Theorem 9.3]{Giusti77} that $\partial C$ is a minimal cone, so that by Theorem \ref{minimal cones in R8}, $\partial C$ is a hyperplane.
However, we note carefully that we have not proven that yet, as the results of Section \ref{inequalities} are not strong enough.}.
\end{enumerate}
\end{proposition}
\begin{proof}
Suppose that (\ref{approximately least gradient target}) holds.
Then $(u_t)$ clearly is a net of indicator functions of least gradient, so the existence of $u_0$ and $C$ is immediate from Corollary \ref{compactness}.
The analyticity of $\partial C$ then follows from \cite[Corollary 9.5]{Giusti77}, since $T_pM$ is flat, $d \leq 7$, and $C$ has least perimeter in $T_pM \cong \RR^d$.

Therefore we just have to prove the estimate (\ref{approximately least gradient target}), and that $0 \in \partial C$.

Let $B'_r$ denote the ball (with respect to the flat metric) of radius $r > 0$ centered at $0$ in $T_pM$; then ${\exp_p}_* B'_r = B(p, r)$ if $r < \zeta$.
Moreover, $A_t$ enjoys the scaling invariance
\begin{equation}\label{scaling of psi}
|\partial^* A_t \cap B'_r|' = t^{1 - d} |\partial^* A \cap B'_r|'.
\end{equation}
To prove (\ref{scaling of psi}), let $\mathscr H^{d - 1}$ denote $(d-1)$-dimensional Hausdorff measure with respect to the euclidean metric.
Then by \cite[Theorem 4.4]{Giusti77},
$$|\partial^* A \cap E|' = \mathscr H^{d - 1}(\partial^* A \cap E),$$
and $\mathscr H^{d - 1}$ scales as desired.

Let $V \Subset B'_\zeta$ be an arbitrary open Caccioppoli set.
We write $V_t = \{x \in \RR^d: tx \in V\}$, so that $V_{1/t} \subseteq B'_{t\zeta}$ and so by (\ref{definition of c-zeta}), $\vol/\vol' \approx 1 \pm ct^2$ on $V_t$.

\begin{claim}\label{blowup claim 1}
$(U_t)$ satisfies the estimate (\ref{approximately least gradient target}).
\end{claim}

We must show that for every $w \in BV_c(V)$\footnote{The definition of bounded variation only depends on the equivalence class of a measure with respect to mutual absolute continuity, and in particular does not depend on a choice of volume form.},
\begin{equation}\label{approximately least gradient target 2}
|\partial^* A_t \cap V|' \leq (1 + ct^2) \int_V |du_t + dw| ~\vol'.
\end{equation}
Indeed, if (\ref{approximately least gradient target 2}) holds, then we can take the infimum over all $w$ to get
$$|\partial^*AU_t \cap V|' \leq (1 + ct^2) \eta'(u_t, V)$$
and then complete the proof using Lemma \ref{estimates on good set} to bound $ct^2 \eta'(u_t, V) \leq ct^2 |\partial^* V|$.

We now prove (\ref{approximately least gradient target 2}).
Using (\ref{scaling of psi}, \ref{definition of c-zeta}),
$$t^{d - 1} | \partial^* A_t \cap V|' = |\partial^* A \cap V_{1/t}|' \leq (1 + ct^2) |\partial^* A \cap V_{1/t}|.$$
For a function $a$ we let $a_t$ denote the rescaling $a_t(x) = a(tx)$.
Since $U$ has least perimeter,
$$|\partial^* A \cap V_{1/t}| \leq \int_{V_{1/t}} |d(u + w_{1/t})| ~\vol = \int_{V_{1/t}} |d(u + w_{1/t})| \frac{\vol}{\vol'} ~\vol'.$$
Thus
$$|\partial^* A \cap V_{1/t}| \leq (1 + ct^2) \int_{V_{1/t}} |d(u + w_{1/t})| ~\vol'$$
and so
$$|\partial^* A_t \cap V|' \leq (t^{1 - d} + ct^{3 - d}) \int_{V_{1/t}} |d(u + w_{1/t})| ~\vol'.$$
Rescaling using (\ref{scaling of psi}), we obtain (\ref{approximately least gradient target 2}) and hence Claim \ref{blowup claim 1}.

\begin{claim}
$0 \in \partial C$.
\end{claim}

Owing to (\ref{approximately least gradient target}, \ref{definition of c-zeta}), if $r,t$ are small enough then
$$|\partial^* A_t \cap B'_r| \leq 1.5|\partial^* A_t \cap B'_r|' \leq 1.5(1 + ct^2) \eta'(u_t, B'_r) \leq 2 \eta(u_t, B'_r)$$
and hence by Lemma \ref{uniform density estimate},
$$|\partial C \cap B'(r)| \gtrsim r^{d - 1}.$$
Since $\partial C$ is a smooth $(d-1)$-dimensional hypersurface which is closed as a subset of $T_pM$, this is only possible if $0 \in \partial C$.
\end{proof}

One can show that just to show the existence of a (possibly singular) tangent cone, one only needs that $U$ is a Caccioppoli set.
This just requires a slight modification of our argument to show that $(u_t)$ is bounded in $BV_l$, as in the proof of \cite[Theorem 9.3]{Giusti77}.
However, we will never need this fact.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

\section{de Giorgi's lemma}\label{DGL section}
We now prove a variant of the de Giorgi lemma. Recall that $\Lambda(U, V)$ is defined to be the excess of $U$ in $V$, which is well-defined inside some coordinate chart.

\begin{theorem}[de Giorgi's lemma]\label{DGL}
Suppose that $M$ is an open submanifold of $\RR^d$ and $g$ is bounded in $C^\infty(M)$.
Then for every $\alpha \in (0, 1)$ there exist $\sigma, r > 0$ such that for every Caccioppoli set $U$ of least perimeter and every ball $V$ of radius $\rho \in (0, r)$ such that $\Lambda(U, V) < \sigma \rho^{d - 1}$,
$$\Lambda(U, \alpha V_n) < \alpha^d \Lambda(U, V_n).$$
\end{theorem}

We begin by recalling the first part of the proof of the de Giorgi lemma in the case of $(M, g) = \RR^d$ (in which case we can take $r = \infty$).
The hypothesis $\Lambda(U, V) < \sigma \rho^{d - 1}$ implies that $U$ is approximately a hyperplane.
If $U$ is the epigraph of a $C^1$ function $f$, then it follows that $|df|$ is small and $f$ solves the minimal surface equation.

Let $\mathscr L$ be defined by (\ref{Lagrangian density}). Then $f$ minimizes $\mathscr L$.
But the linearization of $\mathscr L$ about $|df| = 0$ is Dirichlet's Lagrangian
$$\mathscr I = (1 + \frac{|df|^2}{2}) ~\vol,$$
and since we are assuming $|df| \ll 1$, it follows that $||\Delta f|| \ll 1$ in some sense.
But there is an analogous statement to the de Giorgi lemma for harmonic functions \cite[Lemma 4.1]{Miranda66}, which we have some hope of applying here.
These considerations yield the following theorem \cite[Teorema 4.4]{Miranda66}:

\begin{theorem}\label{DGL C1}
Let $(L_n)$ be a sequence of Caccioppoli sets in $\RR^d$, $\rho > 0$, and $(\beta_n) \subset \RR^d$.
If $\Lambda(L_n, B(0, \rho)) \leq \beta_n$, $\partial L_n$ is a $C^1$ hypersurface in $B(0, \rho)$,
$$\lim_{n \to \infty} \inf_{\partial L_j \cap B(0, \rho)} (\normal_{L_j})_d(x) = 1,$$
and
$$|\partial L_n \cap B(0, \rho)| - \eta(L_n, B(0, \rho)) \ll \beta_n,$$
then for every $\alpha \in (0, 1)$,
$$\limsup_{n \to \infty} \Lambda(L_n, B(0, \alpha \rho)) \leq \alpha^{d + 1} \beta_n.$$
\end{theorem}

The above result essentially proves the de Giorgi lemma in case $\partial U$ is a $C^1$ hypersurface.
In fact, we will use this result to prove Theorem \ref{DGL} by a regularization argument.

\subsection{Some easy reductions}
We begin by reducing to a special case, in which, among other things, $M$ is diffeomorphic to $\RR^d$.
Let $v_1, \dots, v_d$ be the standard basis of $\RR^d$.

\begin{notation}
We write $\Lambda_g$ and similar to emphasize that we are using the volume form induced by $g$.
If we do not use a subscript, we will refer to the euclidean volume form on $\RR^d$.
\end{notation}

Following the methods of \cite[\S4-5]{Miranda66}, it will be convenient to reason by contradiction, hence we assume:

\begin{assumption} \label{DGL contradictor}
There exists a sequence of Caccioppoli sets $(U_n)$ in $M$, and a sequence of balls $V_n = B_g(x_n, \rho_n)$ such that $(U_n)$ has least perimeter with respect to $g$, $\rho_n \to 0$,
$$\lim_{n \to \infty} \beta_n := \lim_{n \to \infty} \frac{\Lambda_g(U_n, V_n)}{{\rho_n}^{d - 1}} = 0,$$
and for every $n \in \NN$,
\begin{equation}\label{contradiction DGL}
\Lambda_g(U_n, \alpha V_n) \geq \alpha^d \Lambda_g(U_n, V_n).
\end{equation}
\end{assumption}

\begin{lemma}
There exists $c > 0$ and a sequence $(E_n)$ of Caccioppoli sets in $\RR^d$ which has approximately least perimeter in $B(0, 1)$ in the particularly strong sense that there exists $(\rho_n) \in \ell^1$ which witnesses that for every $A \subseteq B(0, 1)$,
\begin{equation}\label{DGL ALP}
|\partial^* E_n \cap A| \leq (1 + c{\rho_n}^2)^2 \eta(E_n, A)
\end{equation}
and which satisfies
\begin{equation}\label{DGL bound by 2}
(1 + c{\rho_n}^2)^2 \leq 2.
\end{equation}
In addition,
\begin{equation}\label{DGL conormal axis}
\int_{B(0, 1)} d1_{E_n} ~\vol \text{ is a scalar multiple of } v_d
\end{equation}
and
\begin{equation}\label{scaled contradiction DGL}
\Lambda(E_n, B(0, \alpha)) \geq \alpha^d(1 + c{\rho_n}^2) \Lambda(E_n, B(0, 1))
\end{equation}
Finally, the sequences of excesses
\begin{equation}\label{scaled summable DGL}
\gamma_n = \Lambda(E_n, B(0, 1))
\end{equation}
is summable.
\end{lemma}
\begin{proof}
Let $(U_n),(\beta_n),(\rho_n)$ be as in Assumption \ref{DGL contradictor}.
After taking a subsequence we may in addition assume that $(\beta_n),(\rho_n) \in \ell^1$.
Since $g$ is bounded, there exists a \emph{uniform} strong injectivity radius $\zeta > 0$ on $M$.
After rescaling $g$, we can assume that $\zeta > 1$, and after discarding finitely many $n$ we may assume that for every $n$, $\rho_n < 1$.
Similarly, there is a uniform Ricci-Taylor error $c > 0$ on $M$, and we will always assume (\ref{DGL bound by 2})
which can be guaranteed by discarding finitely many $n$.

In particular $B_{T_{x_n}M}(0, \rho_n)$ is the exponential pullback $\exp_{x_n}^*(V_n)$.
For every $n$, we can find an isometric isomorphism
$$\varphi_n: T_{x_n}M \to \RR^d$$
such that $\int_{B_{T_{x_n}M}(0, \rho_n)} d1_{\exp_{x_n}^* U_n} ~\vol$ lies in the span of $\varphi_n^{-1}(v_d)$.
Since balls in $\RR^d$ with its flat metric, centered on $0$, are thus identified with balls in $(M, g)$, we now drop the subscript denoting the metric.

We now let
$$F_n = (\varphi_n)_* \circ \exp_{x_n}^* U_n \subseteq \RR^d,$$
so that $\int_{B'(0, \rho_n)} d1_{F_n} ~\vol$ lies in the span of $v_d$ and $F_n$ has least perimeter in $B(0, \rho_n)$ with respect to $(\varphi_n)_* \circ \exp_{x_n}^* g$.
If
$$E_n = \{x \in \RR^d: \rho_n x \in F_n\},$$ then (\ref{DGL conormal axis}) holds
and $E_n$ has least perimeter in $B(0, 1)$ with respect to
$$g = \rho_n^{-0.5} (\varphi_n)_* \circ \exp_{x_n}^* g.$$

We now estimate
\begin{align*}
|\partial^* E_n \cap A| &= {\rho_n}^{-1} |\partial^* F_n \cap \rho_n A|\\
&\leq \frac{1 + c{\rho_n}^2}{\rho_n} |\partial^* F_n \cap \rho_n A|_{g_n}\\
&\leq \frac{(1 + c{\rho_n}^2)^2}{\rho_n} \eta(F_n, \rho_n A)\\
&= (1 + c{\rho_n}^2) \eta(F_n, A).
\end{align*}
Therefore $E_n$ has approximately least perimeter in $\RR^d$, in the sense of (\ref{DGL ALP}).
A similar computation applied to (\ref{contradiction DGL}) shows that (\ref{scaled contradiction DGL}).
We similarly bound $||(\gamma_n)||_{\ell^1} \leq 2 ||(\beta_n)||_{\ell^1}$.
\end{proof}

Throughout the rest of the proof, we just work on $\RR^d$ and discard $(M, g)$.
We will allow ourselves to pass to a subsequence in $n$, and leave reiindexing implict.

\subsection{Regularizing the boundary}
The sequence $(E_n)$ that we have just constructed would contradict Theorem \ref{DGL C1} if $\partial E_n$ was smooth.
However, this is not true, so we now regularize $(E_n)$ using a modification of the arguments of \cite[Chapter 7]{Giusti77}.
Thus we introduce the convolution kernel
$$\chi_\varepsilon(x) = C \varepsilon^{-d}\left(1 - \frac{|x|}{\varepsilon}\right) \vee 0.$$
Here $C > 0$ is the constant that enforces $||\chi_\varepsilon||_{L^1} = 1$.
The advantange of this kernel is that for every $\delta > 0$ small enough and every ball $V = B(\xi, \delta\varepsilon)$, $y \in V$ satisfies
\begin{equation}\label{kernel on balls}
\frac{C}{\varepsilon^d}\left(1 - \delta - \frac{|x - \xi|}{\varepsilon}\right) \leq \chi_\varepsilon(x - y) \leq \frac{C}{\varepsilon^d}\left(1 + \delta - \frac{|x - \xi|}{\varepsilon}\right).
\end{equation}

\begin{notation}
If $f$ is a Radon measure, we write $f^{(\varepsilon)} = f * \chi_\varepsilon$.
\end{notation}

We define $\varphi_{n, \ell} = (1_{E_n} ~\vol)^{({\gamma_n}^\ell)}$.
Then, by \cite[Lemma 7.1]{Giusti77}, $\varphi_{n, \ell}$ is a $C^1$ function.
Since $\chi_\varepsilon$ clearly converges to the Dirac measure $\delta_0$ in the weak topology of measures as $\varepsilon \to 0$, $\lim_\ell \varphi_{n, \ell} = 1_{E_n} ~\vol$ in the weak topology of measures.

\begin{lemma}
There exist $\lambda_{n,\ell} > 0$ and open sets $I_n \subseteq B(0, 1)$ such that for every $\ell$, $\lim_n \lambda_{n,\ell} = 0$ and $I_{n, \ell}$ grows to $B(0, 1)$ as $n \to \infty$, such that for every $x \in I_n$,
$$\partial_d \varphi_{n,\ell} > (1 - \lambda_{n, \ell}) |d\varphi_{n,\ell}|.$$
\end{lemma}
\begin{proof}
We set $\varepsilon = {\gamma_n}^\ell$; after removing finitely many $n$, we may assume $\gamma_n \in (0, 1)$ and hence if $\sigma = {\gamma_n}^{0.5/(d - 1)}$, $\varepsilon < \sigma$.
Let $f = |d1_{E_n}| - \partial_d 1_{E_n}$ and select $x \in I$ where
$$I = I_{n, \ell} = B(0, 1 - 2\sigma) \cap \varphi_{n, \ell}^*(d^2 \gamma_n^2, 1 - d^2 \gamma_n^2).$$
Taking $n \to \infty$ and using $(\gamma_n) \in \ell^1$ we see that $I_{n, \ell}$ grows to $B(0, 1)$.

It is our purpose to estimate $f^{(\varepsilon)}(x)$, and to this end we write $f = f_1 + f_2$ where $f_1 = f1_{B(0, \varepsilon(1 - 2\delta))}$, where $\delta \in (0, 0.5)$ is a quantity which is allowed to depend on $n$.

We begin by constructing an open cover of the domain $B(0, \varepsilon)$ of $\chi_\varepsilon$.
More precisely, we use a greedy algorithm to find a maximal finite set $\mathcal V$ of disjoint balls of radius $\delta \varepsilon$ centered on $\partial^* E \cap B_{\varepsilon(1 - 2\delta)}$, and let $U = B(0, \varepsilon) \setminus \overline{B(0, \varepsilon(1 - 2\delta))}$.
Then $\mathcal U = \{2V: V \in \mathcal V\} \cup \{U\}$ is an open cover of $B(0, 1)$.
We will bound the integral defining $f^{(\varepsilon)}$ in each of the open sets in $\mathcal U$ separately.

\begin{claim}[control close to the boundary]\label{molly close}
If $n$ is large enough, then
$${f_2}^{(\varepsilon)}(x) \lesssim_d \delta {\gamma_n}^{1 - d} |d1_E|^{(\varepsilon)}(x).$$
\end{claim}
\begin{proof}[Proof of claim]
Since $x \in I$, for every $y \in U$.
$$\chi_\varepsilon(x - y) \lesssim_d \frac{\delta}{\varepsilon^d}.$$
This gives
$${f_2}^{(\varepsilon)}(x) \leq 2\int_U \chi_\varepsilon(x - y) |d1_E|(y) ~\vol(y) \lesssim_d \frac{\delta}{\varepsilon^d} |\partial^* E \cap B(0, \varepsilon)|.$$
Since $(E_n)$ has approximately least perimeter, if $n$ is large enough then
$$|\partial^* E_n \cap B(0, \varepsilon)| \leq 2|\partial B(0, \varepsilon)| \lesssim_d \varepsilon^{d - 1}$$
and so we conclude
$${f_2}^{(\varepsilon)}(x) \leq 2\int_U \chi_\varepsilon(x - y) ~\vol(y) \lesssim_d \frac{\delta}{\varepsilon}.$$
This estimate is comparable to \cite[(7.8)]{Giusti77}, and now (after throwing away a constant factor) we can copy the argument following that estimate verbatim.
\end{proof}

Since $\mathcal U \setminus \{U\}$ is an open cover of $B(0, \varepsilon) \setminus U$,
$${f_1}^{(\varepsilon)}(x) \leq \sum_{V \in \mathcal V} (f1_{2V})^{(\varepsilon)}(x).$$
So now we bound each of the summands $(f1_{2V})^{(\varepsilon)}$.

\begin{claim}[control in dilated balls]\label{dilated balls claim}
Suppose that $\delta \geq {\gamma_n}^d$.
Then there exist $K_n > 0$, $K_n \to 0$, such that for every $V \in \mathcal V$,
$$(f1_{2V})^{(\varepsilon)}(x) \leq K_n \frac{\delta^{d - 1}}{\varepsilon}\left(1 + 2\delta + \frac{|x - \xi|}{\varepsilon}\right).$$
\end{claim}
\begin{proof}[Proof of claim]
By (\ref{kernel on balls}), if $\xi$ is the center of $V$ then
\begin{equation}\label{dilated balls 0}
(f1_{2V})^{(\varepsilon)}(x) \lesssim_d \varepsilon^{-d} \left(1 + 2\delta + \frac{|x - \xi|}{\varepsilon}\right) \int_{2V} f ~\vol.
\end{equation}
By (\ref{DGL ALP}), for every $h > 0$, if $n$ is large enough then $|\partial^* E \cap V| \leq (1 + h)\eta(E, V)$, so we can add and subtract $\partial_d 1_{E_n}$ from the integrand and apply Lemma \ref{approximate monotonicity 2} with $2\delta \varepsilon < \sigma$ to see that $\int_{2V} f ~\vol$ is
\begin{equation}\label{dilated balls 1}
\lesssim_d (\delta \varepsilon)^{d - 1} \left(\sigma^{1 - d} \int_{B(\xi, \sigma)} (f + \partial_d 1_{E_n}) ~\vol - (\delta\varepsilon)^{1 - d} \int_V \partial_d 1_{E_n} ~\vol + h\log\frac{\sigma}{2 \delta\varepsilon}\right).
\end{equation}
By (\ref{DGL conormal axis}) and the fact that $\sigma^{1 - d} = {\gamma_n}^{-0.5}$,
\begin{equation}\label{DGL conormal axis consequence}
\sigma^{1 - d}\int_{B(\xi, \sigma)} f ~\vol \leq {\gamma_n}^{-0.5} \int_{B(0, 1)} f ~\vol = {\gamma_n}^{-0.5} \Lambda(E_n, B(0, 1)) = \sqrt{\gamma_n}.
\end{equation}
Meanwhile, by Lemma \ref{approximate monotonicity},
\begin{align*}
&\sigma^{1 - d} \int_{B(\xi, \sigma)} \partial_d1_{E_n} ~\vol - (2\delta\varepsilon)^{1 - d} \int_{2V} \partial_d1_{E_n} ~\vol\\
& \qquad \leq \left|\sigma^{1 - d} \int_{B(\xi, \sigma)} d1_{E_n} ~\vol - (2\delta\varepsilon)^{1 - d} \int_{2V} d1_{E_n} ~\vol\right|\\
& \qquad \lesssim_d \sqrt{\sigma^{1 - d} |\partial^* E_n \cap B(\xi, \sigma)| - (2\delta\varepsilon)^{1 - d} |\partial^* E_n \cap 2V| + h \log \frac{\sigma}{2\delta\varepsilon}}.
\end{align*}
If $h$ is small enough this estimate and (\ref{DGL conormal axis consequence}) allow us to simplify (\ref{dilated balls 1}) to see that $\int_{2V} f ~\vol$ is
\begin{equation}\label{dilated balls 2}
\lesssim_d (\delta \varepsilon)^{d - 1} \left(\sqrt{\gamma_n} + \sqrt{h \log \frac{\sigma}{2\delta\varepsilon}} + \sqrt{\sigma^{1 - d} |\partial^* E_n \cap B(\xi, \sigma)| - (2\delta\varepsilon)^{1 - d} |\partial^* E_n \cap 2V|}\right).
\end{equation}
We simplify the third square root as
\begin{align*}
&\sigma^{1 - d} \int_{B(\xi, \sigma)} |d1_{E_n}| ~\vol - (2\delta\varepsilon)^{1 - d} \int_{2V} |d1_{E_n}| ~\vol\\
&\qquad = \left(\sigma^{1 - d} \int_{B(\xi, \sigma)} f ~\vol\right) + \left(\sigma^{1 - d} \int_{B(\xi, \sigma)} \partial_d 1_{E_n} ~\vol\right) - \left((2\delta\varepsilon)^{1 - d} \int_{2V} |d1_{E_n}| ~\vol\right)\\
&\qquad=: P + Q - R.
\end{align*}
By (\ref{DGL conormal axis consequence}), $P \leq \sqrt{\gamma_n}$.
If $\normal$ denotes the unit normal to $\partial B(\xi, \sigma)$ then
$$Q = \sigma^{1 - d} \int_{\partial B(x, \sigma) \cap E_n} \normal_d ~\vol \leq \sigma^{1 - d} \int_{\partial B(x, \sigma)} ~\vol = \omega_{d - 1}.$$
On the other hand, $\xi \in \partial^* E_n$, so if we write $N$ for the disk bounded by the equator in $2V$, then
$$|2V \cap \partial^* E_n| \geq |2V \cap N| = \omega_{d - 1}(2\delta\varepsilon)^{d - 1}$$
or in other words $R \geq \omega_{d - 1}$.
Summing up, $P + Q - R \leq \sqrt{\gamma_n}$ and hence we can simplify (\ref{dilated balls 2}) to
$$\int_{2V} f ~\vol \lesssim_d (\delta \varepsilon)^{d - 1} \left(\sqrt{\gamma_n} + \sqrt{h \log \frac{\sigma}{2\delta\varepsilon}}\right).$$
Moreover, $\sigma \lesssim 2\delta\varepsilon$ since $\delta \geq \gamma^d$, so $\log(\sigma/2\delta\varepsilon) \lesssim 1$.
As $n \to \infty$, $h \to 0$, so combining this estimate with (\ref{dilated balls 0}) completes the proof.
\end{proof}

We now sum up (\ref{dilated balls claim}) over $\mathcal V$ to obtain a bound on all of $B(0, \varepsilon) \setminus U$.

\begin{claim}[control far from the boundary]\label{molly far}
One has
$${f_1}^{(\varepsilon)}(x) \lesssim_d |d1_{E_n}(x)|^{(\varepsilon)}.$$
\end{claim}
\begin{proof}[Proof of claim]
The support property of $\chi_\varepsilon$ and the disjointness of $\mathcal V$ imply
$$|d1_{E_n}(x)|^{(\varepsilon)} \geq \sum_{V \in \mathcal V} \int_V \chi_\varepsilon(x - y) |d1_{E_n}(y)| ~\vol(y)$$
so by (\ref{kernel on balls}), Lemma \ref{uniform density estimate}, and Claim \ref{dilated balls claim},
\begin{align*}
|d1_{E_n}(x)|^{(\varepsilon)} &\gtrsim_d \sum_{V \in \mathcal V} \varepsilon^{-d} \left(1 - \delta - \frac{|x - \cent V|}{\varepsilon}\right) |\partial^* E_n \cap V|\\
& \gtrsim_d \sum_{V \in \mathcal V} \frac{\delta^{d - 1}}{\varepsilon} \geq \frac{{f_1}^{(\varepsilon)}(x)}{K_n}. \qedhere
\end{align*}
\end{proof}

If $n$ is large enough then we may take $\delta = {\gamma_n}^d$. Thus, by Claims \ref{molly close} and \ref{molly far},
$$f^{(\varepsilon)}(x) \lesssim_d ({\gamma_n}^d + K_n)|d1_{E_n}|^{(\varepsilon)}(x).$$
Expanding out the definition of $f$ and letting $\lambda_{n,\ell}$ be a constant multiple of ${\gamma_n}^d + K_n$ (where the constant depends on $\ell$) will complete the proof.
\end{proof}

Now we observe that if $x \in I_{n, \ell}$,
$$\partial_d \varphi_{n,\ell}(x) \geq (1 - \lambda_{n, \ell}) |d1_{E_n}|^{(\varepsilon)}(x) > 0.$$
Since $\varphi_{n, \ell}$ is $C^1$ it follows that the level sets of $\varphi_{n, \ell}$ are $C^1$ hypersurfaces in $\RR^d$.
We can now mimic the proof of \cite[(7.22--7.23)]{Giusti77} with \cite[(5.14)]{Giusti77} replaced by the estimate
\begin{equation}\label{Giusti514}
|\partial^* E_n \cap B(0, r)| \leq 2|\partial B(0, r)| \lesssim r^{d - 1}
\end{equation}
(valid for $n$ large, by (\ref{DGL ALP})) to conclude that there exist Caccioppoli sets $L_n$ with $C^1$ boundary such that $d1_{L_n} - d1_{E_n} \to 0$ in the weak topology of measures and for almost every $r \in (0, 1)$,
\begin{equation}\label{Giusti722}
|\partial L_n \cap B(0, r)| - |\partial E_n \cap B(0, r)| \ll \gamma_n,
\end{equation}
\begin{equation}\label{Giusti723}
||1_{L_n} - 1_{E_n}||_{L^1(\partial B(0, r))} \ll \gamma_n,
\end{equation}
\begin{equation}\label{Giusti717}
\lim_{n \to \infty} \inf_{\partial L_n \cap B(0, r)} (\normal_{E_n})_d = 1.
\end{equation}

\subsection{Deriving a contradiction}
The complementary bound to (\ref{Giusti722}), while true in the setting of \cite[Chapter 7]{Giusti77}, is false here because $E_n$ may fail to have least perimeter.
Instead, we prove a slightly weaker but still sufficient bound:

\begin{lemma}
For almost every $r \in (0, 1)$,
$$|\partial^* E_n \cap B(0, r)| - |\partial L_n \cap B(0, r)| \ll \rho_n + \gamma_n.$$
\end{lemma}
\begin{proof}
We first show that $|\partial L_n \cap B(0, 1)|$ is uniformly bounded in $n$.
Since $d1_{L_n} - d1_{E_n} \to 0$ in the weak topology of measures,
$$|\partial L_n \cap B(0, 1)| \lesssim |\partial^* E_n \cap B(0, 1)|$$
if $n$ is large enough.
By (\ref{Giusti514}), then,
\begin{equation}\label{bounds on Ln}
|\partial L_n \cap B(0, 1)| \lesssim 1
\end{equation}
as desired.

By (\ref{DGL ALP}), Lemma \ref{estimates on good set}, and (\ref{Giusti723}),
\begin{align*}
|\partial^* E_n \cap B(0, r)| &\leq (1 + c{\rho_n}^2)^2 \eta(E_n, B(0, r)) \\
&\leq (1 + c{\rho_n}^2)^2(\eta(L_n, B(0, r)) + ||1_{E_n} - 1_{L_n}||_{L^1(\partial B(0, r))})\\
&\leq (1 + c{\rho_n}^2)^2 \eta(L_n, B(0, r)) + o(\gamma_n)\\
&\leq |\partial L_n \cap B(0, r)| + O({\rho_n}^2) |\partial L_n \cap B(0, r)| + o(\gamma_n).
\end{align*}
By (\ref{bounds on Ln}), ${\rho_n}^2 |\partial L_n \cap B(0, r)| = o(\rho_n)$ so this suffices.
\end{proof}

Combining the previous lemma with (\ref{Giusti722}), we obtain
\begin{equation}\label{Giusti714}
\left||\partial L_n \cap B(0, r)| - |\partial^* E_n \cap B(0, r)|\right| \ll \rho_n + \gamma_n
\end{equation}
and combining (\ref{Giusti714}) with the coarea formula gives
\begin{equation}\label{Giusti713}
\left|\int_{B(0, r)} d1_{L_n} ~\vol - \int_{B(0, r)} d1_{E_n} ~\vol\right| \ll \rho_n + \gamma_n.
\end{equation}
Combining (\ref{Giusti714}) with (\ref{DGL ALP}) implies that $(L_n)$ has approximately least perimeter in the strong sense that
\begin{equation}\label{Giusti712}
|\partial L_n \cap B(0, r)| - \eta(L_n, B(0, r)) \ll \rho_n + \gamma_n.
\end{equation}
By (\ref{scaled summable DGL}, \ref{Giusti717}, \ref{Giusti712}),
\begin{equation}\label{bound the excess}
|\Lambda(L_n, B(0, r)) - \gamma_n| \ll \rho_n + \gamma_n.
\end{equation}

For almost every $r \in (0, 1)$ and every $s \in (0, r)$ we can make the following argument: by (\ref{bound the excess}) and Theorem \ref{DGL C1} with $\beta_n = \rho_n + \gamma_n$,
$$\limsup_{n \to \infty} \frac{\Lambda(L_n, B(0, \alpha s))}{\rho_n + \gamma_n} \leq \frac{\alpha^{d + 1}}{s^{d + 1}}.$$
By (\ref{Giusti714}, \ref{Giusti713}), then,
$$\limsup_{n \to \infty} \frac{\Lambda(E_n, B(0, \alpha s))}{\rho_n + \gamma_n} \leq \frac{\alpha^{d + 1}}{s^{d + 1}}.$$
Taking $r, s \to 1$ and applying (\ref{scaled summable DGL}),
$$\limsup_{n \to \infty} \frac{\Lambda(E_n, B(0, \alpha))}{\rho_n + \Lambda(E_n, B(0, 1))} \leq \alpha^{d + 1},$$
so for every $h > 0$ we can find $n$ so large that
$$\Lambda(E_n, B(0, \alpha)) \leq \alpha^{d + 1}(1 + h)(\rho_n + \Lambda(E_n, B(0, 1))).$$
But, if $h$ is small enough depending on $\alpha$, this contradicts (\ref{scaled contradiction DGL}) and the fact that $\rho_n \to 0$.
Therefore Assumption \ref{DGL contradictor} is untenable, and so Proposition \ref{DGL} holds.

\section{Proof of main theorems}\label{proof of main thm}
\subsection{The general case}
We are finally ready to prove Theorem \ref{main thm}; all that remains is to carry out an argument analogous to \cite[Teorema 4]{Miranda67}.

Since regularity is local, we can replace $M$ with a precompact chart.
This justifies the following assumption:

\begin{assumption}
$M$ is an open submanifold of $\RR^d$ and $g$ is bounded in $C^\infty(M)$.
\end{assumption}

We use primes to denote quantities defined with respect to the euclidean metric rather than $g$.

Let $u$ be a function of least gradient on $M$.

\begin{lemma}
Every superlevel set of $u$ has a boundary which is a hypersurface that is as smooth as possible.
\end{lemma}
\begin{proof}
By Corollary \ref{level sets are minimal}, $U = \{u > y\}$ has least perimeter, so by Proposition \ref{blowup theorem} and the fact that $d \leq 7$, for every $p \in M$ there exists a Caccioppoli set $C'$ of least perimeter and analytic boundary in $T_pM$ (with respect to the flat metric on $T_pM$) such that $1_{U_t} \to 1_{C'}$ in $L^1_l$ and in total variation on sets with no singularities.
Repeating this argument along with \cite[Theorem 9.3]{Giusti77} furnishes a half-space $C$ in $T_0T_pM$ for which $1_{C'_t} \to 1_C$ in the same topology, and identify $T_0T_pM$ with $T_pM$ implies that in addition $1_{U_t} \to 1_C$.
Since $C$ is a half-space, for every open ball $V \Subset T_pM$,
\begin{equation}\label{excess of a plane}
\Lambda'(C, V) = 0.
\end{equation}
The convergence in total variation and (\ref{excess of a plane}) imply that on sets $A$ with no singularities,
$$\left|\lim_{t \to 0} \int_A d1_{U_t} ~\vol'\right| = \left|\int_A d1_C ~\vol'\right| = |\partial C \cap A|.$$
Suppose that $x_t \in \partial U_t$, $x_t \to 0$, and let $\sigma,r$ be as in Proposition \ref{DGL} with $\alpha = 0.5$.
Then for almost every $\rho > 0$,
$$\lim_{t \to 0} \Lambda'(U_t, B'(x_t, \rho)) = \Lambda'(C, B'(x_t, \rho)) = 0,$$
so in particular there exists $\delta > 0$ such that if $t \in (0, \delta)$ then
$$\Lambda'(U_t, B'(x_t, \rho)) < 0.5 \sigma \rho^{d - 1}.$$
We can take $\rho$ so small that
$$\Lambda(U_t, B(x_t, \rho)) \leq 2\Lambda'(U_t, B'(x_t, \rho)) < \sigma \rho^{d - 1}$$
and moreover $\rho < r$.
Then, we can argue identically to the proofs of \cite[Teorema 5.7, Corollario 6.3]{Miranda66} to deduce that the conormal $1$-form $\normal_{U_t}(x_t)$ exists if $t$ is small, has norm $1$, and satisfies, for every $s \in (0, \rho)$,
$$\left|\normal_{U_t}(x_t) - \frac{\int_{B'(x_t, s)} d1_{U_t} ~\vol'}{\int_{B'(x_t, s)} |d1_{U_t}| ~\vol'}\right| \lesssim_d \sqrt{\frac{s}{\rho - |x_t|}} \lesssim_g \sqrt s.$$
Combining this with the convergence in total variation and taking $\rho \to 0$ gives
\begin{equation}
\label{convergence}
\lim_{t \to 0} \normal_{U_t}(x_t) = \normal_C(0).
\end{equation}
Rescaling (\ref{convergence}) we see that if $x_j \to 0$, $x_j \in \partial U_1$, then
$$\lim_{j \to \infty} \normal_{U_1}(x_j) = \normal_C(0) = \normal_{U_1}(0)$$
so $\normal_{U_1}$ is continuous at $0$. Moreover, $0 \in \partial^* U_1$.
These facts are preserved by exponential pushforward, thus $p \in \partial^* U$ and $\normal_U$ is continuous at $p$.
So by Proposition \ref{regularity of reduced boundary}, $\partial^* U$ is as smooth as possible.
\end{proof}

Let
\begin{equation}\label{lamination union}
A = \bigcup_y \partial \{u > y\},
\end{equation} $B$ the interior of $\{du = 0\}$, and $x \in M$.
Then $x \in B$ iff $u = u(x)$ near $x$, but that happens iff for every $y < u(x)$, $x$ is interior to $\{u > y\}$ and for every $y \geq u(x)$, $x$ is exterior to $\{u > y\}$.
This happens iff for every $y \in \RR$, $x$ is either interior or exterior to $\{u > y\}$, thus $x \notin \partial \{u > y\}$, which happens iff $x \notin A$.
Thus $\{A, B\}$ is a partition of $M$, so $A$ is closed.
Moreover, the sets $\{u > y\}$ are totally ordered by $\subseteq$, so the sets $\partial \{u > y\}$ are disjoint.
This proves Theorem \ref{main thm}.

\subsection{Convex surfaces with boundary}
The proof of Theorem \ref{main crly} from Theorem \ref{main thm} is essentially identical to \cite[Proposition 3.4]{górny2017planar}; we give the details here for completeness.
Suppose that $M = \Sigma \subset \overline \Sigma$ and $u \in BV_l(\Sigma)$.
The only thing that can go wrong, given Theorem \ref{main thm}, is:

\begin{assumption}
There are two geodesics in $A = \partial \{u > y\}$, $\gamma_1$ and $\gamma_2$, which intersect on $\partial \Sigma$.
\end{assumption}

Suppose that $\gamma_1$ and $\gamma_2$ intersect at $x$, and $\gamma_i$ passes through $y_i$ on the way to $x$, so that $x,y_1,y_2$ bound an open, nondegenerate geodesic triangle $\Delta \subset \overline \Sigma$. This makes sense, because $\overline \Sigma$ is convex.
Since we have access to the monotonicity formula (\ref{classic monotonicity formula}), the proof of \cite[Remark 37.9]{simon1983GMT} shows that there exist only finitely many connected components of $A$ in $\Delta$.
So, after replacing $\gamma_2$ with a geodesic closer to $\gamma_1$ as necessary, we may assume that either $A$ does not intersect $\Delta$, or $A$ contains $\Delta$.
By replacing $A$ with its complement if necessary, we may assume that $A$ does not meet $\Delta$.

By Corollary \ref{level sets are minimal}, $v = 1_{\{u > y\}}$ is a function of least gradient, and $v = 0$ on $\Delta$ but $v = 1$ on the opposite sides of $\gamma_i$.
So if we replace $v$ with $w = v - 1_\Delta$, $w$ has the same trace as $v$, but since $\Delta$ is a nondegenerate triangle,
$$\int_U |dw| ~\vol = |\partial(\{u > y\} \setminus \Delta) \cap U| < |\partial \{u > y\} \cap U| = \int_U |dv| ~\vol$$
whenever $U$ is a precompact neighborhood of $\overline \Delta$ in $\overline \Sigma$.
Therefore $v$ does not have least gradient, which is a contradiction that proves Theorem \ref{main crly}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix
\section{Measure theory}
\subsection{Notation and conventions}
\begin{notation}
If $F$ is a presheaf of function spaces, we write $u \in F_l(U)$ to mean that for every $V \Subset U$, $u \in F(V)$.
We write $u \in F_c(U)$ to mean that $u \in F(U)$ and $\supp u \Subset U$.
\end{notation}

\begin{notation}[volume forms]
We reserve the letter $d$ for dimension or exterior differentiation, and so to avoid awkwardness such as $\int |du| dV$ we write $\vol$ for the Riemannian volume form.
If $N$ is a closed submanifold we write $\vol_N$ to indicate the pullback of $\vol$ along the inclusion map $M \to N$.
\end{notation}

\begin{notation}[vector bundles]
Let $E$ be a vector bundle, which we will always assume is normed, with dual $E'$.
If $u,v$ are sections of $E',E$ respectively, we write $(u, v)$ for their fiberwise pairing, which is a function $M \to \RR$.
We write $\langle u, v\rangle$ or $\int_M (u, v) ~\vol$, for their $L^2$-duality pairing, which is a real number.
If $u$ is a section of $E$, we write $u \prec U$ to mean that $||u||_{L^\infty} \lesssim 1$ and $\supp u \Subset U$.
\end{notation}

\begin{definition}
Let $u$ be a smooth section.
If, if $g$ is analytic then $u$ is analytic, then $u$ is \dfn{as smooth as possible}.
\end{definition}

\subsection{The Bochner integral}
Let $F$ be a separable Fr\'echet space over $\CC$, and $(\Omega, P)$ a measure space.
We can then define the \dfn{Bochner integral} of a $P$-measurable function $f: \Omega \to F$, which we write as $\int_\Omega f ~dP$. It is an element of $F$.

\begin{theorem}[Pettis]
Let $f: \Omega \to F$ be any function.
Then $f$ is measurable iff for every $X \in F'$, $\omega \mapsto \langle f(\omega), X\rangle$ is measurable.
In this case,
$$\left\langle \int_\Omega f ~dP, X\right\rangle = \int_\Omega \langle f(\omega), X\rangle ~dP(\omega).$$
\end{theorem}

In case $F = \CC$, the Bochner integral reduces to the usual Lebesgue integral.
If $F$ is finite-dimensional and we have fixed a basis for $F$, it is easy to see that the Bochner integral is the componentwise Lebesgue integral.

For the theory of the Bochner integral we refer the reader to \cite{Rieffel70} and \cite[Chapter V]{yosida2012functional}.
One can just treat the Banach-valued case as the Fr\'echet-valued case goes through roughly unchanged; see \cite{MO47721}.

\subsection{Bundle-valued Radon measures}
Let $F \to M$ be a normed vector bundle of rank $r$.
We equip the space $C(K, F)$ of continuous sections of $F$ on a compact set $K$ with its supremum norm.
The Banach spaces $C(K, F)$ form an inverse system with respect to restriction and therefore define the topological vector space
$$C_0(M, F) = \varprojlim C(K, F).$$

If $F$ is the trivial bundle $F = M \times \CC^r$, then according to the Riesz-Markov theorem, the space of $\CC^r$-valued Radon measures on $M$ is canonically identified with $C_0(M, F')'$.
This special case motivates our next definition.

\begin{definition}
The topological dual space $\mathcal R(M, F) = C_0(M, F')'$ is the space of \dfn{$F$-valued Radon measures} on $M$.
\end{definition}

If we write $\mathcal R(U, F)$ to mean $\mathcal R(U, F|U)$, we equip $\mathcal R(U, F)$ with the weak topology of measures.
Then $\mathcal R(U, F)$ is a separable Fr\'echet space, with seminorms $|\langle \cdot, f_j\rangle|$ where $(f_j)$ is a countable basis for a dense subspace of $C_0(U, F)$.
Thus $\mathcal R(\cdot, F)$ is a sheaf of separable Fr\'echet spaces.

\begin{definition}
If $\omega \in \mathcal R(M, F)$ we define the \dfn{total variation} $|\omega|$ to be the positive Radon measure such that on every open set $U$,
$$|\omega|(U) = \sup_{X \prec U} \langle \omega, X\rangle,$$
where $X$ ranges over $C_0(M, F')$.
\end{definition}

Since $\RR_+$ acts on $F$ by scalar multiplication, we can define the \dfn{sphere bundle} $SF = (F \setminus 0)/\RR_+$.
Since $F$ has a norm, $SF$ is naturally identified with the bundle of elements of $F$ with length $1$.

\begin{proposition}[Hanh-Jordan decomposition]\label{HanhJordan}
Let $\omega$ be a $F$-valued Radon measure and let $\mu = |\omega|$.
Then there exists a $\mu$-measurable section $f$ of $SF$ such that for every section $X \in C_0(M, F', \mu)$,
\begin{equation}\label{RNy formula}
\langle \omega, X\rangle = \int_M (f, X) ~d\mu.
\end{equation}
Furthermore, $f$ is unique up to a $\mu$-null set, and does not depend on the norm of $F$.
\end{proposition}
\begin{proof}
Fix an open cover $(U_i)$ of $M$ by charts which trivialize $F$, so that $U_i$ is precompact in $M$.
Thus we can identify $F|U_i$ with the trivial bundle with fiber $\CC^r$.
We then obtain transition functions $g_{ij}: U_i \cap U_j \to GL(\CC^r)$.
We write $g_{ij}': U_i \cap U_j \to GL((\CC^r)')$ for the dual transition functions $g_{ij}'(x) = g_{ji}(x)^t$.

Identifying $F|U_i$ with $U_i \times \CC^r$, we can view $\omega|U_i$ as an element of $C(U_i, (\CC^r)')'$, by the precompactness of $U_i$.
Hence by the Riesz-Markov theorem, $\omega_i = \omega|U_i$ is canonically identified with an $\CC^r$-valued Radon measure on $U_i$ and $\omega_i \ll \mu$.
Therefore, by the Radon-Nikod\'ym theorem, there exists a unique vectorial function
$$f_i \in L^1(U_i, \CC^r, \mu)$$
such that for every $\mu$-measurable $E \subseteq U_i$,
$$\omega_i(E) = \int_E f_i ~d\mu.$$
(The integral is meant in the Bochner sense.)
In particular, (\ref{RNy formula}) holds provided that $X \in C(U_i, (\CC^r)')$.

We now show that the $f_i$ are restrictions of a global section $f$, thus we must show $f_j = g_{ij} \circ f_i$ on $\CC^r$.
To this end, fix $X \in C_0(M, F)$ which is supported in $U_i \cap U_j$ and write $X_i \in C(U_i, (\CC^r)')$ for the trivialization of $X$ with respect to $U_i$.
Then $X_j = g_{ij}' \circ X_i$, and
\begin{align*}
\int_E (f_i, X_i) ~d\mu &= \langle \omega_i, X_i\rangle = \langle \omega, X\rangle\\
&= \langle \omega_j, X_j\rangle = \int_E (f_j, X_j) ~d\mu = \int_E (f_j, g_{ij}' \circ X_i) ~d\mu \\
&= \int_E (g_{ji} \circ f_j, X_i) ~d\mu.
\end{align*}

By Urysohn's lemma, $C_c(U_i \cap U_j, (\CC^r)', \mu)$ separates points in $L^1(U_i \cap U_j, \CC^r, \mu)$.
Therefore, since $X$ was arbitrary, $f_i = g_{ji} \circ f_j$, and so the desired global section $f$ exists.
The fact that the $f_i$ are locally unique implies global uniqueness of $f$.
To verify (\ref{RNy formula}), we note that by a partition of unity argument it suffices to do so when $X$ is supported in some chart $U_i$, and then we can replace $f$ by $f_i$ in (\ref{RNy formula}) and there is nothing to prove.

To show that $f$ is a section of $SF$ we just need to show that $|f| = 1$, $\mu$-almost everywhere.
Suppose that there exists $\varepsilon > 0$ and a $\mu$-measurable set $E$ such that $|f| < 1 - \varepsilon$ and $\mu(E) > 0$. (The case $|f| > 1$ is similar.)
Since $\mu$ is a Radon measure, for every $\delta > 0$ there exists an open set $U \supseteq E$ such that
$$\mu(U) < (1 - \varepsilon)(1 + \delta)\mu(E).$$
Therefore for every $X \prec U$,
$$\int_M (f, X) ~d\mu \leq \int_U |f| ~d\mu < (1 + \delta)^{-1}\mu(U),$$
yet by definition of total variation,
$$\mu(U) = \sup_{X \prec U} \int_M (f, X) ~d\mu,$$
so optimizing in $X$ we get
$$\mu(U) < (1 + \delta)^{-1}\mu(U)$$
which is a contradiction.

Finally, if we change the norm of $F$, replacing $|\cdot|$ with $|\cdot|'$, then we obtain a smooth function $h: F \to \RR_+$ so that if $v \in F_x$, then $|v|' = h(x, v)|v|$.
The change of norm gives us a new section $f'$ such that $f' = f/h(\cdot, f'(\cdot))$.
Thus $f'$ defines the same section of $SF$ as $f$.
\end{proof}

Because of the above, we write
$$\omega = f\mu$$
to emphasize that $\omega$ is an $F$-valued Radon measure, with total variation $\mu$, which induces a section $f: M \to SF$ of the sphere bundle $SF \to M$ which is $\mu$-measurable.

At this stage we have only defined $f$ as a $\mu$-equivalence class of sections of $SF$, so the pointwise value $f(x)$ makes no sense.
So we now use a form of the Lebesgue differentiation theorem to choose the ``correct" representative.

Recall that a \dfn{Besicovitch cover} $\mathcal U$ of a metric space $X$ is a set of open balls, so that every $x \in X$ is the center of an element of $\mathcal U$.
We will need a result that easily follows from \cite[\S2.8]{federer2014geometric}.

\begin{proposition}[Besicovitch covering theorem]
For every Riemannian metric $g$ on $M$ and $U \Subset M$, there exists $N \in \NN$ such that for every $x \in U$ and Besicovitch cover $\mathcal U$ of $B(x, 1/N)$, there exist $\mathcal U_1, \dots \mathcal U_N \subset \mathcal U$ such that $\bigcup_{n=1}^N \mathcal U_n$ is an open cover of $B(x, 1/N)$ and $\mathcal U_n$ is disjoint.
\end{proposition}

We call the constant $N$ the \dfn{Besicovitch number} of $g$. Note that we must restrict to balls $B(x, 1/N)$ owing to \cite{Shi91}.

For each $x \in M$, let $\mathcal A(x)$ denote the set of all pairs $(g, B, \varphi)$ where:
\begin{enumerate}
\item $g$ is a Riemannian metric on $M$,
\item $B$ is an open ball centered at $x$ with respect to $g$, and
\item $\varphi$ is a trivialization of $F$ over $B$.
\end{enumerate}
Then $\mathcal A(x)$ is a directed system, where the order is given by reverse inclusion of balls.
Given $(g, B, \varphi) \in \mathcal A(x)$, we obtain a $\mu$-measurable function $f_\varphi: B \to \CC^r$ obtained by trivializing the section $f$.
We define the average
$$f(g, B, \varphi) = \varphi^{-1}\left(\frac{1}{\mu(B)} \int_B f_\varphi ~d\mu\right),$$
which is a point in $F_x$.

\begin{proposition}[Lebesgue differentiation theorem]
Let $\mu$ be a Radon measure on $M$, let $f \in L^1_l(M, SF, \mu)$, and let
$$f(x) = \lim_{(g, B, \varphi) \in \mathcal A(x)} f(g, B, \varphi).$$
Then the limit defining $f(x)$ converges for $\mu$-almost every $x \in M$ to a point in the sphere $SF_x$.
\end{proposition}
If $f(x)$ exists and is $\in SF_x$, we call $x$ a \dfn{Lebesgue point} of the section $f$.
\begin{proof}
This is obvious if $f$ has a representative in $C_c(M, SF)$; besides, by a partition of unity argument, we may assume that $\mu$ has compact support.
We can then select $(f_n)$ in $C_c(M, SF)$ converging in $L^1(M, SF, \mu)$ and almost everywhere to $f$.
Setting $h_n = |f_n - f|$, we can define the average
$$h_n(g, B) = \frac{1}{\mu(B)} \int_B h_n ~d\mu,$$
which converges to $0$ in $L^1(M, \mu)$.

Fix $N \in \NN$ and let $\mathcal B_N$ be the set of Riemannian metrics with Besicovitch number $\leq N$.
This makes sense if we restrict to a neighborhood of the compact support of $\mu$.
For each metric $g \in \mathcal B_N$, we have the Hardy-Littlewood inequality \cite[Lemma 4.1.1a]{Ledrappier85}
\begin{equation}\label{HardyLittlewood}
||\sup_{r \in (0, 1/N)} h_n(g, B_g(\cdot, r))||_{L^{1, \infty}(M, \mu)} \leq N ||h_n||_{L^1(M, \mu)}.
\end{equation}
By (\ref{HardyLittlewood}) and the convergence $h_n \to 0$ in $L^1$,
$$\lim_{n \to \infty} ||\sup_{0 \in (0, 1/N)} h_n(g, B_g(\cdot, r))||_{L^{1, \infty}(M, \mu)} = 0$$
uniformly in $g \in \mathcal B_N$.
Therefore we may pass to a subsequence along which, for $\mu$-almost every $x$,
$$\lim_{n \to \infty} \sup_{(g, r) \in \mathcal B_N \times (0, 1/N)} h_n(g, B_g(x, r)) = 0.$$
By the triangle inequality, if
$$\mathcal A_N(x) = \{(g, B, \varphi) \in \mathcal A(x): g \in \mathcal B_N\},$$
then (after passing to a subsequence again)
$$\lim_{n \to \infty} \sup_{(g, B, \varphi) \in \mathcal A_N(x)} |f_n(g, B_g(x, r), \varphi) - f(g, B_g(x, r), \varphi)| = 0.$$
But $f_n(g, B, \varphi) \to f(x)$ everywhere, $f(x) \in SF_x$, and $SF_x$ is closed, so there exists a $\mu$-null set $Z_N$ such that outside of $Z_N$,
$$\lim_{(g, B, \varphi) \in \mathcal A_N(x)} f(g, B, \varphi) \in SF_x.$$
Taking $Z = \bigcup_{N \in \NN} Z_N$, we see that $Z$ is $\mu$-null, which was to be shown.
\end{proof}

\subsection{Differentiation and boundary}
Let $M = (M, g)$ be a Riemannian manifold.

\begin{definition}
A function in $L^1(M)$ has \dfn{bounded variation} if its distributional derivative is a $T'M$-valued Radon measure of finite total variation.
We write $BV$ for the presheaf of functions of bounded variation.
A \dfn{Caccioppoli set} is an open set whose indicator function has locally bounded variation.
\end{definition}

If $u$ is a function of bounded variation we write $du ~\vol$ for its derivative, to emphasize that it depends on the volume form.

Sequences $(u_n)$ in $BV_l(M)$ with $u_n \to u$ in $L^1_l(M)$ satisfy the lower semicontinuity property
\begin{equation}
\label{RieszMarkovDistr}
\int_M |du| ~\vol \leq \liminf_{n \to \infty} \int_M |du_n| ~\vol.
\end{equation}
which follows by testing against smooth functions, and the forgetful map
\begin{equation}\label{Forget}
BV_l(M) \to L^1_l(M)
\end{equation}
is compact. We refer to \cite[Chapter 1]{Giusti77} for a review of the space $BV_l(M)$.

Let $U$ be a Caccioppoli set.
We will now construct the reduced boundary of a Caccioppoli set.
The notion was first introduced in \cite{deGiorgi55}; see \cite{Battista_2021} for an equivalent definition.

Let $U$ be a Caccioppoli set, $\omega = d1_U ~\vol$, and let $\normal$ be the $\mu$-measurable section of $ST'M$ such that $\omega = \normal |\omega|$.
Then $\normal$ is well-defined, and independent of the metric $g$, by Proposition \ref{HanhJordan}.
In particular the set of Lebesgue points of $\normal$ is independent of $g$.

\begin{definition}
Let $U,\normal$ be as above.
The \dfn{reduced boundary} $\partial^* U$ of a Caccioppoli set $U$ is the set of Lebesgue points of $\normal$.
The \dfn{conormal $1$-form} to $\partial^* U$ is $\normal$.
The \dfn{tangent bundle} $T\partial^* U$ to $\partial^* U$ is the kernel bundle of $\normal$.
\end{definition}

We prefer to work with $\normal$, rather than the normal field $\normal^\sharp$, because the latter is not metric-independent.
Since the reduced boundary and conormal $1$-form are metric-independent, we may import any known fact about them in the euclidean case.
See \cite[Chapters 2-4]{Giusti77} for a discussion of the euclidean case.

\begin{proposition}\label{regularity of reduced boundary}
Let $U$ be a Caccioppoli set.
Then:
\begin{enumerate}
\item $\partial^* U$ is either empty or $d-1$-dimensional in the Hausdorff sense, and is rectifiable with respect to $d-1$-dimensional Hausdorff measure.
\item $\partial^* U$ is dense in the measure-theoretic boundary $\partial U$.
\item If $\normal$ extends to a continuous $1$-form on $\partial U$, then $\partial^* U = \partial U$ is a $C^1$ hypersurface.
\item If $\normal$ extends to a continuous $1$-form on $\partial U$ and $U$ has least perimeter, then $\partial U$ is as smooth as possible.
\end{enumerate}
\end{proposition}
\begin{proof}
The claim is local, so we can work in a small ball in which we can find a flat metric.
The first three claims then immediately follow from their euclidean counterparts, which are given in \cite[Chapters 2-4]{Giusti77} or \cite{deGiorgi55}.

To complete the proof, suppose that $\normal$ extends to a continuous $1$-form on $\partial U$ and $U$ has least perimeter.
Let $f: \RR^{d - 1} \to M$ be a local $C^1$ parametrization of $\partial U$, so that $f$ is a minimizer of the Lagrangian $\mathscr L$ defined by (\ref{Lagrangian density}).
But $\mathscr L$ is a regular Lagrangian in the sense of Hilbert's 19th problem, so $f$ is analytic \cite{morrey2009multiple}.
\end{proof}

\begin{notation}
We write $|\partial^* U|$ for $\int_M |d1_U| ~\vol$.
This does not collide with the notation $|U|$ for the volume of $U$, since $U$ has Hausdorff dimension $d$.
\end{notation}

\subsection{The coarea formula} \label{coarea section}
Let $M = (M, g)$ be a Riemannian manifold.
Throughout this section we consider the superlevel sets $E_y = \{u > y\}$ of a function $u \in BV_l(M)$, and the resulting $T'M$-valued Radon measures
$$\omega(y) = d1_{E_y} ~\vol.$$
Let $\mu = |du| ~\vol$.

We first observe that for every $X \in \mathcal D(M, TM)$,
$$\langle \omega(y), X\rangle = -\int_{E_y} \mathcal L_X\vol$$
is measurable in $y$, since $E_y$ is monotone in $y$.
So by Pettis' theorem, $\omega$ is measurable in $y$ with respect to the weak topology of measures.

\begin{lemma}[coarea formula for measures]\label{Coarea1}
One has
$$du ~\vol = \int_{-\infty}^\infty \omega(y) ~dy.$$
\end{lemma}
\begin{proof}
Fix $X \in C_c(M, TM)$. We may assume that $u \geq 0$, and we must show
\begin{equation}
\label{gradient is integral of fibers}
\int_M (du, X) ~\vol = \int_{-\infty}^\infty \langle \omega(y), X\rangle ~dy.
\end{equation}
Since $u \geq 0$,
\begin{align*}
\int_M (du, X) ~\vol &= -\int_M u~\mathcal L_X\vol = -\int_M \int_0^{u(x)} dy ~\mathcal L_X\vol\\
&= -\int_0^\infty \int_{E_y} ~\mathcal L_X\vol ~dy = \int_0^\infty \langle \omega(y), X\rangle ~dy.
\end{align*}
by Fubini's theorem.
If $y < 0$ then $1_{E_y} = 1$ so $\omega(y) = 0$, so we conclude (\ref{gradient is integral of fibers}).
\end{proof}

Let $p: L \to M$ be the trivial line bundle with its induced metric $h$, and let $\eta$ be the volume form induced by $h$.
If $W$ is a vector field on $L$, we will write $W_1$ for the projection of $W$ onto $M$ and $W_2$ for its projection onto $\CC$.
Then Cartan's magic formula implies that if $W_2$ is constant, then
\begin{equation}
\label{Lie derivative computation}
\mathcal L_W\eta = \mathcal L_W\vol \wedge dy.
\end{equation}

\begin{lemma}\label{coarea converse}
Suppose that $W \in \mathcal D(L, TL)$ depends on a parameter $n \in \NN$, such that $W_2 = 0$ and for every $y \in \RR$, $X = W_1(\cdot, y)$ is a maximizing sequence for $\langle \omega(y), X\rangle$ subject to $X \prec U$.
Then
$$\int_{-\infty}^\infty \langle \omega(y), W(y)\rangle ~dy \leq \mu(U).$$
\end{lemma}
\begin{proof}
Let
$$E = \{(x, y) \in L: x \in E_y\}$$
be the undergraph of $u$.
By Fubini's theorem and (\ref{Lie derivative computation}),
\begin{align*}
\int_{-\infty}^\infty \langle \omega(y), W(y)\rangle ~dy &= -\int_{-\infty}^\infty \int_{E_y} \mathcal L_W\vol ~dy = -\iint_E ~\mathcal L_W\eta = \int_M (d1_E, W) ~\vol.
\end{align*}

Let $(u_m)$ be a mollification of $u$, so that $u_m \to u$ in the weak topology of distributions.
Then if $\chi$ is a cutoff, $\langle u_m, \chi\rangle \to \langle u, \chi\rangle$; taking a sequence of $\chi$ which increase to the indicator function of a compact set $K$, we conclude that $u_m \to u$ in $L^1(K)$, and hence $u_m \to u$ in $L^1_l$.

Let $E^{(m)}$ be the undergraph of $u_m$, and $E^{(m)}_y = \{u_m > y\}$.
Then for every test function $v$,
\begin{align*}
\langle 1_{E^{(m)}} - 1_E, v\rangle &= \int_{E^{(m)} \Delta E} v ~\vol \leq |(E^{(m)} \Delta E) \cap (\supp v \times \RR)| \cdot ||v||_{L^\infty}\\
&\leq ||v||_{L^\infty} \int_{\supp v} |u_m - u| ~\vol \to 0
\end{align*}
so $1_{E^{(m)}} \to 1_E$ in the weak topology of distributions.
Therefore
$$\lim_{m \to \infty} \int_M (d1_{E^{(m)}}, W) ~\vol = \int_M (d1_E, W) ~\vol.$$

Since $u_m$ is smooth, its graph $F_m = \partial E^{(m)}$ is a smooth manifold.
Let $\nu_m$ be the upwards unit normal field of $F_m$ and let $\vol_m$ be the volume form on $F_m$ induced by $\eta$.
Then
$$\langle d 1_{E^{(m)}}, W\rangle = -\iint_{E^{(m)}} \mathcal L_W\eta = -\int_{F_m} h(\nu_n, W) ~\vol_m.$$
Let $q_m = p|F_m$ and $Y_m$ be the vector field $(Y_m)_1 = -d u_m$, $(Y_m)_2 = 1$.
Since $F_m$ is a graph, $q_m: F_m \to M$ is a diffeomorphism, $(q_m)_*\nu_m = Y_m/|Y_m|$, and
$$(q_m)_* \vol_m = |Y_m| ~\vol.$$
Therefore
$$\int_{F_m} h(\nu_n, W) ~\vol_m = \int_M h(Y_m, W) ~\vol = \int_M g(d u_m, W_1) ~\vol = \int_M (d u_m, W_1) ~\vol.$$
Thus
\begin{align*}
|\langle d 1_E, W\rangle| &= \lim_{m \to \infty} |\langle d u_m, W_1\rangle| \leq \mu(U). \qedhere
\end{align*}
\end{proof}

\begin{proposition}[coarea formula for $BV_l$ functions]\label{Coarea2}
Let $u \in BV(M)$, let $E_y = \{u > y\}$, and let $\omega(y) = d1_{E_y} ~\vol$.
Then, if $\mu$ is the total variation of $du ~\vol$,
$$\mu = \int_{-\infty}^\infty |\omega(y)| ~dy.$$
\end{proposition}
\begin{proof}
By Lemma \ref{Coarea1} and the triangle inequality,
$$\mu \leq \int_{-\infty}^\infty |\omega(y)| ~dy.$$
So we just need to prove the converse.

Let $U \Subset M$.
Suppose that for every $y \in \RR$, $X = X^{(n)}_y$ is a maximizing sequence for $\langle \omega(y), X\rangle$ subject to $X \prec U$.
Since $\omega$ with respect to the weak topology of measures, for every $n$, $X^{(n)}_y(x)$ can be chosen to be measurable in $(x, y)$; indeed, we can take $X^{(n)}_y$ to be a smooth approximation to the Radon measure $d 1_{E_y}/|d 1_{E_y}|_{TV}$ in the weak topology of distributions, which is a product of the measurable functions $\omega$ and $y \mapsto 1/|\omega(y)|$.

By an approximation argument, we can find $W^{(n)} \in C_c(L, TL)$ such that $W^{(n)}_2 = 0$ and for every $y \in \RR$, $X = W^{(n)}_1(\cdot, y)$ is a maximizing sequence for $\langle d 1_{E_y}, X\rangle$ subject to $X \prec U$.
Let us now suppress the $n$ and write $W(y) = W^{(n)}(\cdot, y)$.

By Lemma \ref{coarea converse}, since $W$ has compact support, the integrand $\langle d 1_{E_y}, W(y)\rangle$ is uniformly bounded in $y$.
Therefore, by Fatou's lemma,
\begin{align*}
\int_{-\infty}^\infty |\omega(y)| ~dy &= \int_{-\infty}^\infty \lim_{n \to \infty} \langle \omega(y), W(y)\rangle ~dy \leq \liminf_{n \to \infty} \int_{-\infty}^\infty \langle \omega(y), W(y)\rangle ~dy \\
&\leq \mu(U). \qedhere
\end{align*}
\end{proof}

\subsection{Devil's staircases}
We will not this material in the paper proper, but it just serves to illustrate the above general theory.

\begin{definition}
By a \dfn{Devil's staircase} in a surface $M = (M, g)$ we shall mean a rectifiable curve $\gamma: [0, 1] \to M$ such that there exist local parameters $(x, y)$ and a Lebesgue null set $Z \subseteq [0, 1]$ so that, $\partial_y \gamma = 0$ on $Z$, but the $y$-coordinate of $\gamma(t)$ increases from $0$ to $1$ as $t$ increases from $0$ to $1$.
\end{definition}

The basic example of a Devil's staircase is of course the graph of the Cantor function $F: [0, 1] \to [0, 1]$, with $Z$ the null Cantor set.
We refer to \cite{Dovgoshey0061} for basic facts about the Cantor function.
Let $U$ be the undergraph of $F$, so $\partial U$ is parametrized by a Devil's staircase $\gamma$.
Since $F$ has a rectifiable graph of arc length $2$, it follows from \cite[Theorem 4.4]{Giusti77} that $|\partial^* U| = 2$, and since $\gamma([0, 1] \setminus Z) = 1$, there exist points in $\partial^* U$ where $\partial^* U$ is highly singular.

In fact, the above phemonenon holds in general.
Suppose that $\gamma$ is a Devil's staircase, which bounds an open set $U$, say from above in our given coordinates $(x, y)$.
Then, since $\gamma$ is rectifiable, $U$ is a Caccioppoli set, say $u = 1_U \in BV_l(M)$.
There again must exist singular points in $\partial^* U$.
In fact, we can partition almost all of $U$ into Caccioppoli sets $V \in \mathcal V$ so that $\partial V$ is piecewise smooth, by choosing the ``top" of each $V \in \mathcal V$ to be the portion of $\gamma$ which is flat.
If $\mu = |du| ~\vol$ is the natural Radon measure on $\gamma([0, 1])$, then for every $X \in C_c(M, TM)$,
$$\mu(M) \geq \int_M (du, X) ~\vol$$
and in particular this is true if $X$ is the unit inwards normal field to $U$ on an arbitrarily large subset $A$ of the smooth part $A_0$ of $\gamma$ but points right on the singular part $B$.
Thus
$$\mu(M) \geq \int_A (du, X) ~\vol + \int_B (du, X) ~\vol,$$
and clearly
$$\int_A (du, X) ~\vol = |A|.$$
Meanwhile, we can sum over the pieces of $B$ to see that $\int_B (du, X) ~\vol$ increases as we optimize in $X$ to be the amount that the $y$-coordinate of $\gamma$ increases, namely $1$.
Thus $\mu(M) \geq |A| + 1$, and optimizing in $|A|$ we see that $\mu(M) > |A_0|$, which proves the claim.

It would be interesting to explicitly compute $\normal$ for the standard middle-thirds Cantor set.

\printbibliography


\end{document}
