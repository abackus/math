\documentclass[reqno,11pt]{amsart}
\usepackage[letterpaper, margin=1in]{geometry}
\RequirePackage{amsmath,amssymb,amsthm,graphicx,mathrsfs,url,slashed,subcaption}
\RequirePackage[usenames,dvipsnames]{xcolor}
\RequirePackage[colorlinks=true,linkcolor=Red,citecolor=Green]{hyperref}
\RequirePackage{amsxtra}
\usepackage{cancel}
\usepackage{tikz, wrapfig}

% Add the 2020 MSC
\makeatletter
\@namedef{subjclassname@2020}{\textup{2020} Mathematics Subject Classification}
\makeatother

%\usepackage[T1]{fontenc}

% \setlength{\textheight}{9.3in} \setlength{\oddsidemargin}{-0.25in}
% \setlength{\evensidemargin}{-0.25in} \setlength{\textwidth}{7in}
% \setlength{\topmargin}{-0.25in} \setlength{\headheight}{0.18in}
% \setlength{\marginparwidth}{1.0in}
% \setlength{\abovedisplayskip}{0.2in}
% \setlength{\belowdisplayskip}{0.2in}
% \setlength{\parskip}{0.05in}
%\renewcommand{\baselinestretch}{1.05}

\title{Discrete tight maps}
\author{}
\address{}
\email{}
\date{\today}
\keywords{}
\subjclass[2020]{primary: }

\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\PP}{\mathbf P}
\newcommand{\MM}{\mathbf M}
\newcommand{\II}{\mathbf I}
\newcommand{\Hyp}{\mathbf H}
\newcommand{\Sph}{\mathbf S}
\newcommand{\Torus}{\mathbf T}
\newcommand{\Group}{\mathbf G}
\newcommand{\GL}{\mathbf{GL}}
\newcommand{\Orth}{\mathbf{O}}
\newcommand{\SpOrth}{\mathbf{SO}}
\newcommand{\Ball}{\mathbf{B}}

\newcommand*\dif{\mathop{}\!\mathrm{d}}

\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\mesh}{mesh}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\tr}{tr}

\newcommand{\Two}{\mathrm{I\!I}}
\newcommand{\weakto}{\rightharpoonup}

\newcommand{\normal}{\mathbf n}
\newcommand{\vol}{\mathrm{vol}}

\newcommand{\diam}{\mathrm{diam}}
\DeclareMathOperator{\sech}{sech}
\newcommand{\inj}{\mathrm{inj}}
\newcommand{\Lip}{\mathrm{Lip}}
\newcommand{\Riem}{\mathrm{Riem}}

\DeclareMathOperator*{\essinf}{ess\,inf}
\DeclareMathOperator*{\esssup}{ess\,sup}

\newcommand{\dfn}[1]{\emph{#1}\index{#1}}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

\newcommand{\loc}{\mathrm{loc}}
\newcommand{\cpt}{\mathrm{cpt}}

\def\Japan#1{\left \langle #1 \right \rangle}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{badtheorem}[theorem]{``Theorem"}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{sublemma}[theorem]{Sublemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{assumption}[theorem]{Assumption}

\newtheorem{mainthm}{Theorem}
\renewcommand{\themainthm}{\Alph{mainthm}}

\newtheorem{claim}{Claim}[theorem]
\renewcommand{\theclaim}{\thetheorem\Alph{claim}}
% \newtheorem*{claim}{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{notation}[theorem]{Notation}

\newtheorem{exercise}[theorem]{Discussion topic}
\newtheorem{homework}[theorem]{Homework}
\newtheorem{problem}[theorem]{Problem}

\makeatletter
\newcommand{\proofpart}[2]{%
  \par
  \addvspace{\medskipamount}%
  \noindent\emph{Part #1: #2.}
}
\makeatother



\numberwithin{equation}{section}


% Mean
\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\usepackage[backend=bibtex,style=alphabetic,giveninits=true]{biblatex}
\renewcommand*{\bibfont}{\normalfont\footnotesize}
\addbibresource{discrete_tight_maps.bib}
\renewbibmacro{in:}{}
\DeclareFieldFormat{pages}{#1}

\newcommand\todo[1]{\textcolor{red}{TODO: #1}}


\begin{document}
\begin{abstract}
    
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\section{Lipschitz maps}
For a Lipschitz map $u: U \to \RR^n$, let
$$Lu(x) := \inf_{r > 0} \Lip(u, B(x, r)).$$
Then $Lu$ is upper semicontinuous \cite[Lemma 4.2(a)]{Crandall2008}.
Though $Lu$ is not lower semicontinuous, it enjoys the following partial lower semicontinuity property:

\begin{lemma}
Let $x \in U$, let $V \subseteq U$ be an open neighborhood of $x$, and let $\delta > 0$.
Then 
\begin{equation}\label{partial lower semicontinuity}
\vol(V \cap \{Lu > Lu(x) - \delta\}) > 0.
\end{equation}
\end{lemma}
\begin{proof}
\todo{Claimed without proof by \cite[\S1.4]{Sheffield12}.}
\end{proof}

For $p \in [1, \infty]$, and a linear map $A$, let $|A|_p$ denote the $p$th Schatten norm of $A$.
In particular $|A|_\infty$ is the operator norm of $A$.
So, if $u: U \to \RR^n$ is a $C^1$ map, $\||\dif u|_\infty\|_{C^0} = \Lip(u, U)$.

\begin{lemma}
For almost every $x \in U$,
$$Lu(x) = |\dif u|_\infty(x).$$
\end{lemma}
\begin{proof}
By a similar argument to \cite[Lemma 4.2(e)]{Crandall2008}, for any $x \in U$,
$$Lu(x) = \lim_{r \to 0} \||\dif u|_\infty\|_{L^\infty(B(x, r))}.$$
Let $\varepsilon > 0$.
By Lusin's theorem, there is a closed set $Z_\varepsilon \subset U$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $|\dif u|_\infty$ is continuous on $U \setminus Z_\varepsilon$.
So for $x \in U \setminus Z_\varepsilon$, $\||\dif u|_\infty\|_{L^\infty(B(x, r))} \to |\dif u|_\infty(x)$ as $r \to 0$, hence $Lu(x) = |\dif u|_\infty(x)$.
The claim follows by taking $\varepsilon \to 0$.
\end{proof}

\begin{definition}[{\cite[\S1.3]{Sheffield12}}]
Let $u, v: U \to \RR^n$ be Lipschitz extensions of a Lipschitz map $\partial U \to \RR^n$.
We say that $u$ is \dfn{tighter} than $v$, written $u \prec v$, if 
$$\sup_{Lu > Lv} Lu < \sup_{Lv > Lu} Lv.$$
If there is no tighter $v$ than $u$, we say that $u$ is \dfn{tight}.
% \item We say that $u$ is \dfn{measurably tighter} than $v$, written $u \prec_M v$, if there exists $s > 0$ such that for every $t \geq s$,
% \begin{align*}
% \vol\{Lu \geq s\} &< \vol\{Lv \geq s\}, \\
% \vol\{Lu \geq t\} &\leq \vol\{Lv \geq t\}.
% \end{align*}
% \item If there is no measurably tighter $v$ than $u$, we say that $u$ is \dfn{measurably tight}.
\end{definition}

% \begin{lemma}
% Let $u, v: U \to \RR^n$ be Lipschitz extensions of a Lipschitz map $\partial U \to \RR^n$.
% If $u \prec_M v$ then $u \prec v$.
% \end{lemma}
% \begin{proof}
% Claimed without proof by \cite[\S1.4]{Sheffield12}.
% \end{proof}

\section{The discrete problem}
\subsection{Discretization}
\begin{definition}
Let $\tau$ be a simplicial complex.
\begin{enumerate}
\item Let $V_i(\tau)$ be the set of $i$-simplices in $\tau$.
\item The \dfn{mesh size} $\mesh(\tau)$ of $\tau$ is 
$$\mesh(\tau) := \sup_{E \in V_1(\tau)} \diam(E).$$
\item We say that $\tau$ is $R$-\dfn{shape regular}, $R > 0$, if for every $T \in V_m(\tau)$ and every pair of vertices $x, y \in T$,
$$\diam(T) \leq R|x - y|.$$
\item We say that $\tau$ is a \dfn{subdivision} of a simplicial complex $\tau'$ if:
\begin{enumerate}
\item Every simplex of $\tau$ is contained in a simplex of $\tau'$.
\item Every simplex of $\tau'$ admits a triangulation by finitely many simplices of $\tau$.
\end{enumerate}
\end{enumerate}
\end{definition}

\begin{definition}
Let $(\tau_h)_{h > 0}$ be a family of triangulations of a polytope $U \subseteq \RR^m$ with $\mesh(\tau_h) \leq h$, such that if $h < h'$, then $\tau_h$ is a subdivision of $\tau_{h'}$.
\begin{enumerate}
\item We say that $x \in U$ is a \dfn{regular point} if for every $h > 0$, $x$ is not contained in any $m - 1$-face of $\tau_h$.
\item We say that $x \in U$ is a \dfn{vertex point} if there exist arbitrarily small $h > 0$ such that $x$ is a vertex of $\tau_h$.
\end{enumerate}
\end{definition}

\begin{proposition}
Suppose that $U$ is the interior of an $m$-simplex.
Then there is a family of triangulations $(\tau_h)_{h > 0}$ of $U$ such that:
\begin{enumerate}
\item For every $h > 0$, $\mesh(\tau_h) \leq h$.
\item For every $h' > h > 0$, $\tau_h$ is a subdivision of $\tau_{h'}$.
\item There exists $R > 0$ such that for every $h > 0$, $\tau_h$ is $R$-shape regular.
\item For every $h > 0$ and every edge $T \in V_1(\tau_h)$, $T$ is a line segment.
\item Almost every point of $U$ is regular, but the vertex points are a dense subset of $U$.
\item For every $\ell \in \PP^{m - 1}$, $x \in U$, and $h > 0$, there exist $T_h \in V_m(\tau_h)$ and an edge $[y_h, z_h]$ of $T_h$, such that $x \in T_h$,
$$\lim_{h \to 0} \frac{|x - y_h|}{\diam(T_h)} = 0,$$
and if $[y_h, z_h]$ is a line segment in a translate of $\ell_h \in \PP^{m - 1}$, then $\ell_h \to \ell$.
\end{enumerate}
\end{proposition}
\begin{proof}
\end{proof}

\todo{We need something much weaker than this (the proposition is false anyways). In particular we don't care if they are subdivisions, only that regular and vertex points are well-defined.}

%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Lipschitz maps from simplicial complexes}
For a Lipschitz map $u: U \to \RR^n$ and $h > 0$, define $u_h$ by letting $u_h(x) = u(x)$ whenever $x$ is a vertex of $\tau_h$, and extension so $u_h$ is linear on each simplex of $\tau_h$.
Thus for any simplex $T \in \tau_h$ and regular point $x \in T$,
\begin{equation}\label{discrete derivative is vertex lip}
|\dif u_h|_\infty(x) = \max_{y, z \in V(T)} \frac{|u(y) - u(z)|}{|y - z|}.
\end{equation}
In particular,
\begin{equation}\label{discretization contracts lipschitz}
\Lip(u_h, T) \leq \Lip(u, T).
\end{equation}

\begin{lemma}
For a Lipschitz map $u: U \to \RR^n$ and $x \in U$,
$$|u_h(x) - u(x)| \leq 2h \Lip(u, B(x, h)).$$
\end{lemma}
\begin{proof}
Suppose that $T \in \tau_h$ contains $x$ and let $y \in V(T)$.
Then by (\ref{discretization contracts lipschitz}),
\begin{align*}
|u_h(x) - u(x)|
&\leq |u_h(y) - u(y)| + |u_h(y) - u_h(x)| + |u(y) - u(x)| \\
&\leq 0 + h\Lip(u_h, T) + h\Lip(u, T) \\
&\leq 2h \Lip(u, B(x, h)). \qedhere
\end{align*}
\end{proof}

\begin{lemma}
For any Lipschitz map $u$, $|\dif u_h|_\infty \to |\dif u|_\infty$ almost everywhere.
\end{lemma}
\begin{proof}
Let $\varepsilon > 0$.
By Lusin's theorem, there is a closed set $Z_\varepsilon \subset U$ with $\vol(Z_\varepsilon) < \varepsilon$ such that $|\dif u|_\infty$ is continuous away from $Z_\varepsilon$.
We shall show that $|\dif u_h|_\infty(x) \to |\dif u|_\infty(x)$ for every regular point $x$ of $U \setminus Z_\varepsilon$.
Taking $\varepsilon \to 0$, this implies the claim.

For each $h > 0$, let $T_h \in \tau_h$ contain $x$, and let $y_h, z_h \in V(T_h)$ be the maximizers in (\ref{discrete derivative is vertex lip}).
By the mean value theorem, there is a point $w_h$ on the edge $[y_h, z_h]$ such that
$$|\dif u|_\infty(w_h) = |\dif u_h|_\infty(x).$$
If $h$ is small enough depending on $x$, then $T_h$ is contained in the open set $U \setminus Z_\varepsilon$, so 
\begin{align*}
\lim_{h \to 0} |\dif u_h|_\infty(x) = \lim_{h \to 0} |\dif u|_\infty(w_h) &= |\dif u|_\infty(x). \qedhere
\end{align*}
\end{proof}

%%%%%%%%%%%%%%%%%%%
\subsection{From discrete to continuum tight maps}
\begin{proposition}
Assume that $u \prec v$.
Then for every sufficiently small $h$, $u_h \prec v_h$.
\end{proposition}
\begin{proof}
Let 
$$M := \sup_{Lu < Lv} Lv$$
Since $u \prec v$, there exists $\delta > 0$ such that
$$\sup_{Lv < Lu} Lu(x) < M - \delta.$$

\begin{claim}
If $\delta, h$ are small enough, then 
$$\sup_{Lu_h < Lv_h} Lv_h > M - \delta.$$
\end{claim}
\begin{proof}[Proof of claim]
By definition of $M$, if $\delta$ is taken small enough, then there exists $x \in U$ such that
$$Lu(x) < M - \delta < Lv(x).$$
By (\ref{partial lower semicontinuity}), and the fact that $\{Lu < M - \delta\}$ is open, it follows that the set of $y$ such that $Lv(y) > M - \delta$ and $Lu(y) < M - \delta$ has positive measure.
So by Rademacher's theorem, after replacing $x$ with some such $y$, we may assume that $v$ is differentiable at $x$.
Moreover, we can find $\delta' < \delta$ such that $Lv(x) > M - \delta'$.
\todo{It is impossible to impose $|x - y_h| \ll \diam(T_h)$. However, this is probably OK, because we have freedom to choose a DIFFERENT $x$ at every scale to be close in a scale-invariant sense to a vertex point.}
\todo{Alternatively, we can try to redo this argument using Egorov's theorem again.}

Since $v$ is differentiable at $x$, we can find a principal singular vector $\omega \in \Sph^{m - 1}$ of $\dif v(x)$.
In particular,
$$\lim_{\varepsilon \to 0} \frac{|v(x + \varepsilon \omega) - v(x)|}{\varepsilon} > M - \delta'.$$
\todo{Need to use upper semicontinuity to check that this works! Crandall only gives $|\dif v(x)|_\infty \leq Lv(x)$.}
Let $\ell$ be the line through $\omega$ and let $T_h \in V_m(\tau_h)$ contain $x$.
By the definition of $\tau_h$, we can find edges $[y_h, z_h]$ of $\tau_h$, contained in translates of lines $\ell_h$, such that $\ell_h \to \ell$ and $|x - y_h|/\diam(T_h) \to 0$.
In particular, since $\dist(\ell, \ell_h) \to 0$, if we define $\omega_h$ by 
$$z_h = y_h + |y_h - z_h| \omega_h,$$
then $\omega_h \to \omega$ and
$$|x + |y_h - z_h| \omega - z_h| \leq |x - y_h| + |y_h - z_h| \cdot |\omega - \omega_h| \ll \diam(T_h) (1 + R).$$
Therefore 
\begin{align*}
|v(y_h) - v(z_h)| &\geq |v(x + |y_h - z_h| \omega) - v(x)| - o(|y_h - z_h| \Lip(v)) \\
&\geq (1 - o(1))(M - \delta') |y_h - z_h|
\end{align*}
so 
$$Lv_h(x) \geq (1 - o(1))(M - \delta') > M - \delta$$
if $h$ is small enough.

Since $\{Lu < M - \delta\}$ is open, $\Lip(u, B(x, r)) < M - \delta$ for $0 < r \ll 1$.
So $Lu_h(x) < M - \delta < Lv_h(x)$ if $h$ is small enough.
Therefore
\begin{align*}
\sup_{Lu_h < Lv_h} Lv_h &\geq Lv_h(x) > M - \delta. \qedhere 
\end{align*}
\end{proof}

\begin{claim}
If $h$ is small enough, then 
$$\sup_{Lv_h < Lu_h} Lu_h \leq M - \delta.$$
\end{claim}
\begin{proof}[Proof of claim]
Fix $\theta > 0$. We claim that 
\begin{equation}\label{loss of theta}
\sup_{Lv_h < Lu_h - \theta} Lu_h \leq M - \delta.
\end{equation}
This is enough, since if $Lv_h(x) < Lu_h(x)$ then there exists $\theta > 0$ such that $Lv_h(x) < Lu_h(x) - \theta$.

In order to prove (\ref{loss of theta}), we fix $\varepsilon > 0$, so by Egorov's theorem there exists a set $Z_\varepsilon$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $Lu_n \to Lu$, $Lv_n \to Lv$ uniformly on $U \setminus Z_\varepsilon$.
By appending $\partial U$ to $Z_\varepsilon$ and then using continuity from without of Lebesgue measure, we may assume that $Z_\varepsilon$ is open and contains a collar neighborhood of $\partial U$.
We then claim 
\begin{equation}\label{loss of epsilon}
\sup \{Lu_h(x): (x \notin Z_\varepsilon) \wedge (Lv_h(x) < Lu_h(x) - \theta)\} \leq M - \delta.
\end{equation}
To prove (\ref{loss of epsilon}), we use compactness and contradiction.
If (\ref{loss of epsilon}) is false, then there exist $x_h \notin Z_\varepsilon$ such that $Lv_h \geq Lu_h(x_\delta) - \theta$ and $Lu_h(x_h) > M - \delta$.
By construction of $Z_\varepsilon$, $U \setminus Z_\varepsilon$ is compactly contained in $U$.
So after taking a subsequence, we can find $x \in U \setminus Z_\varepsilon$ with $x_h \to x$.
By the uniform convergence, $Lv(x) \leq Lu(x) - \theta < Lu(x)$ and $Lu(x) > M - \delta$, which contradicts the definition of $\delta$.
So (\ref{loss of epsilon}) holds.

To deduce (\ref{loss of theta}) from (\ref{loss of epsilon}), we first take $\varepsilon \to 0$ to deduce 
$$\esssup_{Lv_h < Lu_h - \theta} Lu_h \leq M - \delta.$$
Let $Z := \bigcap_\varepsilon Z_\varepsilon$ be the exceptional set implicit in this essential supremum.
Let $x \in U$ satisfy $Lv_h(x) < Lu_h(x) - \theta$.
Then there exists $\kappa > 0$ such that
$$Lv_h(x) < Lu_h(x) - \theta - \kappa.$$
Moreover, $V := \{Lv_h < Lu_h(x) - \theta - \kappa\}$ is an open neighborhood of $x$ since $Lv_h$ is upper semicontinuous.
So the set $W := \{Lu_h > Lu_h(x) - \kappa\} \cap V$ has $\vol(W) > 0$ by (\ref{partial lower semicontinuity}).
So $W \setminus Z$ is nonempty and for any $y \in W$,
$$Lv_h(y) < Lu_h(x) - \theta - \kappa < Lu_h(y) - \theta$$
which implies $Lu_h(y) \leq M - \delta$.
Therefore
$$Lu_h(x) \leq M - \delta - \kappa < M - \delta.$$
This proves (\ref{loss of theta}).
\end{proof}

The main claim follows from the two subclaims. \todo{It needs to be checked carefully because this argument seems quite hard...}
\end{proof}

\section{The continuum problem}
\subsection{Existence of tight maps}
\begin{theorem}
Suppose that $U$ has Lipschitz boundary.
For any Lipschitz map $g: \partial U \to \RR^n$, there is a tight map $u: U \to \RR^n$ extending $g$.
\end{theorem}
\begin{proof}
\todo{Here is a sketch.}
By assumption we can approximate $U$ by polytopes and then triangulate $\overline U$.
In particular we may assume that $\partial U$ is triangulated into $m - 1$-faces of the triangulation of $U$.
Let $g_h$ be the discretization of $g$.
By the lexicographic trick \cite[Theorem 1.2]{Sheffield12}, there exists a discrete-tight extension $u_h$ of $g$.
We can get a priori estimates on the Lipschitz constant of a discrete tight map in terms of the Lipschitz constant of its trace.
So $u_h \to u$ in H\"older spaces, where $u|_{\partial U} = g$.
If $v \prec u$, then there exists $h > 0$ such that $v_h \prec u_h$, contradicting that $u_h$ is tight by construction.
So $u$ is tight.
\end{proof}

\begin{conjecture}
If $u_p$ is a sequence of $p$-harmonic maps, then $u_p \to u$ where $u$ is tight.
In particular, if $u$ is $\infty$-harmonic in the variational sense of \cite{daskalopoulos2022} and is smooth and nonholomorphic, then $u$ is $\infty$-harmonic in the classical sense.
\end{conjecture}

\begin{conjecture}
If $u$ is tight then $u_h$ is discrete-tight.
In particular, tight maps are unique.
\end{conjecture}

\begin{conjecture}
Discrete tight maps have a ``discrete geodesic lamination'' in their nonholomorphic stretch set.
This lamination converges to a (continuum) lamination of $U$.
\end{conjecture}

\printbibliography

\end{document}
