\documentclass[reqno,11pt]{amsart}
\usepackage[letterpaper, margin=1in]{geometry}
\RequirePackage{amsmath,amssymb,amsthm,graphicx,mathrsfs,url,slashed,subcaption}
\RequirePackage[usenames,dvipsnames]{xcolor}
\RequirePackage[colorlinks=true,linkcolor=Red,citecolor=Green]{hyperref}
\RequirePackage{amsxtra}
\usepackage{cancel}
\usepackage{tikz, wrapfig}

% Add the 2020 MSC
\makeatletter
\@namedef{subjclassname@2020}{\textup{2020} Mathematics Subject Classification}
\makeatother

%\usepackage[T1]{fontenc}

% \setlength{\textheight}{9.3in} \setlength{\oddsidemargin}{-0.25in}
% \setlength{\evensidemargin}{-0.25in} \setlength{\textwidth}{7in}
% \setlength{\topmargin}{-0.25in} \setlength{\headheight}{0.18in}
% \setlength{\marginparwidth}{1.0in}
% \setlength{\abovedisplayskip}{0.2in}
% \setlength{\belowdisplayskip}{0.2in}
% \setlength{\parskip}{0.05in}
%\renewcommand{\baselinestretch}{1.05}

\title{Discrete tight maps}
\author{}
\address{}
\email{}
\date{\today}
\keywords{}
\subjclass[2020]{primary: }

\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\PP}{\mathbf P}
\newcommand{\MM}{\mathbf M}
\newcommand{\II}{\mathbf I}
\newcommand{\Hyp}{\mathbf H}
\newcommand{\Sph}{\mathbf S}
\newcommand{\Torus}{\mathbf T}
\newcommand{\Group}{\mathbf G}
\newcommand{\GL}{\mathbf{GL}}
\newcommand{\Orth}{\mathbf{O}}
\newcommand{\SpOrth}{\mathbf{SO}}
\newcommand{\Ball}{\mathbf{B}}

\newcommand*\dif{\mathop{}\!\mathrm{d}}

\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\mesh}{mesh}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\tr}{tr}

\newcommand{\Two}{\mathrm{I\!I}}
\newcommand{\weakto}{\rightharpoonup}

\newcommand{\normal}{\mathbf n}
\newcommand{\vol}{\mathrm{vol}}

\newcommand{\diam}{\mathrm{diam}}
\DeclareMathOperator{\sech}{sech}
\newcommand{\inj}{\mathrm{inj}}
\newcommand{\Lip}{\mathrm{Lip}}
\newcommand{\Riem}{\mathrm{Riem}}

\DeclareMathOperator*{\essinf}{ess\,inf}
\DeclareMathOperator*{\esssup}{ess\,sup}

\newcommand{\dfn}[1]{\emph{#1}\index{#1}}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

\newcommand{\loc}{\mathrm{loc}}
\newcommand{\cpt}{\mathrm{cpt}}

\def\Japan#1{\left \langle #1 \right \rangle}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{badtheorem}[theorem]{``Theorem"}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{sublemma}[theorem]{Sublemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{assumption}[theorem]{Assumption}

\newtheorem{mainthm}{Theorem}
\renewcommand{\themainthm}{\Alph{mainthm}}

\newtheorem{claim}{Claim}[theorem]
\renewcommand{\theclaim}{\thetheorem\Alph{claim}}
% \newtheorem*{claim}{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{notation}[theorem]{Notation}

\newtheorem{exercise}[theorem]{Discussion topic}
\newtheorem{homework}[theorem]{Homework}
\newtheorem{problem}[theorem]{Problem}

\makeatletter
\newcommand{\proofpart}[2]{%
  \par
  \addvspace{\medskipamount}%
  \noindent\emph{Part #1: #2.}
}
\makeatother



\numberwithin{equation}{section}


% Mean
\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\usepackage[backend=bibtex,style=alphabetic,giveninits=true]{biblatex}
\renewcommand*{\bibfont}{\normalfont\footnotesize}
\addbibresource{discrete_tight_maps.bib}
\renewbibmacro{in:}{}
\DeclareFieldFormat{pages}{#1}

\newcommand\todo[1]{\textcolor{red}{TODO: #1}}


\begin{document}
\begin{abstract}
    
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}


%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
\subsection{Notation}
\begin{enumerate}
\item $E^\circ$ is interior of a set $E$.
\item For $p \in [1, \infty]$, and a linear map $A$, $|A|_p$ is the $p$th Schatten norm of $A$.
\item For a continuous map $u: U \to \RR^n$ and a set $E \subseteq U$, $\Lip(u, E)$ is the Lipschitz constant of $u|_E$.
\end{enumerate}

%%%%%%%%%%%%%%%%
\subsection{Lipschitz maps}
For a Lipschitz map $u: U \to \RR^n$, let
$$Lu(x) := \inf_{r > 0} \Lip(u, B(x, r)).$$
Then $Lu$ is upper semicontinuous \cite[Lemma 4.2(a)]{Crandall2008}.
Though $Lu$ is not lower semicontinuous, it enjoys the following partial lower semicontinuity property:

\begin{lemma}
Let $x \in U$, let $V \subseteq U$ be an open neighborhood of $x$, and let $\delta > 0$.
Then for any Lipschitz map $u: U \to \RR^n$,
\begin{equation}\label{partial lower semicontinuity}
\vol(V \cap \{Lu > Lu(x) - \delta\}) > 0.
\end{equation}
\end{lemma}
\begin{proof}
\todo{Claimed without proof by \cite[\S1.4]{Sheffield12}.}
\end{proof}

\begin{lemma}\label{Lip is du}
For every Lipschitz map $u: U \to \RR^n$ and almost every $x \in U$,
$$Lu(x) = |\dif u|_\infty(x).$$
\end{lemma}
\begin{proof}
If $u$ is $C^1$, then for any convex open set $V \subseteq U$,
$$\||\dif u|_\infty\|_{C^0(V)} = \Lip(u, V).$$
So by a similar argument to \cite[Lemma 4.2(e)]{Crandall2008}, for any $x \in U$,
$$Lu(x) = \lim_{r \to 0} \||\dif u|_\infty\|_{L^\infty(B(x, r))}.$$
Let $\varepsilon > 0$.
By Lusin's theorem, there is a closed set $Z_\varepsilon \subset U$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $|\dif u|_\infty$ is continuous on $U \setminus Z_\varepsilon$.
So for $x \in U \setminus Z_\varepsilon$,
$$\lim_{r \to 0} \||\dif u|_\infty\|_{L^\infty(B(x, r))} = |\dif u|_\infty(x),$$
hence $Lu(x) = |\dif u|_\infty(x)$.
The claim follows by taking $\varepsilon \to 0$.
\end{proof}

\begin{definition}[{\cite[\S1.3]{Sheffield12}}]
Let $u, v: U \to \RR^n$ be Lipschitz extensions of a Lipschitz map $\partial U \to \RR^n$.
We say that $u$ is \dfn{tighter} than $v$, written $u \prec v$, if 
$$\sup_{Lu > Lv} Lu < \sup_{Lv > Lu} Lv.$$
If there is no tighter $v$ than $u$, we say that $u$ is \dfn{tight}.
% \item We say that $u$ is \dfn{measurably tighter} than $v$, written $u \prec_M v$, if there exists $s > 0$ such that for every $t \geq s$,
% \begin{align*}
% \vol\{Lu \geq s\} &< \vol\{Lv \geq s\}, \\
% \vol\{Lu \geq t\} &\leq \vol\{Lv \geq t\}.
% \end{align*}
% \item If there is no measurably tighter $v$ than $u$, we say that $u$ is \dfn{measurably tight}.
\end{definition}

% \begin{lemma}
% Let $u, v: U \to \RR^n$ be Lipschitz extensions of a Lipschitz map $\partial U \to \RR^n$.
% If $u \prec_M v$ then $u \prec v$.
% \end{lemma}
% \begin{proof}
% Claimed without proof by \cite[\S1.4]{Sheffield12}.
% \end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The discrete problem}
\subsection{Discretization}
We introduce some notation for a finite simplicial complex $\tau$ of dimension $\leq m$.
Let $F_i(\tau)$ be the set of $i$-faces of $\tau$.
The \dfn{mesh size} $\mesh(\tau)$ of $\tau$ is 
$$\mesh(\tau) := \max_{E \in F_1(\tau)} \diam(E).$$
Notice that for any face $F \in F_i(\tau)$ with $i \in \{1, \dots, m\}$, $\diam(F) \leq \mesh(\tau)$.

Now we fix a triangulation $\tau$ of the open polytope $U \subseteq \RR^m$.
For each $h > 0$, define $\tau_h$ to be an iterated barycentric subdivision of $\tau$ such that $\mesh(\tau_h) \leq h$.
We say that $x \in U$ is regular if for every $h > 0$, $x$ is not contained in some face $T \in F_{m - 1}(\tau_h)$.
In particular, almost every point is regular.

For a Lipschitz map $u: U \to \RR^n$ and $h > 0$, define $u_h$ by letting $u_h(x) = u(x)$ whenever $x$ is a vertex of $\tau_h$, and extension so $u_h$ is linear on each simplex of $\tau_h$.
Thus for $i \in \{1, \dots, m\}$, $T \in F_i(\tau_h)$, and $x \in T^\circ$,
\begin{equation}\label{discrete derivative is vertex lip}
|\dif u_h|_\infty(x) = \max_{y, z \in T \cap F_0(\tau_h)} \frac{|u(y) - u(z)|}{|y - z|}.
\end{equation}
In particular,
\begin{equation}\label{discretization contracts lipschitz}
\Lip(u_h, T^\circ) \leq \Lip(u, T).
\end{equation}

\begin{lemma}
For every $x \in U$ and every Lipschitz map $u: U \to \RR^n$,
$$|u_h(x) - u(x)| \leq 2h \Lip(u, B(x, h)).$$
\end{lemma}
\begin{proof}
First suppose that $x$ is a regular point.
Suppose that $T \in F_m(\tau_h)$ contains $x$ and let $y \in T \cap F_0(\tau_h)$.
Then $u_h(y) = u(y)$, so 
$$|u_h(x) - u(x)| \leq |u_h(y) - u_h(x)| + |u(y) - u(x)|.$$
Since $x$ is a regular point and $T$ is convex, the line segment $[x, y)$ is contained in $T^\circ$.
So by continuity of $u$ and $u_h$, and (\ref{discretization contracts lipschitz}),
$$|u_h(y) - u_h(x)| + |u(y) - u(x)| \leq h(\Lip(u_h, T^\circ) + \Lip(u, T^\circ)) \leq 2h \Lip(u, T^\circ).$$
In particular, 
$$|u_h(x) - u(x)| \leq 2h \Lip(u, T^\circ).$$
By continuity of $u_h$ and $u$, this holds for any $x \in T$, not just a regular point.
Moreover, $T^\circ \subseteq B(x, h)$ since $\mesh(\tau_h) \leq h$, so the claim holds.
\end{proof}

\begin{lemma}\label{du converges ae}
For any Lipschitz map $u: U \to \RR^n$, $Lu_h \to Lu$ almost everywhere.
\end{lemma}
\begin{proof}
Let $\varepsilon > 0$.
By Lusin's theorem, there is a closed set $Z_\varepsilon \subset U$ with $\vol(Z_\varepsilon) < \varepsilon$ such that $|\dif u|_\infty$ is continuous away from $Z_\varepsilon$.
We shall show that $|\dif u_h|_\infty(x) \to |\dif u|_\infty(x)$ for every regular point $x$ of $U \setminus Z_\varepsilon$.
Taking $\varepsilon \to 0$ and applying Lemma \ref{Lip is du}, this implies the claim.

For each $h > 0$, let $T_h \in F_m(\tau_h)$ contain $x$.
Since $x$ is a regular point, $x \in T_h^\circ$, so by (\ref{discrete derivative is vertex lip}) we can find $y_h, z_h \in T_h \cap F_0(\tau_h)$ and a point $w_h$ on the edge $[y_h, z_h]$ such that
$$|\dif u_h|_\infty(x) = \frac{|u(y_h) - u(z_h)|}{|y_h - z_h|} = |\dif u|_\infty(w_h).$$
If $h$ is small enough depending on $x$, then $T_h$ is contained in the open set $U \setminus Z_\varepsilon$, so 
\begin{align*}
\lim_{h \to 0} |\dif u_h|_\infty(x) = \lim_{h \to 0} |\dif u|_\infty(w_h) &= |\dif u|_\infty(x). \qedhere
\end{align*}
\end{proof}

The proof of Lemma \ref{du converges ae} fails for discretizations that are not simplicial complexes.
This is because it is false that $[y_h, z_h]$ is an edge in that case.

%%%%%%%%%%%%%%%%%%%
\subsection{From discrete to continuum tight maps}
\begin{proposition}
Assume that $u \prec v$.
Then for every sufficiently small $h$, $u_h \prec v_h$.
\end{proposition}
\begin{proof}
Let 
$$M := \sup_{Lu < Lv} Lv$$
Since $u \prec v$, there exists $\delta > 0$ such that
$$\sup_{Lv < Lu} Lu(x) < M - \delta.$$
The proof now follows from the two below claims which we prove in turn.

\begin{claim}
If $\delta, h$ are small enough, then 
$$\sup_{Lu_h < Lv_h} Lv_h > M - \delta.$$
\end{claim}

By definition of $M$, if $\delta$ is taken small enough, then there exists $x \in U$ such that
$$Lu(x) < M - \delta < Lv(x).$$
By (\ref{partial lower semicontinuity}), and the fact that $\{Lu < M - \delta\}$ is open, it follows that the set
$$E := \{y \in U: (Lv(y) > M - \delta) \wedge (Lu(y) < M - \delta)\}$$
satisfies $\vol(E) > 0$.
By Lemma \ref{du converges ae}, we can find $y \in E$ such that $Lv_h(y) \to Lv(y)$ and $Lu_h(y) \to Lu(y)$.
Therefore for $h$ small enough,
$$Lu_h(y) < M - \delta < Lv_h(y).$$
In particular, $Lv_h(y) > Lu_h(y)$, so 
$$\sup_{Lu_h < Lv_h} Lv_h \geq Lv_h(y) > M - \delta.$$

\begin{claim}
If $h$ is small enough, then 
$$\sup_{Lv_h < Lu_h} Lu_h \leq M - \delta.$$
\end{claim}
Fix $\theta > 0$. We claim that 
\begin{equation}\label{loss of theta}
\sup_{Lv_h < Lu_h - \theta} Lu_h \leq M - \delta.
\end{equation}
This is enough, since if $Lv_h(x) < Lu_h(x)$ then there exists $\theta > 0$ such that $Lv_h(x) < Lu_h(x) - \theta$.

In order to prove (\ref{loss of theta}), we fix $\varepsilon > 0$, so by Egorov's theorem and Lemma \ref{du converges ae}, there exists a set $Z_\varepsilon$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $Lu_n \to Lu$, $Lv_n \to Lv$ uniformly on $U \setminus Z_\varepsilon$.
By appending $\partial U$ to $Z_\varepsilon$ and then using continuity from without of Lebesgue measure, we may assume that $Z_\varepsilon$ is open and contains a collar neighborhood of $\partial U$.
We then claim 
\begin{equation}\label{loss of epsilon}
\sup \{Lu_h(x): (x \notin Z_\varepsilon) \wedge (Lv_h(x) < Lu_h(x) - \theta)\} \leq M - \delta.
\end{equation}
To prove (\ref{loss of epsilon}), we use compactness and contradiction.
If (\ref{loss of epsilon}) is false, then there exist $x_h \notin Z_\varepsilon$ such that $Lv_h \geq Lu_h(x_\delta) - \theta$ and $Lu_h(x_h) > M - \delta$.
By construction of $Z_\varepsilon$, $U \setminus Z_\varepsilon$ is compactly contained in $U$.
So after taking a subsequence, we can find $x \in U \setminus Z_\varepsilon$ with $x_h \to x$.
By the uniform convergence, $Lv(x) \leq Lu(x) - \theta < Lu(x)$ and $Lu(x) > M - \delta$, which contradicts the definition of $\delta$.
So (\ref{loss of epsilon}) holds.

To deduce (\ref{loss of theta}) from (\ref{loss of epsilon}), we first take $\varepsilon \to 0$ to deduce 
$$\esssup_{Lv_h < Lu_h - \theta} Lu_h \leq M - \delta.$$
Let $Z := \bigcap_\varepsilon Z_\varepsilon$ be the exceptional set implicit in this essential supremum.
Let $x \in U$ satisfy $Lv_h(x) < Lu_h(x) - \theta$.
Then there exists $\kappa > 0$ such that
$$Lv_h(x) < Lu_h(x) - \theta - \kappa.$$
Moreover, $V := \{Lv_h < Lu_h(x) - \theta - \kappa\}$ is an open neighborhood of $x$ since $Lv_h$ is upper semicontinuous.
So the set $W := \{Lu_h > Lu_h(x) - \kappa\} \cap V$ has $\vol(W) > 0$ by (\ref{partial lower semicontinuity}).
So $W \setminus Z$ is nonempty and for any $y \in W$,
$$Lv_h(y) < Lu_h(x) - \theta - \kappa < Lu_h(y) - \theta$$
which implies $Lu_h(y) \leq M - \delta$.
Therefore
$$Lu_h(x) \leq M - \delta - \kappa < M - \delta.$$
This proves (\ref{loss of theta}).
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The continuum problem}
\subsection{Existence of tight maps}
\begin{theorem}
Suppose that $U$ has Lipschitz boundary.
For any Lipschitz map $g: \partial U \to \RR^n$, there is a tight map $u: U \to \RR^n$ extending $g$.
\end{theorem}
\begin{proof}
\todo{Here is a sketch.}
By assumption we can approximate $U$ by polytopes and then triangulate $\overline U$.
In particular we may assume that $\partial U$ is triangulated into $m - 1$-faces of the triangulation of $U$.
Let $g_h$ be the discretization of $g$.
By the lexicographic trick \cite[Theorem 1.2]{Sheffield12}, there exists a discrete-tight extension $u_h$ of $g$.
We can get a priori estimates on the Lipschitz constant of a discrete tight map in terms of the Lipschitz constant of its trace.
So $u_h \to u$ in H\"older spaces, where $u|_{\partial U} = g$.
If $v \prec u$, then there exists $h > 0$ such that $v_h \prec u_h$, contradicting that $u_h$ is tight by construction.
So $u$ is tight.
\end{proof}

\begin{conjecture}
If $u_p$ is a sequence of $p$-harmonic maps, then $u_p \to u$ where $u$ is tight.
In particular, if $u$ is $\infty$-harmonic in the variational sense of \cite{daskalopoulos2022} and is smooth and nonholomorphic, then $u$ is $\infty$-harmonic in the classical sense.
\end{conjecture}

\begin{conjecture}
If $u$ is tight then $u_h$ is discrete-tight.
In particular, tight maps are unique.
\end{conjecture}

\begin{conjecture}
Discrete tight maps have a ``discrete geodesic lamination'' in their nonholomorphic stretch set.
This lamination converges to a (continuum) lamination of $U$.
\end{conjecture}

\printbibliography

\end{document}
