\documentclass[reqno,11pt]{amsart}
\usepackage[letterpaper, margin=1in]{geometry}
\RequirePackage{amsmath,amssymb,amsthm,graphicx,mathrsfs,url,slashed,subcaption}
\RequirePackage[usenames,dvipsnames]{xcolor}
\RequirePackage[colorlinks=true,linkcolor=Red,citecolor=Green]{hyperref}
\RequirePackage{amsxtra}
\usepackage{cancel, longtable}
\usepackage{tikz, wrapfig}

% Add the 2020 MSC
\makeatletter
\@namedef{subjclassname@2020}{\textup{2020} Mathematics Subject Classification}
\makeatother

%\usepackage[T1]{fontenc}

% \setlength{\textheight}{9.3in} \setlength{\oddsidemargin}{-0.25in}
% \setlength{\evensidemargin}{-0.25in} \setlength{\textwidth}{7in}
% \setlength{\topmargin}{-0.25in} \setlength{\headheight}{0.18in}
% \setlength{\marginparwidth}{1.0in}
% \setlength{\abovedisplayskip}{0.2in}
% \setlength{\belowdisplayskip}{0.2in}
% \setlength{\parskip}{0.05in}
%\renewcommand{\baselinestretch}{1.05}

\title{Discrete tight maps}
\author{}
\address{}
\email{}
\date{\today}
\keywords{}
\subjclass[2020]{primary: }

\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\PP}{\mathbf P}
\newcommand{\MM}{\mathbf M}
\newcommand{\II}{\mathbf I}
\newcommand{\Hyp}{\mathbf H}
\newcommand{\Sph}{\mathbf S}
\newcommand{\Torus}{\mathbf T}
\newcommand{\Group}{\mathbf G}
\newcommand{\GL}{\mathbf{GL}}
\newcommand{\Orth}{\mathbf{O}}
\newcommand{\SpOrth}{\mathbf{SO}}
\newcommand{\Ball}{\mathbf{B}}

\newcommand*\dif{\mathop{}\!\mathrm{d}}

\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\mesh}{mesh}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\tr}{tr}

\newcommand{\Two}{\mathrm{I\!I}}
\newcommand{\weakto}{\rightharpoonup}

\newcommand{\normal}{\mathbf n}
\newcommand{\vol}{\mathrm{vol}}

\newcommand{\diam}{\mathrm{diam}}
\DeclareMathOperator{\sech}{sech}
\newcommand{\inj}{\mathrm{inj}}
\newcommand{\Lip}{\mathrm{Lip}}
\newcommand{\Riem}{\mathrm{Riem}}

\DeclareMathOperator*{\essinf}{ess\,inf}
\DeclareMathOperator*{\esssup}{ess\,sup}

\newcommand{\dfn}[1]{\emph{#1}\index{#1}}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

\newcommand{\loc}{\mathrm{loc}}
\newcommand{\cpt}{\mathrm{cpt}}

\def\Japan#1{\left \langle #1 \right \rangle}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{badtheorem}[theorem]{``Theorem"}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{sublemma}[theorem]{Sublemma}
\newtheorem{invariant}[theorem]{Invariant}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{assumption}[theorem]{Assumption}

\newtheorem{mainthm}{Theorem}
\renewcommand{\themainthm}{\Alph{mainthm}}

\newtheorem{claim}{Claim}[theorem]
\renewcommand{\theclaim}{\thetheorem\Alph{claim}}
% \newtheorem*{claim}{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{notation}[theorem]{Notation}

\newtheorem{exercise}[theorem]{Discussion topic}
\newtheorem{homework}[theorem]{Homework}
\newtheorem{problem}[theorem]{Problem}

\makeatletter
\newcommand{\proofpart}[2]{%
  \par
  \addvspace{\medskipamount}%
  \noindent\emph{Part #1: #2.}
}
\makeatother



\numberwithin{equation}{section}


% Mean
\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$ }
\vcenter{\hbox{$#2#3$ }}\kern-.6\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

\usepackage[backend=bibtex,style=alphabetic,giveninits=true]{biblatex}
\renewcommand*{\bibfont}{\normalfont\footnotesize}
\addbibresource{discrete_tight_maps.bib}
\renewbibmacro{in:}{}
\DeclareFieldFormat{pages}{#1}

\newcommand\todo[1]{\textcolor{red}{TODO: #1}}


\begin{document}
\begin{abstract}
    
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Let $U \subseteq \RR^m$ be an open polytope.

\begin{definition}\label{local Lipschitz constant}
For a Lipschitz map $u: U \to \RR^n$, define the \dfn{local Lipschitz constant}
$$Lu(x) := \inf_{r > 0} \Lip(u, B(x, r)).$$
\end{definition}

\begin{definition}[{\cite[\S1.3]{Sheffield12}}]\label{tighter}
Let $u, v: U \to \RR^n$ be Lipschitz maps such that $u|_{\partial U} = v|_{\partial U}$.
We say that $u$ is \dfn{tighter} than $v$, written $u \prec v$, if 
$$\sup_{Lu > Lv} Lu < \sup_{Lv > Lu} Lv.$$
If there is no tighter $v$ than $u$, we say that $u$ is \dfn{tight}.
\end{definition}

\begin{theorem}
Every Lipschitz map $f: \partial U \to \RR^n$ has a tight extension $u: U \to \RR^n$.
\end{theorem}

Showing that the finite element approximations converge is hard, because the local Lipschitz constant of the approximation is piecewise constant, and we do not have any a priori estimates on the $W^{s, p}$ norms of the exact solution when $s > 1$.
Therefore we do not expect the approximate local Lipschitz constants to converge in any stronger sense than pointwise convergence almost everywhere.
This difficulty is already implicit in the numerical analysis literature concerning the scalar $\infty$-Laplacian.
Even though finite element approximations to $\infty$-harmonic functions $u$ are available \cite{Loisel_2020}, we are not aware of any estimates on the approximation error for $\dif u$ as in the case of $p$-harmonic functions, $p < \infty$ \cite{Barrett93}.

%%%%%%%%%%%%%%%%%%
\subsection{Acknowlegments}
I would like to thank Georgios Daskalopolous, Brian Freidin, and Nate River for various helpful discussions.

This research was supported by the National Science Foundation's Graduate Research Fellowship Program under Grant No. DGE-2040433.

%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
\subsection{Notation}
Here is a brief summary of the notation used throughout this paper.

\begin{longtable}{@{\extracolsep{\fill}}lp{0.75\textwidth}}
\multicolumn{2}{c}{\textbf{General notation}}\\[4pt]
$E^\circ$ & interior of the set $E$ \\
$\overline E$ & closure of the set $E$ \\
$\vol(E)$ & Lebesgue measure of the Lebesgue measurable set $E$ \\
$\dashint_E u$ & $\vol(E)^{-1} \int_E u$ \\
$|A|_p$ & $p$th Schatten norm of the matrix $A$ ($p \in [1, \infty]$) \\
\\
\multicolumn{2}{c}{\textbf{Lipschitz maps}}\\[4pt]
$\Lip(u, E)$ & Lipschitz constant of $u|_E$\\
$Lu(x)$ & local Lipschitz constant of $u$ at $x$ (Definition \ref{local Lipschitz constant})\\
$u \prec v$ & $u$ is tighter than $v$ (Definition \ref{tighter})\\
\\
\multicolumn{2}{c}{\textbf{Simplicial complexes}}\\[4pt]
$F_i(\tau)$ & set of $i$-dimensional faces of the simplicial complex $\tau$\\
$\Pi_h u$ & unique $h$-shape map which agrees with $u$ on vertices (Definition \ref{shape map})
\end{longtable}

%%%%%%%%%%%%%%%%
\subsection{Measure theory}
\begin{proposition}[one-sided Egorov theorem]\label{one sided Egorov}
Let $X$ be a Polish space, $\mu$ a finite Borel measure on $X$, and $f_n, f$ $\mu$-measurable functions on $X$, such that for $\mu$-almost every $x \in X$,
$$f(x) \leq \liminf_{n \to \infty} f_n(x).$$
Then for every $\varepsilon > 0$ there exists a $\mu$-measurable set $Z_\varepsilon \subseteq X$ such that:
\begin{enumerate}
\item $\mu(Z_\varepsilon) < \varepsilon$.
\item For every $\delta > 0$ there exists $N \in \NN$ such that for every $n \geq N$ and every $x \in X \setminus Z_\varepsilon$,
$$f(x) < f_n(x) + \delta.$$
\end{enumerate}
\end{proposition}
\begin{proof}
Let 
$$E_{n, k} := \bigcup_{m \geq n} \left\{x \in X: f(x) \geq f_m(x) + \frac{1}{k}\right\}.$$
Then for $m \geq n$, $E_{m, k} \subseteq E_{n, k}$; since $f_n \to f$ $\mu$-almost everywhere, it follows that for every $k$, $\bigcap_n E_{n, k}$ is $\mu$-null.
By continuity from above of $\mu$, for every $k$, there exists $n(k)$ such that $\mu(E_{n(k), k}) < \varepsilon/2^k$.
We set $Z_\varepsilon := \bigcup_k E_{n(k), k}$, so $\mu(Z_\varepsilon) < \varepsilon$.
For each $\delta > 0$, if $k \geq \delta^{-1}$, then for
$$x \in X \setminus E_{n(k), k} \subseteq X \setminus Z_\varepsilon,$$
and $n \geq n(k)$, $f(x) < f_n(x) + \delta$.
\end{proof}

\begin{lemma}[lower semicontinuity of vectorial total variation]\label{TV lower semicontinuity}
Let $|\cdot|_M$ be a norm on $n \times m$-matrices, let $u_n, u \in BV(U, \RR^n)$, and suppose that $u_n \to u$ in $L^1$.
Then for any open $V \subseteq U$,
$$\int_V |\dif u|_M(x) \dif x \leq \liminf_{n \to \infty} \int_V |\dif u_n|_M(x) \dif x.$$
\end{lemma}
\begin{proof}
Let $|\cdot|_M'$ be the dual norm to $|\cdot|_M$.
Let
$$\mathscr D := \{X \in C^1_\cpt(U, \RR^{n \times m}): \||X|_M'\|_{C^0} \leq 1\}.$$
Integrating by parts, for any $v \in BV(U, \RR^n)$, 
$$\int_V |\dif v|_M(x) \dif x = \sup_{X \in \mathscr D} \int_V \langle \dif v, X\rangle(x) \dif x = \sup_{X \in \mathscr D} \int_V \langle v, \nabla \cdot X\rangle(x) \dif x.$$
The result follows when we use the $L^1$ convergence to bound
\begin{align*}
\sup_{X \in \mathscr D} \int_V \langle u, \nabla \cdot X\rangle(x) \dif x 
&\leq \liminf_{n \to \infty} \sup_{X \in \mathscr D} \int_V \langle u_n, \nabla \cdot X\rangle(x) \dif x. \qedhere
\end{align*}
\end{proof}

%%%%%%%%%%%%%%%%
\subsection{Lipschitz maps}
Let $u: U \to \RR^n$ be a Lipschitz map.
Its local Lipschitz constant $Lu$ is upper semicontinuous \cite[Lemma 4.2(a)]{Crandall2008}.
Though $Lu$ is not lower semicontinuous, it is ``lower semicontinuous on average"; this was claimed without proof by Sheffield and Smart \cite[\S1.4]{Sheffield12}.

\begin{lemma}[lower semicontinuity on average of $Lu$]\label{partial lower semicontinuity}
Let $x \in U$, let $V \subseteq U$ be an open neighborhood of $x$, and let $\delta > 0$.
Then for any Lipschitz map $u: U \to \RR^n$,
$$\vol(V \cap \{Lu > Lu(x) - \delta\}) > 0.$$
\end{lemma}
\begin{proof}
It suffices to show the contrapositive: if, for almost every $y \in V$, $Lu(y) \leq K$, then $Lu(x) \leq K$ as well.
Furthermore, by shrinking $V$ to be a ball if necessary, we may assume that $V$ is convex.
Let $\Delta_V$ be the diagonal of $V^2$. Then
$$Lu(x) \leq \Lip(u, V) \leq \sup_{(y, z) \in V^2 \setminus \Delta_V} \frac{|u(y) - u(z)|}{|y - z|}.$$
Since the difference quotient $f(y, z) := |u(y) - u(z)|/|y - z|$ is continuous on $V^2 \setminus \Delta_V$, this expression is the $L^\infty$ norm of $f$.
Moreover, $\Delta_V$ is a null subset of $V^2$, so
$$\|f\|_{L^\infty(V^2 \setminus \Delta_V)} = \lim_{p \to \infty} \left[\int_V \int_V \frac{|u(y) - u(z)|^p}{|y - z|^p} \dif y \dif z\right]^{1/p}.$$
We estimate this integral using the mean value and Jensen inequalities:
\begin{align*} 
\int_V \int_V \frac{|u(y) - u(z)|^p}{|y - z|^p} \dif y \dif z 
&\leq \int_V \int_V \frac{1}{|y - z|^p} \left[\int_{[y, z]} Lu(w) \dif w\right]^p \dif y \dif z \\
&\leq \int_V \int_V \frac{1}{|y - z|} \int_{[y, z]} Lu(w)^p \dif w \dif y \dif z. 
\end{align*}
Let $E(y, w)$ be the set of points in $V$ on the line $\ell$ through $y, w$ which are to the right of $w$, where $\ell$ is oriented so that the vector $w - y$ points to the right.
Then $w \in [y, z]$ iff $z \in E(y, w)$, so we can rewrite the bounds of integration using Fubini's theorem as follows:
$$\int_V \int_V \frac{1}{|y - z|} \int_{[y, z]} Lu(w)^p \dif w \dif y \dif z = \int_V \int_V \int_{E(y, w)} Lu(w)^p \frac{\dif z}{|y - z|} \dif y \dif w.$$
The point is that $w$ now ranges over $V$, and we know that for almost every $w \in V$, $Lu(w) \leq K$.
We therefore can estimate this integral, and undo the change in the order of integration, as follows:
\begin{align*} 
\int_V \int_V \int_{E(y, w)} Lu(w)^p \frac{\dif z}{|y - z|} \dif y \dif w
&\leq K^p \int_V \int_V \int_{E(y, w)} \frac{\dif z}{|y - z|} \dif y \dif w \\
&= K^p \int_V \int_V \int_{[y, z]} \frac{\dif w}{|y - z|} \dif y \dif z \\
&= K^p \vol(V)^2.
\end{align*}
Therefore 
\begin{align*}
Lu(x) &\leq \|f\|_{L^\infty(V^2 \setminus \Delta_V)} \leq K \lim_{p \to \infty} \vol(V)^{2/p} = K. \qedhere 
\end{align*}  
\end{proof}

\begin{lemma}
For every Lipschitz map $u: U \to \RR^n$:
\begin{enumerate}
\item For every compact convex set $K \Subset U$,
\begin{equation}\label{Lip is sup of local Lips}
\Lip(u, K) = \max_{x \in K} Lu(x).
\end{equation}
\item For every open convex set $V \subseteq U$,
\begin{equation}\label{mean value estimate}
\Lip(u, V) = \||\dif u|_\infty\|_{L^\infty(V)}.
\end{equation}
\item For every $x \in U$,
\begin{equation}\label{localized mean value estimate}
Lu(x) = \lim_{r \to 0} \||\dif u|_\infty\|_{L^\infty(B(x, r))}.
\end{equation}
\end{enumerate}
\end{lemma}
\begin{proof}
This is essentially the content of \cite[Lemma 4.2]{Crandall2008} when $n = 1$.
The only meaningful difference when $n \geq 2$ is that we have to worry about which matrix norm is applied to $\dif u$, but of course we know the correct norm to use is $|\cdot|_\infty$.
\end{proof}

\begin{lemma}\label{Lip is du}
For every Lipschitz map $u: U \to \RR^n$ and almost every $x \in U$,
$$Lu(x) = |\dif u|_\infty(x).$$
\end{lemma}
\begin{proof}
Let $\varepsilon > 0$.
By Lusin's theorem, there is a closed set $Z_\varepsilon \subset U$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $|\dif u|_\infty$ is continuous on $U \setminus Z_\varepsilon$.
Applying (\ref{localized mean value estimate}) and $x \in U \setminus Z_\varepsilon$,
$$\lim_{r \to 0} \||\dif u|_\infty\|_{L^\infty(B(x, r))} = |\dif u|_\infty(x),$$
hence $Lu(x) = |\dif u|_\infty(x)$.
The claim follows by taking $\varepsilon \to 0$.
\end{proof}

\begin{lemma}[lower semicontinuity of $L$]\label{Lip is lower semicontinuous}
Suppose that $u_k, u: U \to \RR$ are maps with $u_k \to u$ in $L^1$ and $\Lip(u_k, U) \leq K < \infty$.
Then for almost every $x \in U$,
$$Lu(x) \leq \liminf_{k \to \infty} Lu_k(x).$$
\end{lemma}
\begin{proof} 
We first use the Lebesgue differentiation theorem to write, for almost every $x \in U$,
$$Lu(x) = \lim_{r \to 0} \dashint_{B(x, r)} Lu(y) \dif y.$$
By Lemmata \ref{Lip is du} and \ref{TV lower semicontinuity},
\begin{align*}
\dashint_{B(x, r)} Lu(y) \dif y 
&= \dashint_{B(x, r)} |\dif u|_\infty(y) \dif y 
\leq \liminf_{k \to \infty} \dashint_{B(x, r)} |\dif u_k|_\infty(y) \dif y \\
&= \liminf_{k \to \infty} \dashint_{B(x, r)} Lu_k(y) \dif y.
\end{align*}
Because $Lu_k(y) \leq \Lip(u_k, U) \leq K$, we can apply dominated convergence:
$$\liminf_{k \to \infty} \dashint_{B(x, r)} Lu_k(y) \dif y = \dashint_{B(x, r)} \liminf_{k \to \infty} Lu_k(y) \dif y.$$
The result follows when we take $r \to 0$ and apply the Lebesgue differentiation theorem.
\end{proof}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Tight maps from graphs}
% Let $G = (X, E)$ be a weighted, undirected, finite graph, and fix a distinguished set of vertices $Y \subset X$, which we call the \dfn{boundary} of $G$.
% We write $x \sim y$ to mean that $(x, y) \in E$.
% The \dfn{length} $\len(\gamma)$ of a walk $\gamma$ in $G$ is the sum of the weights of the edges in $\gamma$.
% Given vertices $x, y \in X$, we call a walk from $x$ to $y$ a \dfn{geodesic} if its length is minimized among all such walks.
% Since $G$ is finite, between any two vertices there is a geodesic.
% If $\gamma$ is a geodesic from $x$ to $y$, we define the \dfn{distance} $\dist(x, y) := \len(\gamma)$.
% In particular, if $x \sim y$, then $\dist(x, y)$ is the weight of the edge $(x, y)$.

% \begin{definition}
% Let $u: X \to \RR^n$. The \dfn{local Lipschitz constant} of $u$ at $x \in X$ is 
% $$Su(x) := \max_{y \sim x} \frac{|u(x) - u(y)|}{\dist(x, y)}.$$
% \end{definition}

% \begin{definition}[{\cite[\S1.2]{Sheffield12}}]
% Let $u: X \to \RR^n$.
% \begin{enumerate}
% \item Let $v: X \to \RR^n$ satisfy $v|_Y = u|_Y$. We say that $u$ is \dfn{tighter} than $v$, or write $u \prec v$, if 
% $$\max_{Su > Sv} Su < \max_{Sv > Su} Sv.$$
% \item We say that $u$ is \dfn{tight} if for every $v: X \to \RR^n$ such that $v|_Y = u|_Y$, $v$ is not tighter than $u$.
% \item We say that $u$ is \dfn{$\infty$-harmonic} at $x \in X \setminus Y$ if there does not exist $v: X \to \RR^n$ such that $Sv(x) < Su(x)$, but for $y \neq x$, $v(y) = u(y)$.
% \item We say that $u$ is \dfn{$\infty$-harmonic}, if for every $x \in X \setminus Y$, $u$ is $\infty$-harmonic at $x$.
% \end{enumerate}
% \end{definition}

% \begin{lemma}
% Every tight map is $\infty$-harmonic.
% \end{lemma}
% \begin{proof}
% We prove the contrapositive.
% Suppose that $u$ is not $\infty$-harmonic at $x \in X \setminus Y$, so there exists $v$ such that $Sv(x) < Su(x)$, but for $y \neq x$, $v(y) = u(y)$.
% In particular, $Sv(y) > Su(y)$ implies that $y \sim x$, and 
% $$Sv(y) = \frac{|v(y) - v(x)|}{\dist(y, x)} \leq Sv(x) < Su(x) \leq \max_{Su > Sv} Su.$$
% Taking the maximum over all such $y$, we see that $v \prec u$.
% \end{proof}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Maximally stretched paths}
% \begin{definition}
% Let $u: X \to \RR^n$, and let $T := \max_{x \in X} Su(x)$.
% Let $\gamma := (x_0, \dots, x_{k + 1})$ be a path in $G$, such that for $i \in \{1, \dots, k\}$, $x_i \in X \setminus Y$. 
% We say that $\gamma$ is \dfn{maximally stretched} by $u$ if:
% \begin{enumerate}
% \item For every $i \in \{1, \dots, k\}$, $x_i \in X \setminus Y$ and $Su(x_i) = T$.
% \item $x_0, x_{k + 1} \in Y$.
% \item There exists $\xi \in \RR^n \setminus \{0\}$ such that $|\xi| = T$ and for every $i \in \{1, \dots, k\}$,
% $$\frac{u(x_i) - u(x_{i - 1})}{\dist(x_i, x_{i - 1})} = \frac{u(x_{i + 1}) - u(x_i)}{\dist(x_{i + 1}, x_i)} = \xi.$$
% \end{enumerate}
% We call $\xi$ the \dfn{step} of $\gamma$.
% \end{definition}

% \begin{definition}
% A map $u: X \to \RR^n$ is \dfn{principally nonconformal} if for every $x \in X$ such that $Su(x) \neq 0$, there does not exist $y_1, y_2, y_3 \sim x$ distinct such that
% $$Su(x) = \frac{|u(x) - u(y_1)|}{\dist(x, y_1)} = \frac{|u(x) - u(y_2)|}{\dist(x, y_2)} = \frac{|u(x) - u(y_3)|}{\dist(x, y_3)}.$$
% \end{definition}

% \begin{lemma}\label{dynamic programming principle}
% Let $u: X \to \RR^n$ be a principally nonconformal map which is $\infty$-harmonic at $x \in X \setminus Y$.
% Then there exist unique $y, z \sim x$ distinct such that 
% \begin{align}
% Su(x) &= \frac{|u(y) - u(x)|}{\dist(y, x)} \label{nonconformal means two edges 1}, \\
% u(x) &= \frac{\dist(y, x)}{\dist(y, x) + \dist(z, x)} u(y) + \frac{\dist(z, x)}{\dist(y, x) + \dist(z, x)} u(z) \label{nonconformal means two edges 2}.
% \end{align}
% \end{lemma}
% \begin{proof}
% We prove the contrapositive.
% Let $u$ be principally nonconformal, and let $y \sim x$ satisfy (\ref{nonconformal means two edges 1}).
% Suppose that there does not exist $z \sim x$ satisfying (\ref{nonconformal means two edges 2}).
% Choose $z \sim x$, distinct from $y$, which maximizes $\sigma := |u(z) - u(x)|/\dist(z, x)$.
% For $w \neq x$, let $v(w) := u(w)$.

% If $\sigma < Su(x)$, then let $v(x)$ be a point on the open line segment $(u(y), u(x))$ which is sufficiently close to $u(x)$, so that $y$ is the unique vertex adjacent to $x$ which maximizes $|v(\cdot) - v(x)|/\dist(\cdot, x)$.

% If $\sigma = Su(x)$, then since $u$ is principally nonconformal, $z$ is the unique vertex adjacent to $x$ and distinct from $y$ such that $|u(z) - u(x)| = Su(x) \dist(z, x)$.
% In that case, let $\eta$ be the right-hand side of (\ref{nonconformal means two edges 2}), and let $v(x)$ be a point on $(\eta, u(x))$ which is sufficiently close to $u(x)$, so that the only vertices which can maximize $|v(\cdot) - v(x)|/\dist(\cdot, x)$ are $y, z$.
% Suppose without loss of generality that this ratio is maximized by $y$.

% In either case, 
% $$Sv(x) = \frac{|v(y) - v(x)|}{\dist(y, x)} = \frac{|u(y) - v(x)|}{\dist(y, x)} < \frac{|u(y) - u(x)|}{\dist(y, x)} = Su(x),$$
% so $u$ is not $\infty$-harmonic at $x$.
% \end{proof}

% \begin{example}
% Let $G = K_{1, 3}$ with unit length edges.
% For the vertex $x$ of degree $3$, let $u(x) = 0 \in \RR^3$.
% For the other three vertices $y_1, y_2, y_3$ of degree $1$, let $u(y_i) = e_i$ be the unit vectors.
% Then $u$ is $\infty$-harmonic at $x$ but not principally nonconformal.
% In particular, $u(x)$ is not the average of $u(y_i), u(y_j)$ for any $i, j$.
% \end{example}

% \todo{Does Lemma \ref{dynamic programming principle} imply that there exists a version of Tug of War (or rather Politics) for $\infty$-harmonic maps which are principally nonconformal?}

% \begin{lemma}
% Let $u: X \to \RR^n$, and let $\gamma$ be a $u$-maximally stretched path.
% Then $\gamma$ is a geodesic.
% \end{lemma}
% \begin{proof}
% \todo{Lip is the sup of local Lips ($G$ is a length space)}

% Write $\gamma = (x_0, \dots, x_{k + 1})$, and let $\xi$ be the step of $\gamma$.
% Then
% $$u(x_{k + 1}) - u(x_0) = \sum_{i=0}^k \dist(x_{i + 1}, x_i) \xi = \len(\gamma) \xi.$$
% Since $\len(\gamma) \geq \dist(x_0, x_{k + 1})$, we have 
% $$|u(x_{k + 1}) - u(x_0)| \leq \dist(x_0, x_{k + 1}) |\xi| \leq \len(\gamma) \xi = |u(x_{k + 1} - u(x_0))|.$$
% These inequalities collapse and force $\dist(x_0, x_{k + 1}) = \len(\gamma)$.
% \end{proof}

% \begin{proposition}
% Let $u: X \to \RR^n$ be $\infty$-harmonic and principally nonconformal, and $x \in X \setminus Y$ satisfy
% $$Su(x) = \max_{y \in X} Su(y) > 0.$$
% Then $x$ is contained in a unique $u$-maximally stretched geodesic.
% \end{proposition}
% \begin{proof}
% Let $x_0 := x$ and $T := \max_{y \in X} Su(y)$.
% By Lemma \ref{dynamic programming principle}, there exists $\xi_0 \in \RR^n \setminus \{0\}$ and $x_{-1}, x_1 \sim x_0$ distinct such that $|\xi_0| = T$ and 
% \begin{align*}
% u(x_1) &= u(x_0) + \xi_0 \dist(x_1, x_0) \\  
% u(x_{-1}) &= u(x_0) - \xi_0 \dist(x_{-1}, x_0).
% \end{align*}
% Thus, for $i \in \{-1, 1\}$, $Su(x_i) \geq Su(x_0) = T$, but since $Su(x_i) \leq T$ it follows that $Su(x_i) = T$.
% Thus we can iteratively apply Lemma \ref{dynamic programming principle} to obtain $x_i, \xi_i$ with the same properties whenever $i \in \ZZ$ and $x_i \in X \setminus Y$.
% Induction implies that $\xi_i = \xi_0$ for every $i$; let $\xi := \xi_0$.

% The uniqueness conclusion of Lemma \ref{dynamic programming principle} implies that the walk $\gamma = (\dots, x_{-1}, x_0, x_1, \dots)$ does not self-intersect, except at a periodic point.
% But $\gamma$ does not have a periodic point.
% If it does, say $x_i = x_{i + k}$, then we have
% $$u(x_{i + k}) = u(x_i) + \xi \sum_{j=1}^k \dist(x_{j - 1}, x_j).$$
% Since $\xi$ is nonzero, it follows that $u(x_{i + k}) \neq u(x_i)$.

% The above construction can only halt at a boundary vertex, and by the pigeonhole principle and the nonperiodicity of $\gamma$, it must halt at a boundary vertex after a finite number of steps in both directions.
% \end{proof}

% \todo{Clean up the above argument}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Eikonal Kirszbraun-Valentine theorem}
\begin{proposition}\label{eikonal extension}
Let $V \Subset \RR^k$ be a bounded convex open set.
For every Lipschitz map $f: \partial V \to \RR^n$, there exists an extension $u: V \to \RR^n$ of $f$, such that for every $x \in V$,
$$Lu(x) = \Lip(f, \partial V).$$
\end{proposition}

The following attempts to prove Lemma \ref{eikonal extension} might seem like they work, but they don't:
\begin{enumerate}
\item If $V$ is a simplex, and we are allowed to prescribe $f$ on the vertices $X$ of $V$ rather than $\partial V$ (this is the situation we actually care about, anyways), try $u$ to be the linear extension of $f$.
However, we can take
$$V = \{(x, y) \in \RR^2: x > 0, y > 0, x + y < 1\}$$
and $f(0, 0) = 0$, $f(1, 0) = f(0, 1) = 1$.
Then the unique linear extension of $f$ is $u(x, y) = x + y$.
Then $\Lip(f, X) = 1$ but $\Lip(u, V) = \sqrt 2$.
\item If $n = 1$, then try $u$ to be given by Perron's method as
\begin{equation}\label{eikonal equation}
\begin{cases}
|\dif u| = \Lip(f, \partial V) \\
u|_{\partial V} = f.
\end{cases}
\end{equation}
This clearly fails when $n \geq 2$, but even when $n = 1$, I think this fails because (\ref{eikonal equation}) is so overdetermined.
For example, it seems very likely that (\ref{eikonal equation}) has no $C^1$ supersolutions under various hypotheses, which, for example, could compel any $C^1$ extension of $f$ to have a critical point.
Maybe I'll try to write out an explicit counterexample.
\end{enumerate}
We are thus compelled to construct an eikonal extension which is NOT a viscosity solution of (\ref{eikonal equation}) when $n = 1$.

%%%%%%%%%%%%%%%%%%%%
\subsection{Modifying the Lipschitz constant on a packing}
We first show that we can modify a Lipschitz map $u$ on a small ball to increase $Lu$ in a controlled manner.
As a consequence, we show that we can modify $Lu$ safely on every ball in a packing.

Throughout the proof of Proposition \ref{eikonal extension}, given a ball $B$ of radius $r$, let $\Phi(B)$ be the concentric ball of radius $r^2$.
We recall some definitions from metric geometry:

\begin{definition}
Let $W \subseteq \RR^k$ be an open set.
\begin{enumerate}
\item An $r$-\dfn{packing} of $W$ is a set of disjoint balls $B \Subset W$ of radius $r$.
\item An $r$-packing $\mathscr P$ of $W$ is \dfn{maximal} if there does not exist an $r$-packing $\mathscr Q$ of $W$ with $\mathscr Q \supset \mathscr P$.
\end{enumerate}
\end{definition}

\begin{lemma}\label{improvement on one ball}
Let $W \subseteq \RR^k$ be a convex open set and $K > 0$.
Let $u: W \to \RR^n$ satisfy $\Lip(u, W) \leq K$.
Then there exists $v: W \to \RR^n$ such that:
\begin{enumerate}
\item $\Lip(v, W) = K$.
\item For some $W' \Subset W$ and every $x \in W \setminus W'$, $v(x) = u(x)$.
\item For every $\varepsilon > 0$, there exists a closed line segment $\ell \Subset W$ such that $\Lip(v, \ell) > K - \varepsilon$.
\end{enumerate}
\end{lemma}
\begin{proof}
We first observe that it suffices to show that there exists $v: W \to \RR^n$ with $v = u$ near $\partial W$, $\Lip(v, W) = K$, and $Lv(x) = K$ for some $x \in W$.
Indeed, if this is true, then there exist $y_n, z_n \in W$ with $y_n, z_n \to x$ and
$$\frac{|v(y_n) - v(z_n)|}{|y_n - z_n|} \to K.$$
If we take $\ell$ to be the line segment $[y_n, z_n]$ for a sufficiently large $n$, the result follows.

So suppose that for every $x \in W$, $Lu(x) < K$.
Choose a convex open set $W' \Subset W$, so $\Lip(u, W') < K$ by (\ref{Lip is sup of local Lips}).
Choose $\varphi \in C^\infty_\cpt(W', \RR^n)$ which is rapidly oscillating on some set $W'' \Subset W'$, and define
$$u_t(x) := u + t\varphi.$$
Since $w \mapsto \Lip(w, W')$ is a seminorm, $\beta(t) := \Lip(u_t, W')$ is a continuous function on $\RR_+$.
Moreover, $\beta(0) < K$ and $\beta(t) \to \infty$ as $t \to \infty$, so there exists $T > 0$ such that $\beta(T) = K$.
We then set $v := u_T$.
By (\ref{Lip is sup of local Lips}) and the fact that $\overline{W'}$ is a convex compact set, there exists $x \in W'$ such that
$$Lv(x) = \beta(T) = K.$$
Moreover, for $y \in W'$ we have $Lv(y) \leq K$ and for $y \in W \setminus W'$ we have $Lv(y) < K$.
So by (\ref{Lip is sup of local Lips}) and convexity of $W$, $\Lip(v, W) = K$.
\end{proof}

\begin{lemma}\label{improvement on packing}
Let $W \subseteq \RR^k$ be an open set, $K > 0$, and $0 < r \leq 1$.
Let $u: W \to \RR^n$ satisfy $\Lip(u, W) \leq K$.
Then for every $r$-packing $\mathscr P$ of $W$, there exists $v: W \to \RR^n$ such that:
\begin{enumerate}
\item For every $x \in W$, $Lv(x) \leq K$.
\item For every $x \in W \setminus \bigcup \{\Phi(B): B \in \mathscr P\}$, $v(y) = u(y)$.
\item For every $\varepsilon > 0$ and every $B \in \mathscr P$, there exists a closed line segment $\ell \Subset \Phi(B)$ such that $\Lip(v, \ell) > K - \varepsilon$.
\end{enumerate}
\end{lemma}
\begin{proof}
We apply Lemma \ref{improvement on one ball} to each ball $\Phi(B)$ such that $B \in \mathscr P$.
Since $r^2 \leq r$ and $\mathscr P$ is a packing, the balls $\Phi(B)$ are all disjoint.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%
\subsection{Iterating the packing procedure}
We are going to iteratively apply Lemma \ref{improvement on packing} to finer and finer packings; at each scale, we get some improvement to a given Lipschitz map $u_0$.
Later we shall take a limit as the scale goes to $0$; it is important that we choose our packings so carefully that in the limit, our improvements do not cancel each other.

\begin{lemma}\label{iterating the packing}
Let $u_0: V \to \RR^n$ be a map with $\Lip(u_0, V) \leq K$, and $\mathscr L_0 := \emptyset$.
Then there exist
\begin{enumerate}
\item maps $u_i: V \to \RR^n$ with $\Lip(u_i, V) \leq K$,
\item finite sets of line segments $\mathscr L_i \supset \mathscr L_{i - 1}$,
\item and maximal $2^{-i}$-packings $\mathscr P_i$ of $V \setminus \bigcup \mathscr L_{i - 1}$,
\end{enumerate}
such that for every $i \geq 1$,
\begin{enumerate}
\item \label{balls and lines} there is a bijection
$$\ell: \mathscr P_i \to \mathscr L_i \setminus \mathscr L_{i - 1},$$
which sends $B \in \mathscr P_i$ to a line segment $\ell(B) \Subset \Phi(B)$ such that
$$\Lip(u_i, \ell(B)) > K - 2^{-i},$$
\item \label{preservation} and for each $x \in V \setminus \bigcup \{\Phi(B): B \in \mathscr P_i\}$,
$$u_i(x) = u_{i - 1}(x).$$
\end{enumerate}
\end{lemma}
\begin{proof}
We proceed by induction. Assume that we have defined $u_{i - 1}, \mathscr L_{i - 1}, \mathscr P_{i - 1}$ to have the desired properties.
Let $W := V \setminus \bigcup \mathscr L_{i - 1}$.
Then $W$ is an open set since $\mathscr L_{i - 1}$ is a finite set of closed sets, so we may choose a maximal $2^{-i}$-packing $\mathscr P_i$ of $W$.
Let $Z := \bigcup \{\Phi(B): B \in \mathscr P_i\}$.

By Lemma \ref{improvement on packing}, we can find $u_i: W \to \RR^k$ and line segments $\ell(B)$, $B \in \mathscr P_i$, such that $u_i$ agrees with $u_{i - 1}$ away from $Z$ and satisfies $Lu_i \leq K$, but for each $B \in \mathscr P_i$,
$$\Lip(u_i, \ell(B)) > K - 2^{-i}.$$
Since $V \setminus W$ does not intersect $Z$, $u_i = u_{i - 1}$ near $W$, and in particular, extends uniquely to all of $V$ while satisfying (\ref{preservation}).
Let
$$\mathscr L_i := \mathscr L_{i - 1} \cup \{\ell(B): B \in \mathscr P_i\}.$$
Since $V$ is bounded and hence has finite volume, the packing $\mathscr P_i$ is finite.
Since $\mathscr L_{i - 1}$ is finite, so is $\mathscr L_i$, and $\mathscr L_i$ satisfies (\ref{balls and lines}).
\end{proof}

Throughout the rest of this section, we fix a Lipschitz map $u_0: V \to \RR^n$, and let $\mathscr L_i, \mathscr P_i$ be as in Lemma \ref{iterating the packing}.
We are interested in the geometry of the packings $\mathscr P_i$; specifically, we want to show that any point in $V$ can be well-approximated by centers of balls in $\mathscr P_i$.

\begin{lemma}\label{separation of line segments}
For every $\ell, \ell' \in \mathscr L_i$, either $\ell = \ell'$ or
$$\dist(\ell, \ell') > 2^{-i} - 4^{-i}.$$
\end{lemma}
\begin{proof}
Suppose that $\ell \neq \ell'$.
By induction, we may assume that this result holds if $\ell, \ell' \in \mathscr L_{i - 1}$.
So suppose that $\ell \in \mathscr L_i \setminus \mathscr L_{i - 1}$, so by Lemma \ref{iterating the packing}(\ref{balls and lines}) there exists $B \in \mathscr P_i$ such that $\ell \Subset \Phi(B)$.

We claim that $\ell'$ does not intersect $B$.
Indeed, if $\ell' \in \mathscr L_{i - 1}$, then since balls in $\mathscr P_i$ are disjoint from $\bigcup \mathscr L_{i - 1}$, $\ell'$ does not intersect $B$.
Otherwise, by Lemma \ref{iterating the packing}(\ref{balls and lines}), there exists $B' \in \mathscr P_i$ such that $\ell' \subset \Phi(B') \Subset B'$. Since $\mathscr P_i$ is a packing, $\ell'$ does not intersect $B$.
In either case, the result follows, because
\begin{align*} 
\dist(\ell, \ell') &\geq \dist(\ell, V \setminus B) > \dist(\Phi(B), V \setminus B) > 2^{-i} - 4^{-i}. \qedhere
\end{align*}
\end{proof}

\begin{lemma}\label{almost density of balls}
Suppose that $k \geq 2$. Let
$$\mathscr U_i := \{x \in V: B(x, 2^{-i}) \in \mathscr P_i\}.$$
For every $i \geq 10$ and $x \in V$,
$$\min\left(\dist(x, \partial V), \min_{j \leq i} \dist(x, \mathscr U_j)\right) \leq 2^{-i + 4}.$$
\end{lemma}
\begin{proof}
Suppose not, so some ball $B(x, 2^{-i + 4}) \Subset V$ does not contain any point of $\bigcup_{j \leq i} \mathscr U_j$.
Then every ball $B(y, 2^{-i + 1}) \subseteq B(x, 2^{-i + 4})$ intersects a line segment in $\mathscr L_{i - 1}$.
Otherwise, by maximality of the packing $\mathscr P_i$, any point of $V \setminus \bigcup \mathscr L_{i - 1}$ must be within $2^{-i}$ of a ball in $\mathscr P_i$, or $\partial V$, or $\bigcup \mathscr L_{i - 1}$.
But by definition of $y$, no ball in $\mathscr P_i$ intersects $B(y, 2^{-i})$, a set which also does not intersect $\partial V$ or $\mathscr L_{i - 1}$.
This is a contradiction.

Applying the previous paragraph with $y := x$, we can find $j_1 \leq i - 1$ and $q_1 \in \mathscr U_{j_1}$ such that $\ell_1 := \ell(B(q_1, 2^{-j_1}))$ intersects $B(x, 2^{-i + 1})$.
Since $q_1 \notin B(x, 2^{-i + 4})$, but $\ell_1 \subset \Phi(B(q_1, 2^{-j_1})) = B(q_1, 4^{-{j_1}})$,
$$\dist(\partial B(x, 2^{-i + 4}), B(x, 2^{-i + 1})) < 4^{-j_1}.$$
From this it follows that
$$2^{-2j_1} = 4^{-j_1} > 2^{-i + 4} - 2^{-i + 1} > 2^{-i + 3}.$$
Therefore $j_1 < (i - 3)/2$.

Since $k \geq 2$, there is a ball $B(y, 2^{-i + 1}) \subseteq B(x, 2^{-i + 2})$ which does not intersect $\ell_1$.
Therefore there exist $j_2 \leq i - 1$ and $q_2 \in \mathscr U_{j_2}$ such that $\ell_2 := \ell(B(q_2, 2^{-j_2}))$ intersects $B(y, 2^{-i + 1})$.
Arguing as above, we see that $j_2 \leq (i - 3)/2$ as well.

Since $\ell_1$ and $\ell_2$ both intersect $B(x, 2^{-i + 2})$,
$$\dist(\ell_1, \ell_2) < 2^{-i + 3}.$$
On the other hand, by Lemma \ref{separation of line segments},
$$\dist(\ell_1, \ell_2) > 2^{-\frac{i - 3}{2}} - 4^{-\frac{i - 3}{2}},$$
which is a contradiction when $i \geq 10$.
\end{proof}

As we shall see, we can get good estimates on $Lu_i(x)$ provided that $x$ is $\sim 2^{-i}$-close to $\mathscr U_j$ for some $j \sim i$.
Motivated by Lemma \ref{almost density of balls}, we shall show exponential decay of the volume of an exceptional set
\begin{equation}\label{exponential exceptional set}
Z_i := \bigcup \left\{B(x, 2^{-i+4}): x \in \partial V \cup \bigcup_{j \leq i/2} \mathscr U_j\right\}.
\end{equation}

\begin{lemma}\label{decay of the exceptional set}
Suppose that $k \geq 2$.
Then there exists $C > 0$ which depends only on $V$ such that $\vol(Z_i) \leq C/2^i$.
\end{lemma}
\begin{proof}
The Minkowski codimension of $\partial V$ is $1$ with uniform constants at all scales so the volume of a $2^{-i+4}$-neighborhood $T$ of $\partial U$ is $\lesssim 2^{-i}$.
Next, we estimate
$$\card \mathscr U_j \leq \frac{\vol(\bigcup \mathscr U_j)}{\vol(B(0, 2^{-j}))} \lesssim 2^{jk} \vol(V) \lesssim 2^{jk}.$$
Summing in $j$ we obtain 
$$\card\left(\bigcup_{j \leq i/2} \mathscr U_j\right) \leq \sum_{j=1}^{i/2} 2^{jk} = \frac{2^{ik/2} - 2^k}{1 - 2^{-k}} \lesssim 2^{ik/2}.$$
Thus we estimate
\begin{align*}
\vol(Z_i)
&\leq \vol(T) + \card\left(\bigcup_{j \leq i/2} \mathscr U_j\right) \vol(B(0, 2^{-i})) 
\lesssim 2^{-is} + 2^{ik/2} 2^{-ik}.
\end{align*}
Since $k \geq 2$, this quantity is $\lesssim 2^{-i}$.
\end{proof}

%%%%%%%%%%%%%%
\subsection{Proof of Proposition \ref{eikonal extension}}
If $k = 1$, then $V$ is an interval and we can $u$ to be take the linear extension of $f$.
Henceforth we assume $k \geq 2$.

Let $K := \Lip(f, \partial V)$.
By the Kirszbraun-Valentine theorem, there exists a Lipschitz extension $u_0: V \to \RR^n$ of $f$ with $\Lip(u_0, V) \leq K$.
Let $u_i, \mathscr P_i, \mathscr L_i$ be as in Lemma \ref{iterating the packing}.
Since $\Lip(u_i, V) \leq K$, we can apply the Arzela-Ascoli theorem and pass to a subsequence to find a Lipschitz extension $u: V \to \RR^n$ of $f$ with $\Lip(u, V) \leq K$ and $u_i \to u$ in $C^0$.

It remins to show that $Lu = K$ everywhere.
To this end, let $Z_i$ be as in (\ref{exponential exceptional set}).
Introduce the exceptional set $Z := \bigcap_{i \geq 10} \bigcup_{j \geq i} Z_j$.
By Lemma \ref{decay of the exceptional set},
$$\vol\left(\bigcup_{j \geq i} Z_j\right) \lesssim \sum_{j = i}^\infty 2^{-j} = 2^{-i + 1},$$
so by continuity from above, $Z$ is null.
In particular $V \setminus Z$ is dense.

For every $x \in V \setminus Z$ and $\varepsilon > 0$, there exists $i \geq 10$ such that
$$2^{-i} < \max(\varepsilon^2, 16 \dist(x, \partial V))$$
and $x \notin \bigcup_{j \geq i} Z_j$.
By Lemma \ref{almost density of balls}, there exists $j \geq i/2$ and $q \in \mathscr U_j$ such that $|x - q| < 2^{-i + 4}$.

From Lemma \ref{iterating the packing}(\ref{balls and lines}), there exists a line segment $\ell \in \mathscr L_j$ such that
\begin{align*}
\ell &\Subset B(q, 4^{-j}) \subseteq B(q, 2^{-i}) \\
\Lip(u_j, \ell) &> K - 2^{-j} \geq K - 2^{-i/2} > K - \varepsilon.
\end{align*}
An induction on Lemma \ref{iterating the packing}(\ref{preservation}) implies that for $p \geq j$, $u_p|_\ell = u_j|_\ell$; taking the limit, we see that $u|_\ell = u_j|_\ell$.
Therefore $\Lip(u, \ell) > K - \varepsilon$, so by (\ref{Lip is sup of local Lips}), there exists $y_i \in \ell$ such that $Lu(y_i) > K - \varepsilon$.
But $|y_i - q| < 2^{-i}$, so $|y_i - x| < 2^{-i + 5}$.

We can now take $i \to \infty$, so $y_i \to x$ with $Lu(y_i) = K$.
Since $Lu(x) \leq K$ and $Lu$ is upper semicontinuous, $Lu(x) = K$ as well.
Since $V \setminus Z$ is dense, the same conclusion holds even if $x \in Z$, proving Proposition \ref{eikonal extension}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Existence of tight maps}
\begin{theorem}\label{existence of tight maps}
Let $f: \partial U \to \RR^n$ be a Lipschitz map.
Then there exists a tight map $u: U \to \RR^n$ extending $f$.
Moreover, $\Lip(u, U) = \Lip(f, \partial U)$.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%
\subsection{Construction of the combinatorial model}
We introduce some notation for a finite simplicial complex $\tau$.
Let $F_i(\tau)$ be the set of $i$-faces of $\tau$.
The \dfn{mesh size} $\mesh(\tau)$ of $\tau$ is 
$$\mesh(\tau) := \max_{E \in F_1(\tau)} \diam(E).$$
For any face $T \in F_i(\tau)$ with $i \geq 1$, $\diam(T) \leq \mesh(\tau)$.

Now we fix a triangulation $\tau$ of the open polytope $U \subseteq \RR^m$.
For each $h > 0$, define $\tau_h$ to be an iterated barycentric subdivision of $\tau$ such that:
\begin{enumerate}
\item $\mesh(\tau_h) \leq h$.
\item If $h' < h$, then $\tau_{h'}$ is a subdivision of $\tau_h$.
\end{enumerate}

\begin{proposition}[construction of shape maps]\label{construction of shape maps}
Let $X := F_0(\tau_h)$ be the $0$-skeleton.
For each map $u_0: X \to \RR^n$ there exists a map $u: u \to \RR^n$ such that $u|_X = u_0$ and for every $x \in X$,
\begin{equation}\label{Lip constant comes from 1 skeleton}
Lu(x) = \max_{\substack{T \in F_m(\tau_h) \\ x \in T}} \max_{\substack{y, z \in X \\ y, z \in T}} \frac{|u(y) - u(z)|}{|y - z|}.
\end{equation}
\end{proposition}
\begin{proof}
Let $k \geq 1$, and let $T$ be a $k$-face.
Inductively define $u_k|_T$ to be the extension of $u_{k - 1}$ given by Proposition \ref{eikonal extension}; then $u_k$ is Lipschitz on the $k$-skeleton of $\tau_h$, and by induction on $k$, for every $x \in T \setminus \partial T$, $Lu(x) = \Lip(u, V_T)$ where $V_T$ is the set of vertices of $T$.

Let $u := u_m$.
By Lemma \ref{partial lower semicontinuity}, the estimate (\ref{Lip constant comes from 1 skeleton}) holds because it does whenever $x \in T^\circ$ for some $m$-face $T$.
\end{proof}

\begin{definition}\label{shape map}
Let $h > 0$.
For every map $u_0: F_0(\tau_h) \to \RR^n$, choose a map $u: U \to \RR^n$ satisfying the conclusion of Proposition \ref{construction of shape maps}.
We call $u$ the $h$-\dfn{shape map} extending $u_0$.

Define a projection operator $\Pi_h$, by declaring that for every continuous map $v: U \to \RR^n$, $\Pi_h v$ is the unique $h$-shape map such that 
$$\Pi_h v|_{F_0(\tau_h)} = v|_{F_0(\tau_h)}.$$
\end{definition}

%%%%%%%%%%%%%%%
\subsection{Approximation of Lipschitz maps}
We can use (\ref{Lip constant comes from 1 skeleton}) to show that for every $x \in U$,
\begin{equation}\label{discrete derivative is vertex lip}
L \Pi_h u(x) = \max_{\substack{T \in F_m(\tau_h) \\ x \in T}} \max_{\substack{y, z \in F_0(\tau_h) \\ y, z \in T}} \frac{|u(y) - u(z)|}{|y - z|}.
\end{equation}
We now use this estimate to show the convergence of $\Pi_h u$ to $u$ whenever $u$ is Lipschitz.

\begin{lemma}\label{uniform convergence}
For every $x \in U$ and every Lipschitz map $u: U \to \RR^n$,
$$|\Pi_h(x) - u(x)| \leq 2h \Lip(u, B(x, h)).$$
\end{lemma}
\begin{proof}
Suppose that $T \in F_m(\tau_h)$ attains the maximum in (\ref{discrete derivative is vertex lip}).
Let $y$ be a vertex of $T$.
Then $\Pi_h u(y) = u(y)$, so 
$$|\Pi_h u(x) - u(x)| \leq |\Pi_h u(y) - u_h(x)| + |u(y) - u(x)|.$$
By (\ref{discrete derivative is vertex lip}) and the fact that $T \subseteq B(x, h)$,
\begin{align*}
|\Pi_h u(y) - u_h(x)| + |u(y) - u(x)| &\leq 2h \Lip(u, T) \leq 2h \Lip(u, B(x, h)). \qedhere
\end{align*}
\end{proof}

\begin{lemma}\label{du converges ae}
For any Lipschitz map $u: U \to \RR^n$, $L\Pi_h u \to Lu$ almost everywhere.
\end{lemma}
\begin{proof}
By Lemma \ref{uniform convergence}, $\Pi_h u \to u$ uniformly.
By (\ref{Lip constant comes from 1 skeleton}), $\Lip(\Pi_h u, U) \leq \Lip(u, U) < \infty$, so by Lemma \ref{Lip is lower semicontinuous},
$$Lu \leq \liminf_{h \to 0} L\Pi_hu$$
almost everywhere.
Thus it suffices to show that for almost every $x \in U$,
\begin{equation}\label{upper semicontinuity of discrete Lips}
\limsup_{h \to 0} L\Pi_h u(x) \leq Lu(x).
\end{equation}
By Lusin's theorem, for every $\varepsilon > 0$ there is a closed set $Z_\varepsilon \subset U$ with $\vol(Z_\varepsilon) < \varepsilon$ such that $Lu$ is continuous away from $Z_\varepsilon$.
It suffices to show (\ref{upper semicontinuity of discrete Lips}) for every $x \in U \setminus Z_\varepsilon$.

By (\ref{discrete derivative is vertex lip}) and (\ref{Lip is sup of local Lips}) for every $h > 0$ there exist $T_h \in F_m(\tau_h)$, $[y_h, z_h] \in F_1(\tau_h)$ and $w_h \in [y_h, z_h]$ such that $x \in T_h$, $[y_h, z_h] \subseteq T_h$, and
$$L \Pi_h u(x) \leq \frac{|u(y_h) - u(z_h)|}{|y_h - z_h|} \leq Lu(w_h).$$
If $h$ is small enough depending on $x$, then $T_h$ is contained in the open set $U \setminus Z_\varepsilon$, so 
\begin{align*}
\limsup_{h \to 0} L \Pi_h u(x) \leq \limsup_{h \to 0} Lu(w_h) &= Lu(x). \qedhere
\end{align*}
\end{proof}

\begin{proposition}\label{discrete tight maps converge}
Let $u, v: U \to \RR^n$ be Lipschitz maps, and let $v_h: U \to \RR^n$ be $h$-shape maps such that:
\begin{enumerate}
\item $u \prec v$.
\item $v_h \to v$ in $L^1$.
\item For some $K < \infty$ and every $h > 0$, $\Lip(v_h, U) \leq K$.
\end{enumerate}
Then there exists $h_* > 0$ such that for $0 < h < h_*$, $\Pi_h u \prec v_h$.
\end{proposition}
\begin{proof}
Let $u_h := \Pi_h u$ and
$$M := \sup_{Lu < Lv} Lv.$$
Since $u \prec v$, there exists $\delta > 0$ such that
$$\sup_{Lv < Lu} Lu(x) < M - \delta.$$

\begin{claim}
If $\delta, h$ are small enough, then 
$$\sup_{Lu_h < Lv_h} Lv_h > M - \delta.$$
\end{claim}
\begin{proof}[Proof of claim]
By definition of $M$, if $\delta$ is taken small enough, then there exists $x \in U$ such that
$$Lu(x) < M - \delta < Lv(x).$$
By Lemma \ref{partial lower semicontinuity}, and the fact that $\{Lu < M - \delta\}$ is open, it follows that the set
$$E := \{y \in U: Lu(y) < M - \delta < Lv(y)\}$$
satisfies $\vol(E) > 0$.
By Lemmata \ref{Lip is lower semicontinuous} and \ref{du converges ae}, we can find $y \in E$ such that
$$Lv(y) \leq \liminf_{h \to 0} Lv_h(y)$$
and $Lu_h(y) \to Lu(y)$.
Therefore for $h$ small enough,
$$Lu_h(y) < M - \delta < Lv_h(y).$$
In particular, $Lv_h(y) > Lu_h(y)$, so 
\begin{align*}
\sup_{Lu_h < Lv_h} Lv_h \geq Lv_h(y) &> M - \delta. \qedhere 
\end{align*}
\end{proof}

\begin{claim}
If $h$ is small enough, then 
$$\sup_{Lv_h < Lu_h} Lu_h \leq M - \delta.$$
\end{claim}
\begin{proof}[Proof of claim]
It suffices to show that for every sufficiently small $h > 0$ and every $\theta > 0$,
\begin{equation}\label{loss of theta}
\sup_{Lv_h < Lu_h - \theta} Lu_h \leq M - \delta.
\end{equation}
Indeed, if $Lv_h(x) < Lu_h(x)$, then there exists $\theta > 0$ such that $Lv_h(x) < Lu_h(x) - \theta$, so if (\ref{loss of theta}) holds, then $Lu_h(x) \leq M - \delta$, as claimed.

In order to prove (\ref{loss of theta}), we fix $\varepsilon > 0$, so by Proposition \ref{one sided Egorov} and Lemmata \ref{Lip is lower semicontinuous} and \ref{du converges ae}, there exists a set $Z_\varepsilon$ such that $\vol(Z_\varepsilon) < \varepsilon$ and $Lu_h \to Lu$ and 
$$Lv \leq \liminf_{h \to 0} Lv_h$$
uniformly on $U \setminus Z_\varepsilon$.
By appending $\partial U$ to $Z_\varepsilon$ and then using continuity from above of Lebesgue measure, we may assume that $Z_\varepsilon$ is open and contains a collar neighborhood of $\partial U$.
In particular, $U \setminus Z_\varepsilon$ is a compact subset of $U$.

We then claim 
\begin{equation}\label{loss of epsilon}
\limsup_{h \to 0} \sup_{\substack{Lv_h(x) < Lu_h(x) - \theta \\ x \notin Z_\varepsilon}} Lu_h(x) > M - \delta.
\end{equation}
To prove (\ref{loss of epsilon}), we use compactness and contradiction.
If (\ref{loss of epsilon}) is false, then for every $h > 0$ along a subsequence, there exist $x_h \in U \setminus Z_\varepsilon$ such that $Lv_h(x_h) < Lu_h(x_h) - \theta$ but $Lu_h(x_h) > M - \delta$.
Since $U \setminus Z_\varepsilon$ is compact, after taking another subsequence, we can find $x \in U \setminus Z_\varepsilon$ with $x_h \to x$.
By the uniform convergence, $Lu(x) \geq M - \delta$ but 
$$Lv(x) \leq \liminf_{h \to 0} Lv_h(x_h) < \liminf_{h \to 0} Lu_h(x_h) - \theta = Lu(x) - \theta,$$
which contradicts the definition of $\delta$.
So (\ref{loss of epsilon}) holds.

To deduce (\ref{loss of theta}) from (\ref{loss of epsilon}), we first let $Z := \bigcap_\varepsilon Z_\varepsilon$ and take $\varepsilon \to 0$ to deduce that for every sufficiently small $h > 0$,
\begin{equation}\label{loss of theta 2}
\sup_{\substack{Lv_h(x) < Lu_h(x) - \theta \\ x \notin Z}} Lu_h(x) \leq M - \delta.
\end{equation}
Let $x \in U$ satisfy $Lv_h(x) < Lu_h(x) - \theta$.
Then for every sufficiently small $\kappa > 0$,
$$Lv_h(x) < Lu_h(x) - \theta - \kappa.$$
Moreover, $V := \{Lv_h < Lu_h(x) - \theta - \kappa\}$ is an open neighborhood of $x$ since $Lv_h$ is upper semicontinuous.
So the set $W := \{Lu_h > Lu_h(x) - \kappa\} \cap V$ has $\vol(W) > 0$ by Lemma \ref{partial lower semicontinuity}.
So $W \setminus Z$ is nonempty and for any $y \in W$,
$$Lv_h(y) < Lu_h(x) - \theta - \kappa < Lu_h(y) - \theta$$
which, combined with (\ref{loss of theta 2}), implies $Lu_h(y) \leq M - \delta$.
Therefore
$$Lu_h(x) < Lu_h(y) + \kappa \leq M - \delta + \kappa.$$
We take $\kappa \to 0$ to deduce (\ref{loss of theta}).
\end{proof}

It is clear that the above claims imply the result.
\end{proof}

%%%%%%%%%%%%%%%%%%%%
\subsection{Constructing the tight map}
We assume that $U \subseteq \RR^m$ is an open convex polytope.
\todo{Since the domain is a length space, probably the convexity assumption can be removed.}
Then $\tau_h$ extends to a triangulation of every polytope in $\partial U$, so it makes sense to ask if a continuous map $f: \partial U \to \RR^n$ is a shape map.

\begin{definition}
An $h$-shape map $u: U \to \RR^n$ is \dfn{$h$-tight} if there does not exist an $h$-shape map $v$ such that $v \prec u$ and $u|_{\partial U} = v|_{\partial U}$.
\end{definition}

\begin{proposition}\label{discrete wellposedness}
Let $h > 0$ and let $f: \partial U \to \RR^n$ be an $h$-shape map.
Then there exists an $h$-tight map $u: U \to \RR^n$ extending $f$.
\end{proposition}
\begin{proof}
Let $G$ be the graph induced by the $1$-skeleton of $\tau_h$, and let $H$ be the subgraph induced by the $1$-skeleton of $\tau_h \cap \partial U$.
We introduce a weight on edges by $\omega(x, y) := |x - y|$.
Let $V_G$ be the set of vertices of $G$.
For an $h$-shape map $u$ and $x \in V_G$,
$$Lu(x) = \max_{y \sim_G x} \frac{|u(x) - u(y)|}{\omega(x, y)}.$$
From this, and the fact that local Lipschitz constants of $h$-shape maps are constant on $m$-faces, it follows that $u \prec v$ iff $u|_{V_G}$ is tighter than $v|_{V_G}$ in the combinatorial sense of Sheffield and Smart \cite[\S1.2]{Sheffield12}.
So there exists an $h$-tight map \cite[Theorem 1.2]{Sheffield12}.\footnote{Strictly speaking, \cite{Sheffield12} deals with unweighted graphs, but this assumption can be removed \cite[Remark 2.2]{Sheffield12}.}
\end{proof}

\begin{lemma}\label{tight implies best lipschitz}
Suppose that $U$ is convex, and let $u, v: U \to \RR^n$ be Lipschitz maps with $u|_{\partial U} = v|_{\partial U}$ and $\Lip(u, U) > \Lip(v, U)$.
Then $v \prec u$.
\end{lemma}
\begin{proof}
By (\ref{Lip is sup of local Lips}), there exists $x \in U$ such that $Lu(x) > \Lip(v, U)$, and then
\begin{align*}
\sup_{Lu > Lv} Lu &> \Lip(v, U) = \sup_U Lv \geq \sup_{Lv > Lu} Lv. \qedhere
\end{align*}
\end{proof}

\begin{proof}[Proof of Theorem \ref{existence of tight maps}]
Let $f_h := \Pi_h f$.
By Proposition \ref{discrete wellposedness} there exist $h$-tight maps $u_h: U \to \RR^n$ extending $f_h$.
By the Kirszbraun-Valentine theorem, there also exist extensions $\tilde w_h: U \to \RR^n$ of $f_h$ with $\Lip(\tilde w_h, U) = \Lip(f_h, \partial U)$.
By (\ref{discrete derivative is vertex lip}), $w_h := \Pi_h \tilde w_h$ satisfies
$$\Lip(w_h, U) = \Lip(f_h, \partial U) \leq \Lip(f, \partial U).$$
Since $f_h$ was already a shape map, the action of $\Pi_h$ on $\tilde w_h$ preserved its restriction to the boundary, so $w_h|_{\partial U} = f_h$.

By Lemma \ref{tight implies best lipschitz}, $\Lip(u_h, U) \leq \Lip(f, \partial U)$.
By the Arzela-Ascoli theorem, after passing to a subsequence, we may assume that $u_h \to u$ in $C^0$ for some Lipschitz map $u: U \to \RR^n$ with $\Lip(u, U) \leq \Lip(f, \partial U)$.
By Lemma \ref{uniform convergence}, $f_h \to f$ in $C^0$, so $u$ is an extension of $f$.

If $u$ is not tight, then there exists a Lipschitz map $v: U \to \RR^n$ with $v \prec u$.
By Proposition \ref{discrete tight maps converge}, there exists $h > 0$ such that $\Pi_h v \prec u_h$.
This is a contradiction, because $u_h$ is tight.
So $u$ is tight.
\end{proof}

%%%%%%%%%%%%%%%%%%
\section{The geodesic lamination stretched by an AML map}
\begin{definition}
Suppose that $U$ is convex.
Let $u: U \to \RR^D$ be a Lipschitz map.
The \dfn{stretch set} of $u$ is the set of all $x \in U$ such that $Lu(x) = \Lip(u, U)$.
\end{definition}

By upper semicontinuity of $Lu$, the stretch set of any Lipschitz map is closed.
However, since $U$ is not compact, it may be empty.

By the \dfn{harmonic map heat flow} of a continuous map $u: U \to \RR^D$ we mean the solution of the harmonic map heat flow with initial data $u$ and boundary data $u|_{\partial U}$.
Since the target is $\RR^D$, the harmonic map heat flow is a completely decoupled system of $D$ heat equations, so it has short-time existence.
I expect that the below definition can be slightly modified to make sense even when there is a Riemannian metric, since we don't actually care about the global behavior of the harmonic map heat flow, but only its behavior near $x$, so that we may assume that the curvatures are not too ``crazy.''

\begin{definition}
Let $u: U \to \RR^D$ be a continuous map, which we extend to a harmonic map heat flow $[0, S) \times U \to \RR^D$.
We say that $u$ is \dfn{principally nonconformal} (in the sense of the harmonic map heat flow) if $D = 1$, or for every $x \in U$ such that $Lu(x) > 0$, there exists $\varepsilon > 0$ such that for every sufficiently small $s > 0$, 
$$\sigma_1(\dif u(s)(x)) \geq \sigma_2(\dif u(s)(x)) + \varepsilon.$$
\end{definition}

If $u$ is $C^1$ and principally nonconformal in the classical sense that for every $x \in U$,
$$\sigma_1(\dif u(x)) > \sigma_2(\dif u(x)),$$
then its harmonic map heat flow $u(s)$ converges in $C^1$ to $u$, implying that $u$ is principally nonconformal in the sense of the harmonic map heat flow.

\begin{theorem}
Suppose that $U$ is convex.
If a principally nonconformal map $u: U \to \RR^D$ is AML, and its stretch set $S$ is nonempty, then $S$ is the support of a geodesic lamination $\lambda_u$.
Furthermore, $u$ maps $\lambda_u$ linearly, rescaling by a factor of $\Lip(u, U)$, onto a geodesic lamination $\Lambda_u$ of $\RR^D$.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Constructing geodesics from a \texorpdfstring{$\infty$-subharmonic}{infinity-subharmonic} function}
\begin{lemma}[{\cite[Proposition 6.2]{Crandall2008}}]\label{infinity subharmonic gradient flow}
Let $v: U \to \RR$ be $\infty$-subharmonic and $x \in U$.
Then there exist $T \in (0, \infty]$ and a Lipschitz curve $\gamma: [0, T) \to U$ such that:
\begin{enumerate}
\item $\gamma(0) = x$.
\item For almost every $t \in [0, T)$, $|\gamma'(t)| \leq 1$.
\item Either $T = \infty$ or $\gamma(t) \to \partial U$ as $t \to T$.
\item For every $t \in [0, T)$, $Lv(\gamma(t)) \geq Lv(x)$.
\item For every $t \in [0, T)$, $v(\gamma(t)) \geq v(x) + tLv(x)$.
\item $v \circ \gamma$ is convex.
\end{enumerate}
\end{lemma}

\begin{lemma}\label{constructing the stretch geodesic}
Let $u: U \to \RR^D$ be an AML map and $x \in U$.
Then there exists $T \in (0, T]$ and a Lipschitz curve $\gamma: [0, T) \to U$ such that:
\begin{enumerate}
\item $\gamma(0) = x$.
\item For almost every $t \in [0, T)$, $|\gamma'(t)| \leq 1$.
\item Either $T = \infty$ or $\gamma(t) \to \partial U$ as $t \to T$.
\item For every $t \in [0, T)$, $L(|u - u(x)|)(\gamma(t)) \geq Lu(x)$.
\item For every $t \in [0, T)$, $|u(\gamma(t)) - u(x)| \geq tLu(x)$.
\item $t \mapsto |u(\gamma(t)) - u(x)|$ is convex.
\end{enumerate}
\end{lemma}
\begin{proof}
Since $u$ is AML,
$$v(y) := |u(y) - u(x)|$$
is $\infty$-subharmonic \cite[Proposition 7]{Naor2012}.\footnote{Strictly speaking, the reference shows that $v$ satisfies comparison with cones from above, but this is equivalent when the domain is euclidean \cite[\S2]{Crandall2008}.}
Let $\gamma: [0, T) \to U$ be the curve from Lemma \ref{infinity subharmonic gradient flow}.

We estimate 
\begin{align*} 
Lv(x) 
&= \inf_{r > 0} \sup_{y, z \in B(x, r)} \frac{||u(y) - u(x)| - |u(z) - u(x)||}{|y - z|} \\
&\geq \inf_{r > 0} \sup_{y \in B(x, r)} \frac{||u(y) - u(x)| - |u(x) - u(x)|}{|y - x|} \\
&= \inf_{r > 0} \sup_{y \in B(x, r)} \frac{|u(y) - u(x)|}{|y - x|} \\
&= Lu(x)
\end{align*}
\todo{justify the last equation in the preliminaries} which, combined with the definition of $\gamma$, implies 
\begin{align*}
L(|u - u(x)|)(\gamma(t)) = Lv(\gamma(t)) \geq Lv(x) &\geq Lu(x) \\
|u(\gamma(t)) - u(x)| = v(\gamma(t)) \geq v(x) + tLv(x) &= tLu(x). \qedhere
\end{align*}
\end{proof}

\begin{lemma}\label{geodesics still incomplete}
Let $u: U \to \RR^D$ be an AML map, $x \in U$, $K := \Lip(u, U)$, and suppose that $Lu(x) = K$.
Then there exists a geodesic $\gamma$ in $\RR^d$ and a geodesic $\Gamma$ in $\RR^D$, such that $u|_\gamma$ maps $\gamma$ onto $\Gamma$, and which admit parametrizations such that $\gamma(0) = x$ and
$$\Gamma(Kt) = u(\gamma(t)).$$
\end{lemma}
\begin{proof}
Let $\gamma$ be the curve from Lemma \ref{constructing the stretch geodesic}.
Then for $t > 0$,
$$K = Lu(x) \leq \frac{|u(\gamma(t)) - u(x)|}{t} \leq \frac{|u(\gamma(t)) - u(x)|}{|\gamma(t) - x|} \leq K.$$
The inequalities collapse and force $|\gamma(t) - x| = t$ and 
$$Lu(x) = \frac{|u(\gamma(t)) - u(x)|}{|\gamma(t) - x|}.$$
The former implies that $\gamma$ is a geodesic while the latter implies that $u$ is affine along $\gamma$.
\end{proof}

%%%%%%%%%%%%%%%%%
\subsection{Application of principal nonconformality}
\begin{lemma}
Let $u: U \to \RR^D$ be a principally nonconformal AML map, $x \in U$, $K := \Lip(u, U)$, and suppose that $Lu(x) = K$.
Then there exists a unique complete geodesic $\gamma$ in $\RR^d$ and a geodesic $\Gamma$ in $\RR^D$, such that $u|_\gamma$ maps $\gamma$ onto $\Gamma$, and which admit unit-speed parametrizations such that $\gamma(0) = x$ and
$$\Gamma(Kt) = u(\gamma(t)).$$
\end{lemma}
\begin{proof}
Let $u(s)$ be the harmonic map heat flow of $u$, and let $\varepsilon > 0$ be as in the definition of ``principally nonconformal.''
We first observe that if two unit-speed geodesics $\gamma_1, \gamma_2$ satisfy $\gamma_1(0) = \gamma_2(0) = x$ and are mapped to geodesics $\Gamma_1, \Gamma_2$ in $\RR^D$ by stretching by a factor of $K$, then the angle $\theta \in [0, \pi)$ between $\gamma_1, \gamma_2$ at $x$ must be $0$.
Indeed, if $\theta > 0$, then $\gamma_1'(0)$ and $\gamma_2'(0)$ span a $2$-plane $P$ at $x$.

Since $u(s) \to u$ uniformly as $s \to 0$, we can choose $s$ so small that $\|u(s) - u\|_{C^0} < \varepsilon/4$.
Then for every $t > 0$ small enough depending on the choice of $s$,
\begin{align*}
||u(s, \gamma_j(t)) - u(s, x)| - Kt| 
&= ||u(s, \gamma_j(t)) - u(s, x)| - |u(\gamma_j(t)) - u(x)|| \\
&\leq |u(s, \gamma_j(t)) - u(\gamma_j(t)) - u(s, x) + u(x)| \\
&\leq |u(s, \gamma_j(t)) - u(\gamma_j(t))| + |u(s, x) - u(x)| \\
&< \frac{\varepsilon}{2}.
\end{align*}
Taking $t \to 0$, we see that for any unit vector $\omega \in P$,
$$\langle \dif u(s)(x), \omega\rangle \geq K - \frac{\varepsilon}{2}.$$
On the other hand, \todo{harmonic map heat flow decreases Lipschitz constant} so
$$\sigma_1(\dif u(s)(x)) \leq \Lip(u(s), U) \leq K.$$
Since $P$ is a $2$-plane, we see that
$$\sigma_2(\dif u(s)(x)) \geq K - \frac{\varepsilon}{2} \geq \sigma_1(\dif u(s)(x)) - \frac{\varepsilon}{2},$$
contradicting the definition of $\varepsilon$.

Now suppose that the claim is false.
It is not false because of a lack of uniqueness, by the above argument, so it is not possible to continue the geodesic $\gamma_0$ furnished by Lemma \ref{geodesics still incomplete} past $x$ while preserving the affineness of $u|_{\gamma_0}$.
Let $\gamma$ be the complete geodesic extending $\gamma_0$.

We claim that $v(y) := |u(y) - u(x)|$ satisfies $v(y) < K|y - x|$ for every $y$ not on $\gamma_0$.
In fact, $v(y) \leq K|y - x|$ by definition of $K$, and if there exists $y$ not in $\gamma_0$ with $v(y) < K|y - x|$, then $u$ must be affine along the geodesic segment $[x, y]$, but then $[x, y]$ must be a segment of $\gamma_0$ by our contradiction assumption and the uniqueness argument above, a contradiction.

\todo{Want to show that this violates tightness (rather than AML).
The idea is that we should be able to decrease $K$ on a small ball at $x$ while leaving $K$ fixed elsewhere.
This suggests that tight maps satisfy a DPP, in fact}
\end{proof}

\todo{This shows that the stretch set is a geodesic lamination (up to regularity issues).
Why is the image also a geodesic lamination? What if two nonintersecting curves intersect after the mapping?}


%%%%%%%%%%%%%%%%
\section{More stuff to do}
\begin{conjecture}
The same existence result, but with curvature.
\end{conjecture}

\begin{conjecture}
The same existence result holds when the datum is a homotopy class.
The point is that homotopy classes still make sense in the PL category, and we should be able to modify the lexicographic trick of \cite[Theorem 1.2]{Sheffield12} to work for homotopy classes.
\end{conjecture}

\begin{conjecture}
If $u_p$ is a sequence of $p$-harmonic maps, then $u_p \to u$ where $u$ is tight.
In particular, if $u$ is $\infty$-harmonic in the variational sense of \cite{daskalopoulos2022} and is smooth and nonholomorphic, then $u$ is $\infty$-harmonic in the classical sense.
\end{conjecture}

\begin{conjecture}
Tight maps are unique. This cannot be shown by a discretization alone (since $\prec$ is an open condition, so shouldn't be preserved by limits).
\end{conjecture}

\begin{conjecture}
Discrete tight maps have a ``discrete geodesic lamination'' in their nonholomorphic stretch set.
This lamination converges to a (continuum) lamination of $U$.
\end{conjecture}

\begin{conjecture}
If $u$ is tight and $C^2$, then $|\dif u|_\infty$ is a viscosity solution of a degenerate-elliptic PDE.
Therefore $C^2$ tight maps have no critical points, as in the scalar-valued case \cite{Yu2006}.
\end{conjecture}

\begin{conjecture}
Loisel's finite element approximation of the scalar $\infty$-Laplacian \cite{Loisel_2020} converges to a best Lipschitz map which, in general, is not $\infty$-harmonic.
\end{conjecture}

\printbibliography

\end{document}
